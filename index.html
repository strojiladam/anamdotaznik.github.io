<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DotaznÃ­k dÃ­tÄ›te</title>
<style>
  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f6f8; color: #333; margin: 0; padding: 20px; }
  h1 { color: #0000dc; text-align: center; margin-bottom: 30px; }
  form { max-width: 900px; margin: 0 auto; background-color: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
  fieldset { border: 1px solid #ccc; border-radius: 8px; padding: 15px; margin-bottom: 20px; background-color: #fafafa; }
  legend { font-weight: bold; color: #0000dc; font-size: 16px; padding: 0 5px; }
  label {
    display: block;
    margin-bottom: 0;
    font-weight: 500;
    page-break-inside: avoid;
  }
  input, select, textarea {
    padding: 6px;
    border-radius: 5px;
    border: 1px solid #ccc;
    font-size: 14px;
    width: 100%;
    margin-left: 0;
    min-width: 0;
    box-sizing: border-box;
    margin-top: 6px;
    margin-bottom: 22px;
    line-height: 1.5;
    height: 38px;
    vertical-align: middle;
  }
  textarea.long-text {
    width: 100%;
    overflow-wrap: break-word;
    resize: vertical;
    box-sizing: border-box;
    margin-top: 6px;
    margin-bottom: 22px;
  }
  .hidden { display: none; }
  
 /* Primary export button */
button.primary {
  margin-top: 20px;
  background-color: #0000dc;
  color: white;
  border: none;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
  border-radius: 5px;
  transition: background 0.2s;
}

button.primary:hover {
  background-color: #0000aa;
}

/* Secondary buttons (save/load/clear) */
.save-buttons button {
  margin-top: 20px;
  background-color: white;
  color: #000;
  border: 1px solid #ccc;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
  border-radius: 5px;
  transition: background 0.2s, border-color 0.2s;
}

.save-buttons button:hover {
  background-color: #f0f0f0;
  border-color: #999;
}

/* Flex container for save buttons */
.save-buttons {
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}



/* Unified select-group alignment */
.select-group {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  width: 100%;
  margin-top: 6px;
  margin-bottom: 22px;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 8px;
  background: #fff;
  align-items: center;
  justify-content: flex-start;
  box-sizing: border-box;
}

.select-group label {
  display: flex;
  align-items: center;
  gap: 6px; /* spacing between input and text */
  font-weight: 500;
  margin: 0;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.15s ease, color 0.15s ease;
  user-select: none;
  min-height: 32px;
}

.select-group input[type="radio"],
.select-group input[type="checkbox"] {
  width: 18px;
  height: 18px;
  margin: 0; /* remove margin-right */
  accent-color: #0000dc;
}

.select-group label span {
  display: inline-block;
  padding: 2px 4px;
  border-radius: 4px;
  line-height: 1.2;
  height: auto;
}

.select-group label:hover span {
  background-color: #0000dc08;
}

.select-group input[type="radio"]:checked + span,
.select-group input[type="checkbox"]:checked + span {
  background-color: #0000dc10;
  color: #0000dc;
}

.select-group input[type="radio"]:focus-visible,
.select-group input[type="checkbox"]:focus-visible {
  outline: 2px solid rgba(0, 0, 220, 0.2);
  outline-offset: 2px;
}

  /* Tip / note block */
.tip-block {
  background-color: #e9f1ff; /* light blue tone matching your accent */
  border-left: 5px solid #0000dc;
  border-radius: 8px;
  padding: 14px 18px;
  margin: 20px 0;
  font-size: 15px;
  font-style: italic;
  line-height: 1.6;
  color: #222;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.tip-block::before {
  content: "ğŸ’¡ ProÄ se ptÃ¡me?";
  font-weight: 300;
  font-style: normal;
  color: #0000dc;
  display: block;
  margin-bottom: 6px;
}


  .page-footer {
  width: 100%;
  text-align: center;
  font-size: 10pt;
  color: #666;
  font-family: "Times New Roman", Times, serif;
  border-top: 1px solid #ccc;
  padding: 10px 0;
  margin-top: 40px;
  position: relative;
}




/* Print styles */
@media print {
  fieldset > label,
  fieldset > input,
  fieldset > select,
  fieldset > textarea,
  fieldset > .select-group,
  fieldset > .qa-block {
    page-break-inside: avoid !important;
  }

  @page { 
    size: A4; 
    margin: 20mm; 
  }

  /* Keep dynamic fieldsets (siblings, carers) visually grouped */
  #additional_carers_container fieldset,
  #siblings_container fieldset {
    page-break-inside: avoid !important; /* never split mid-section */
    border: none !important;
    margin: 0 0 10mm 8mm !important; /* slightly stronger left indent for hierarchy */
    padding: 0 !important;
  }

  #additional_carers_container legend,
  #siblings_container legend {
    font-size: 13pt !important;
    color: #000 !important;
    font-weight: bold !important;
    margin-left: 0 !important;
    margin-bottom: 4mm !important;
  }

  /* Consistent alignment inside generated carers/siblings */
  #additional_carers_container .qa-block,
  #siblings_container .qa-block {
    margin-left: 0 !important; /* remove double-indent */
    page-break-inside: avoid !important;
  }

  #additional_carers_container label,
  #siblings_container label,
  #additional_carers_container textarea,
  #siblings_container textarea,
  #additional_carers_container input,
  #siblings_container input,
  #additional_carers_container .qa-block,
  #siblings_container .qa-block {
    margin-left: 0 !important;
    padding-left: 0 !important;
    text-indent: 0 !important;
    page-break-inside: avoid !important;
  }

  #additional_carers_container span,
  #siblings_container span {
    margin-left: 0 !important;
    text-indent: 0 !important;
  }

  body {
    background-color: white;
    padding: 0;
    margin: 0;
    font-size: 12pt;
    font-family: "Times New Roman", Times, serif;
    color: black;
  }

  h1 {
    font-weight: bold;
    font-size: 20pt;
    color: #0000dc;
    margin-bottom: 20px;
    font-family: "Times New Roman", Times, serif;
  }

  .tip-block {
  display: none;
  }

  form {
    box-shadow: none;
    background: none;
    padding: 0;
    max-width: 100%;
    font-family: "Times New Roman", Times, serif;
  }

  fieldset {
    background: none;
    border: none !important;
    padding: 0 !important;
    margin-bottom: 25px !important;
    font-family: "Times New Roman", Times, serif;
  }

  legend {
    color: #0000dc; 
    font-size: 14pt;
    font-weight: normal;
    border-bottom: none;
    margin-left: 0 !important;
    padding: 0 !important;
    margin-bottom: 25px !important;
    text-align: left !important;
    font-family: "Times New Roman", Times, serif;
  }

  label {
    display: block !important;
    justify-content: flex-start;
    margin-bottom: 6px !important;
    page-break-inside: avoid !important;
    font-weight: normal;
    color: black; 
    font-family: "Times New Roman", Times, serif;
  }

  label span {
    display: block;
    margin-bottom: 4px;
    font-weight: normal;
    color: black; 
    font-family: "Times New Roman", Times, serif;
  }

  input,
  select,
  textarea {
    display: block !important;
    border: none;
    background: none;
    width: 100% !important;
    font-weight: normal;
    margin-left: 0 !important;
    color: #444; 
    font-family: "Times New Roman", Times, serif;
    font-size: 12pt;
    page-break-inside: avoid !important;
    margin-bottom: 22px !important;
  }

  textarea {
    resize: none;
    white-space: pre-wrap;
    overflow: visible !important;
  }

  textarea.long-text {
  overflow: hidden;  /* hide scrollbars so JS auto-height works */
  min-height: 50px;  /* reasonable starting height */
  }

  select {
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    pointer-events: none;
  }

  select::-ms-expand { display: none !important; }

  textarea::-webkit-scrollbar { display: none !important; }

  .select-group {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 16px !important;
    margin-top: 0 !important;
    margin-bottom: 22px !important;
    padding: 0 !important;
    background: none !important;
    border: none !important;
    page-break-inside: avoid !important;
  }

  .select-group label {
    display: flex !important;
    align-items: center !important;
    gap: 6px !important;
    font-weight: normal !important;
    font-size: 12pt !important;
    color: #000 !important;
    padding: 0 !important;
    margin: 0 !important;
    background: none !important;
    border: none !important;
    cursor: default !important;
  }

  .select-group input[type="radio"],
  .select-group input[type="checkbox"] {
    width: 14px !important;
    height: 14px !important;
    margin: 0 !important;
    accent-color: #000 !important;
  }

  .select-group label span {
    display: inline-block !important;
    line-height: 1.2 !important;
    color: #000 !important;
    font-weight: normal !important;
  }

  .select-group input[type="radio"]:checked + span,
  .select-group input[type="checkbox"]:checked + span {
    font-weight: bold !important;
  }

  .qa-block {
    display: block;
    page-break-inside: avoid !important;
    margin-bottom: 22px !important;
  }

  .hidden, button { display: none; }


 /*  .page-footer {
    display: block !important;
    position: relative;
    text-align: center;
    font-size: 10pt;
    color: #666;
    font-family: "Times New Roman", Times, serif;
    border-top: 1px solid #ccc;
    padding-top: 4mm;
    margin-top: 10mm;
    background: none;
  }

  .page-footer p {
    margin: 1px 0;
    line-height: 1.2;
  }
 */
.page-footer {
    display: none;
  } 

}


</style>
</head>
<body>

<form id="questionnaire">

  <h1>AnamnestickÃ½ dotaznÃ­k</h1>

  <!-- ZÃ¡kladnÃ­ Ãºdaje -->
<fieldset>
  <legend>ZÃ¡kladnÃ­ Ãºdaje</legend>

    <div class="tip-block">
  Na tyto informace se ptÃ¡me, abychom poznali vaÅ¡e dÃ­tÄ›.
</div>

  <div class="qa-block">
    <label><span>JmÃ©no dÃ­tÄ›te:</span></label>
    <input class="short-text" type="text" name="child_name">
  </div>
  <div class="qa-block">
    <label><span>Jak si dÃ­tÄ› pÅ™eje bÃ½t oslovovÃ¡no:</span></label>
    <input class="short-text" type="text" name="child_preferred_name">
  </div>
  <div class="qa-block">
    <label><span>Datum narozenÃ­ dÃ­tÄ›te:</span></label>
    <input type="date" name="child_birthdate" id="child_birthdate">
  </div>
  <div class="qa-block">
    <label><span>VÄ›k:</span></label>
    <input type="text" name="child_age" id="child_age" readonly style="cursor:default; pointer-events: none;" placeholder="DopoÄÃ­tÃ¡ se z data narozenÃ­">
  </div>
</fieldset>

<fieldset>
  <legend>RodinnÃ¡ anamnÃ©za</legend>
  <div class="qa-block">
    <label><span>JmÃ©no matky:</span></label>
    <input class="short-text" type="text" name="mother_name">
  </div>
  <div class="qa-block">
    <label><span>VÄ›k matky:</span></label>
    <input type="number" name="mother_age">
  </div>
  <div class="qa-block">
    <label><span>JmÃ©no otce:</span></label>
    <input class="short-text" type="text" name="father_name">
  </div>
  <div class="qa-block">
    <label><span>VÄ›k otce:</span></label>
    <input type="number" name="father_age">
  </div>
  <div class="qa-block">
    <label><span>RodiÄe jsou:</span></label>
    <div class="select-group">
      <label><input type="radio" name="parents_status" value="-"><span>-</span></label>
      <label><input type="radio" name="parents_status" value="BiologiÄtÃ­"><span>BiologiÄtÃ­</span></label>
      <label><input type="radio" name="parents_status" value="VychovÃ¡vajÃ­cÃ­"><span>VychovÃ¡vajÃ­cÃ­</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>BiologickÃ¡ matka je vychovÃ¡vajÃ­cÃ­ matka?</span></label>
    <div class="select-group">
      <label><input type="radio" name="bio_mother_status" value="-"><span>-</span></label>
      <label><input type="radio" name="bio_mother_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="bio_mother_status" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>BiologickÃ½ otec je vychovÃ¡vajÃ­cÃ­ otec?</span></label>
    <div class="select-group">
      <label><input type="radio" name="bio_father_status" value="-"><span>-</span></label>
      <label><input type="radio" name="bio_father_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="bio_father_status" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>Existuje dalÅ¡Ã­ vychovÃ¡vajÃ­cÃ­ rodiÄ/peÄovatel?</span></label>
    <div class="select-group">
      <label><input type="radio" name="additional_carer_status" value="-"><span>-</span></label>
      <label><input type="radio" name="additional_carer_status" value="Ano - plnÃ¡ pÃ©Äe"><span>Ano - plnÃ¡ pÃ©Äe</span></label>
      <label><input type="radio" name="additional_carer_status" value="Ano - stÅ™Ã­davÃ¡ pÃ©Äe"><span>Ano - stÅ™Ã­davÃ¡ pÃ©Äe</span></label>
      <label><input type="radio" name="additional_carer_status" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ matka nÄ›jakÃ¡ zdravotnÃ­ omezenÃ­?</span></label>
    <div class="select-group">
      <label><input type="radio" name="mother_health" value="-"><span>-</span></label>
      <label><input type="radio" name="mother_health" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="mother_health" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_mother_health_detail">
    <label><span>Pokud ano, uveÄte prosÃ­m jakÃ¡ omezenÃ­:</span></label>
    <textarea class="long-text" name="mother_health_detail"></textarea>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ otec nÄ›jakÃ¡ zdravotnÃ­ omezenÃ­?</span></label>
    <div class="select-group">
      <label><input type="radio" name="father_health" value="-"><span>-</span></label>
      <label><input type="radio" name="father_health" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="father_health" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_father_health_detail">
    <label><span>Pokud ano, uveÄte prosÃ­m jakÃ¡ omezenÃ­:</span></label>
    <textarea class="long-text" name="father_health_detail"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Je matka dÃ­tÄ›te momentÃ¡lnÄ› zamÄ›stnanÃ¡?</span></label>
    <div class="select-group">
      <label><input type="radio" name="mother_employed" value="-"><span>-</span></label>
      <label><input type="radio" name="mother_employed" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="mother_employed" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_mother_jobs_detail">
    <label><span>JakÃ¡ zamÄ›stnÃ¡nÃ­ vykonÃ¡vÃ¡ matka:</span></label>
    <textarea class="long-text" name="mother_jobs"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Je otec dÃ­tÄ›te momentÃ¡lnÄ› zamÄ›stnanÃ½?</span></label>
    <div class="select-group">
      <label><input type="radio" name="father_employed" value="-"><span>-</span></label>
      <label><input type="radio" name="father_employed" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="father_employed" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_father_jobs_detail">
    <label><span>JakÃ¡ zamÄ›stnÃ¡nÃ­ vykonÃ¡vÃ¡ otec:</span></label>
    <textarea class="long-text" name="father_jobs"></textarea>
  </div>
   <div class="qa-block">
    <label><span>VychovÃ¡vÃ¡ dÃ­tÄ› i nÄ›kdo jinÃ½ (podstatnÃ½m zpÅ¯sobem zasahuje do Å¾ivota dÃ­tÄ›te)?</span></label>
    <div class="select-group">
      <label><input type="radio" name="other_carer_status" value="-"><span>-</span></label>
      <label><input type="radio" name="other_carer_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="other_carer_status" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_other_carer_detail">
    <label><span>Kolik dalÅ¡Ã­ch osob dÃ­tÄ› vychovÃ¡vÃ¡?</span></label>
    <input type="number" name="additional_carers_count" id="additional_carers_count" min="0">
  <div id="additional_carers_container"></div>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› sourozence?</span></label>
    <div class="select-group">
      <label><input type="radio" name="has_siblings" value="-"><span>-</span></label>
      <label><input type="radio" name="has_siblings" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="has_siblings" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_siblings_detail">
    <label><span>Kolik mÃ¡ sourozencÅ¯?</span></label>
    <input type="number" name="siblings_count" id="siblings_count" min="0">
    <div id="siblings_container"></div>
  </div>
</fieldset>

<fieldset>
  <legend>ZdravotnÃ­ anamnÃ©za</legend>
  <div class="qa-block">
    <label><span>Bylo dÃ­tÄ› nÄ›kdy vyÅ¡etÅ™eno neurologem, psychiatrem nebo klinickÃ½m psychologem?</span></label>
    <div class="select-group">
      <label><input type="radio" name="neurolog_exam" value="-"><span>-</span></label>
      <label><input type="radio" name="neurolog_exam" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="neurolog_exam" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_neurolog_exam_detail">
    <label><span>JakÃ© diagnÃ³zy stanovil/i:</span></label>
    <textarea class="long-text" name="diagnoses"></textarea>
  </div>
  <div class="qa-block">
    <label><span>TrpÃ­ dÃ­tÄ› nÄ›kterÃ½mi chronickÃ½mi onemocnÄ›nÃ­mi?</span></label>
    <textarea class="long-text" name="chronic_illnesses"></textarea>
  </div>
  <div class="qa-block">
    <label><span>ProdÄ›lalo dÃ­tÄ› v minulosti nÄ›jakÃ© vÃ¡Å¾nÃ© zdravotnÃ­ komplikace?</span></label>
    <textarea class="long-text" name="past_health_issues"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Byl dÃ­tÄ›ti nÄ›kdy vyÅ¡etÅ™en zrak?</span></label>
    <div class="select-group">
      <label><input type="radio" name="vision_exam" value="-"><span>-</span></label>
      <label><input type="radio" name="vision_exam" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="vision_exam" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› se zrakem nÄ›jakÃ© obtÃ­Å¾e?</span></label>
    <div class="select-group">
      <label><input type="radio" name="vision_issues" value="-"><span>-</span></label>
      <label><input type="radio" name="vision_issues" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="vision_issues" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_vision_issues_detail">
    <label><span>DÃ­tÄ›:</span></label>
    <div class="select-group">
      <label><input type="checkbox" name="vision_devices_glasses"><span>NosÃ­ brÃ½le</span></label>
      <label><input type="checkbox" name="vision_devices_contacts"><span>NosÃ­ kontaktnÃ­ ÄoÄky</span></label>
      <label><input type="checkbox" name="vision_devices_occluder"><span>PouÅ¾Ã­vÃ¡ okluzory</span></label>
      <label><input type="checkbox" name="vision_devices_surgery"><span>Podstoupilo operaci oÄÃ­</span></label>
    </div>
  </div>
</fieldset>

<fieldset>
  <legend>SociÃ¡lnÃ­ anamnÃ©za</legend>
  <div class="qa-block">
    <label><span>V jakÃ©m typu bydlenÃ­ Å¾ijete?</span></label>
    <div class="select-group">
      <label><input type="radio" name="housing_type" value="-"><span>-</span></label>
      <label><input type="radio" name="housing_type" value="DÅ¯m"><span>DÅ¯m</span></label>
      <label><input type="radio" name="housing_type" value="Byt"><span>Byt</span></label>
      <label><input type="radio" name="housing_type" value="JinÃ©"><span>JinÃ©</span></label>
    </div>
  </div>
    <div class="qa-block hidden" id="q_housing_specification_detail">
    <label><span>MÅ¯Å¾ete typ bydlenÃ­ specifikovat?</span></label>
    <textarea class="long-text" name="housing_specification"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Jak jste s bydlenÃ­m spokojenÃ­?</span></label>
    <textarea class="long-text" name="housing_satisfaction"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Kolik lidÃ­ Å¾ije ve vaÅ¡Ã­ domÃ¡cnosti?</span></label>
    <input type="number" name="household_count">
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› vlastnÃ­ pokoj?</span></label>
    <div class="select-group">
      <label><input type="radio" name="child_own_room" value="-"><span>-</span></label>
      <label><input type="radio" name="child_own_room" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="child_own_room" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› vlastnÃ­ pracovnÃ­ stÅ¯l?</span></label>
    <div class="select-group">
      <label><input type="radio" name="child_own_desk" value="-"><span>-</span></label>
      <label><input type="radio" name="child_own_desk" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="child_own_desk" value="Ne"><span>Ne</span></label>
    </div>
  </div>
  
  <div class="qa-block">
    <label><span>Kolik hodin dennÄ› trÃ¡vÃ­te (vy nebo dalÅ¡Ã­ rodiÄe / peÄovatelÃ©) doma s dÄ›tmi?</span></label>
    <input type="number" name="time_with_children">
  </div>

  <div class="qa-block">
    <label><span>MÃ¡te prostor s dÃ­tÄ›tem nÄ›co procviÄovat?</span></label>
    <div class="select-group">
      <label><input type="radio" name="practice_with_child" value="-"><span>-</span></label>
      <label><input type="radio" name="practice_with_child" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="practice_with_child" value="Ne"><span>Ne</span></label>
    </div>
  </div>

  <div class="qa-block">
    <label><span>JakÃ¡ je vaÅ¡e oblÃ­benÃ¡ Äinnost s dÃ­tÄ›tem? (mÅ¯Å¾e jich bÃ½t i vÃ­ce)</span></label>
    <textarea class="long-text" name="fav_activity_with_child"></textarea>
  </div>

  <div class="qa-block">
    <label><span>JakÃ¡ je oblÃ­benÃ¡ Äinnost dÃ­tÄ›te obecnÄ›?</span></label>
    <textarea class="long-text" name="child_fav_activity"></textarea>
  </div>

  <div class="qa-block">
    <label><span>Jestli mÃ¡ dÃ­tÄ› oblÃ­benÃ½ film, jakÃ½ to je?</span></label>
    <input type="text" name="child_fav_movie">
  </div>

  <div class="qa-block">
    <label><span>Jestli mÃ¡ dÃ­tÄ› oblÃ­benou knihu, jakÃ¡ to je?</span></label>
    <input type="text" name="child_fav_book">
  </div>

  <div class="qa-block">
      <label><span>MÃ¡ dÃ­tÄ› pÅ™Ã­stup k telefonu nebo tabletu?</span></label>
      <div class="select-group">
        <label><input type="radio" name="child_has_device" value="-"><span>-</span></label>
        <label><input type="radio" name="child_has_device" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="child_has_device" value="Ne"><span>Ne</span></label>
      </div>
    </div>

  <div class="qa-block hidden" id="q_child_device_detail1">
    <label><span>Jak moc dÃ­tÄ› podle vÃ¡s pouÅ¾Ã­vÃ¡ mobil nebo tablet ve srovnÃ¡nÃ­ s vrstevnÃ­ky?</span></label>
    <textarea class="long-text" name="child_device_use_relative"></textarea>
  </div>

  <div class="qa-block hidden" id="q_child_device_detail2">
    <label><span>Co dÃ­tÄ› na telefonu nejÄastÄ›ji dÄ›lÃ¡? (seÅ™aÄte podle frekvence)</span></label>
    <textarea class="long-text" name="child_device_usage"></textarea>
  </div>

  <div class="qa-block hidden" id="q_child_device_detail3">
    <label><span>PokouÅ¡Ã­te se nÄ›jakÃ½m zpÅ¯sobem kontrolovat, co dÃ­tÄ› na telefonu dÄ›lÃ¡? (napÅ™. vÃ½chovnÄ› nebo omezenÃ­m pÅ™Ã­mo v telefonu)</span></label>
    <textarea class="long-text" name="child_device_control"></textarea>
  </div>

  <div class="qa-block">
    <label><span>Jak moc je pro vÃ¡s pouÅ¾Ã­vÃ¡nÃ­ mobilu Äi tabletu tÃ©matem ve vÃ½chovÄ›?</span></label>
    <textarea class="long-text" name="child_device_parenting_theme"></textarea>
  </div>
</fieldset>


<!-- Primary button -->
<button type="button" class="primary" onclick="window.print()">Tisk / UloÅ¾it pdf</button>

<!-- Secondary save/load/clear buttons -->
<div class="save-buttons">
  <button type="button" onclick="saveForm()">UloÅ¾it pro pÅ™Ã­Å¡tÄ›</button>
  <button type="button" onclick="loadForm()">NaÄÃ­st poslednÃ­</button>
  <button type="button" onclick="clearHistory()">Smazat historii</button>
</div>


<footer class="page-footer">
  <p>Â© 2025 MUNI FSS - Diagnostika dÃ­tÄ›te</p>
  <p>Garant: Mgr. Zuzana MasopustovÃ¡, PhD.</p>
  <p>VolnÄ› dostupnÃ© na webu: diagnostikaditete.cz</p>
</footer>

</form>

<script>


// Age calculation
const birthInput = document.getElementById('child_birthdate');
const ageInput = document.getElementById('child_age');

function formatYearsCzech(years) {
  if (years === 1) return '1 rok';
  if (years >= 2 && years <= 4) return `${years} roky`;
  return `${years} let`;
}

function formatMonthsCzech(months) {
  if (months === 1) return '1 mÄ›sÃ­c';
  if (months >= 2 && months <= 4) return `${months} mÄ›sÃ­ce`;
  return `${months} mÄ›sÃ­cÅ¯`;
}

birthInput.addEventListener('change', () => {
  const birthDate = new Date(birthInput.value);
  const today = new Date();

  if (isNaN(birthDate) || birthDate > today) {
    ageInput.value = 'Zkontrolujte, zda je datum narozenÃ­ dÃ­tÄ›te zadÃ¡no sprÃ¡vnÄ›.';
    return;
  }

  let years = today.getFullYear() - birthDate.getFullYear();
  let months = today.getMonth() - birthDate.getMonth();
  if (months < 0) { 
    years--; 
    months += 12; 
  }

  const yearText = formatYearsCzech(years);
  const monthText = formatMonthsCzech(months);
  ageInput.value = `${yearText}, ${monthText}`;
});



// setupConditional that supports radio groups and <select>
function setupConditional(selectName, detailId, triggerValue = 'Ano') {
  const detailDiv = document.getElementById(detailId);
  if (!detailDiv) return;
  detailDiv.style.display = 'none';

  const radios = Array.from(document.querySelectorAll(`[name="${selectName}"]`));
  const isRadioGroup = radios.length > 1 || (radios.length === 1 && radios[0].type === 'radio');

  if (isRadioGroup) {
    const update = () => {
      const checked = document.querySelector(`[name="${selectName}"]:checked`);
      detailDiv.style.display = checked && checked.value === triggerValue ? 'block' : 'none';
    };

    radios.forEach(r => r.addEventListener('change', update));
    update();
  } else {
    // Single select or input
    const elem = document.querySelector(`[name="${selectName}"]`);
    if (!elem) return;

    const update = () => {
      detailDiv.style.display = elem.value === triggerValue ? 'block' : 'none';
    };

    elem.addEventListener('change', update);
    update();
  }
}


setupConditional('mother_health', 'q_mother_health_detail', 'Ano');
setupConditional('father_health', 'q_father_health_detail', 'Ano');
setupConditional('other_carer_status', 'q_other_carer_detail', 'Ano');
setupConditional('mother_employed', 'q_mother_jobs_detail', 'Ano');
setupConditional('father_employed', 'q_father_jobs_detail', 'Ano');
setupConditional('has_siblings', 'q_siblings_detail', 'Ano');
setupConditional('child_has_device', 'q_child_device_detail1', 'Ano');
setupConditional('child_has_device', 'q_child_device_detail2', 'Ano');
setupConditional('child_has_device', 'q_child_device_detail3', 'Ano');
setupConditional('neurolog_exam', 'q_neurolog_exam_detail', 'Ano');
setupConditional('vision_issues', 'q_vision_issues_detail', 'Ano');
setupConditional('housing_type', 'q_housing_specification_detail', 'JinÃ©');



  // Auto-expand long textareas
  document.querySelectorAll('textarea.long-text').forEach(area => {
    area.addEventListener('input', () => {
      area.style.height = 'auto';
      area.style.height = area.scrollHeight + 'px';
    });
  });

// Dynamic generation for additional carers
const additionalCarersCountInput = document.getElementById('additional_carers_count');
const additionalCarersContainer = document.getElementById('additional_carers_container');
additionalCarersCountInput.addEventListener('input', () => {
  const count = parseInt(additionalCarersCountInput.value) || 0;
  additionalCarersContainer.innerHTML = '';
  for (let i = 1; i <= count; i++) {
    const fs = document.createElement('fieldset');
    fs.innerHTML = `
      <legend>DalÅ¡Ã­ vychovÃ¡vajÃ­cÃ­ osoba ${i}</legend>
      <label><span>JmÃ©no osoby ${i}:</span><input class="short-text" type="text" name="carer_${i}_name"></label>
      <label><span>VÄ›k osoby ${i}:</span><input type="number" name="carer_${i}_age"></label>
      <div class="qa-block"><label><span>JakÃ© jsou vaÅ¡e vztahy s osobou ${i}:</span></label><textarea class="long-text" name="carer_${i}_relation"></textarea></div>
      <div class="qa-block"><label><span>V jakÃ© domÃ¡cnosti osoba ${i} dÃ­tÄ› vychovÃ¡vÃ¡:</span></label><textarea class="long-text" name="carer_${i}_household"></textarea></div>
    `;
    additionalCarersContainer.appendChild(fs);
    fs.querySelectorAll('textarea.long-text').forEach(area => {
      area.addEventListener('input', () => {
        area.style.height = 'auto';
        area.style.height = area.scrollHeight + 'px';
      });
    });
  }
});

// Dynamic generation for siblings
const siblingsCountInput = document.getElementById('siblings_count');
const siblingsContainer = document.getElementById('siblings_container');
siblingsCountInput.addEventListener('input', () => {
  const count = parseInt(siblingsCountInput.value) || 0;
  siblingsContainer.innerHTML = '';
  for (let i = 1; i <= count; i++) {
    const fs = document.createElement('fieldset');
    fs.innerHTML = `
      <legend>Sourozenec ${i}</legend>
      <label><span>JmÃ©no sourozence ${i}:</span><input class="short-text" type="text" name="sibling_${i}_name"></label>
      <label><span>VÄ›k sourozence ${i}:</span><input type="number" name="sibling_${i}_age"></label>
      <div class="qa-block">
        <label><span>Jsou dÃ­tÄ› a sourozenec biologiÄtÃ­ pÅ™Ã­buznÃ­:</span></label>
        <div class="select-group">
          <label><input type="radio" name="sibling_${i}_biological" value="-"><span>-</span></label>
          <label><input type="radio" name="sibling_${i}_biological" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="sibling_${i}_biological" value="Ne"><span>Ne</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label><span>MÃ¡ dÃ­tÄ› se sourozencem spoleÄnÃ© rodiÄe:</span></label>
        <div class="select-group">
          <label><input type="radio" name="sibling_${i}_common_parents" value="-"><span>-</span></label>
          <label><input type="radio" name="sibling_${i}_common_parents" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="sibling_${i}_common_parents" value="Ne"><span>Ne</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label><span>Å½ijÃ­ ve stejnÃ© domÃ¡cnosti:</span></label>
        <div class="select-group">
          <label><input type="radio" name="sibling_${i}_same_household" value="-"><span>-</span></label>
          <label><input type="radio" name="sibling_${i}_same_household" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="sibling_${i}_same_household" value="Ne"><span>Ne</span></label>
        </div>
      </div>
      <div class="qa-block"><label><span>JakÃ½ majÃ­ vztah:</span></label><textarea class="long-text" name="sibling_${i}_relationship"></textarea></div>
      <div class="qa-block"><label><span>FyzickÃ© a psychickÃ© diagnÃ³zy:</span></label><textarea class="long-text" name="sibling_${i}_diagnoses"></textarea></div>
    `;
    siblingsContainer.appendChild(fs);
    fs.querySelectorAll('textarea.long-text').forEach(area => {
      area.addEventListener('input', () => {
        area.style.height = 'auto';
        area.style.height = area.scrollHeight + 'px';
      });
    });
  }
});


//saving

const formStorageKey = 'child_questionnaire_data';

function saveForm() {
  const form = document.querySelector('form');
  const data = {};

  form.querySelectorAll('input, select, textarea').forEach(el => {
    if (el.type === 'radio') {
      if (el.checked) data[el.name] = el.value;
    } else if (el.type === 'checkbox') {
      data[el.name] = el.checked;
    } else {
      data[el.name] = el.value;
    }
  });

  // Save dynamic carers
  const carers = [];
  document.querySelectorAll('#additional_carers_container fieldset').forEach(fs => {
    const carerData = {};
    fs.querySelectorAll('input, textarea').forEach(el => {
      carerData[el.name] = el.value;
    });
    carers.push(carerData);
  });
  data['additional_carers'] = carers;

  // Save dynamic siblings
  const siblings = [];
  document.querySelectorAll('#siblings_container fieldset').forEach(fs => {
    const siblingData = {};
    fs.querySelectorAll('input, select, textarea').forEach(el => {
      if (el.type === 'radio') {
        if (el.checked) siblingData[el.name] = el.value;
      } else if (el.type === 'checkbox') {
        siblingData[el.name] = el.checked;
      } else {
        siblingData[el.name] = el.value;
      }
    });
    siblings.push(siblingData);
  });
  data['siblings'] = siblings;

  localStorage.setItem(formStorageKey, JSON.stringify(data));
  alert("FormulÃ¡Å™ byl uloÅ¾en.");
}

// Load saved data
function loadForm() {
  const saved = localStorage.getItem(formStorageKey);
  if (!saved) {
    alert("Å½Ã¡dnÃ¡ uloÅ¾enÃ¡ data nejsou k dispozici.");
    return;
  }
  const data = JSON.parse(saved);
  const form = document.querySelector('form');

  // Reset form first
  form.reset();
  document.getElementById('additional_carers_container').innerHTML = '';
  document.getElementById('siblings_container').innerHTML = '';

  // Load static fields
  form.querySelectorAll('input, select, textarea').forEach(el => {
    if (el.type === 'radio') {
      if (data[el.name] === el.value) el.checked = true;
    } else if (el.type === 'checkbox') {
      el.checked = !!data[el.name];
    } else if (data[el.name] !== undefined) {
      el.value = data[el.name];
    }
  });

  // Recreate dynamic carers
  if (data['additional_carers']) {
    data['additional_carers'].forEach((carer, i) => {
      const fs = document.createElement('fieldset');
      fs.innerHTML = `
        <legend>DalÅ¡Ã­ vychovÃ¡vajÃ­cÃ­ osoba ${i + 1}</legend>
        <label><span>JmÃ©no osoby ${i + 1}:</span><input class="short-text" type="text" name="carer_${i+1}_name" value="${carer['carer_' + (i+1) + '_name'] || ''}"></label>
        <label><span>VÄ›k osoby ${i + 1}:</span><input type="number" name="carer_${i+1}_age" value="${carer['carer_' + (i+1) + '_age'] || ''}"></label>
        <div class="qa-block"><label><span>JakÃ© jsou vaÅ¡e vztahy s osobou ${i + 1}:</span></label><textarea class="long-text" name="carer_${i+1}_relation">${carer['carer_' + (i+1) + '_relation'] || ''}</textarea></div>
        <div class="qa-block"><label><span>V jakÃ© domÃ¡cnosti osoba ${i + 1} dÃ­tÄ› vychovÃ¡vÃ¡:</span></label><textarea class="long-text" name="carer_${i+1}_household">${carer['carer_' + (i+1) + '_household'] || ''}</textarea></div>
      `;
      document.getElementById('additional_carers_container').appendChild(fs);
    });
  }

  // Recreate dynamic siblings
  if (data['siblings']) {
    data['siblings'].forEach((sib, i) => {
      const fs = document.createElement('fieldset');
      fs.innerHTML = `
        <legend>Sourozenec ${i + 1}</legend>
        <label><span>JmÃ©no sourozence ${i + 1}:</span><input class="short-text" type="text" name="sibling_${i+1}_name" value="${sib['sibling_' + (i+1) + '_name'] || ''}"></label>
        <label><span>VÄ›k sourozence ${i + 1}:</span><input type="number" name="sibling_${i+1}_age" value="${sib['sibling_' + (i+1) + '_age'] || ''}"></label>
        <label><span>Jsou dÃ­tÄ› a sourozenec biologiÄtÃ­ pÅ™Ã­buznÃ­:</span></label>
        <select name="sibling_${i+1}_biological">
          <option value="-" ${sib['sibling_' + (i+1) + '_biological']==='-'?'selected':''}>-</option>
          <option value="Ano" ${sib['sibling_' + (i+1) + '_biological']==='Ano'?'selected':''}>Ano</option>
          <option value="Ne" ${sib['sibling_' + (i+1) + '_biological']==='Ne'?'selected':''}>Ne</option>
        </select>
        <label><span>MÃ¡ dÃ­tÄ› se sourozencem spoleÄnÃ© rodiÄe:</span></label>
        <select name="sibling_${i+1}_common_parents">
          <option value="-" ${sib['sibling_' + (i+1) + '_common_parents']==='-'?'selected':''}>-</option>
          <option value="Ano" ${sib['sibling_' + (i+1) + '_common_parents']==='Ano'?'selected':''}>Ano</option>
          <option value="Ne" ${sib['sibling_' + (i+1) + '_common_parents']==='Ne'?'selected':''}>Ne</option>
        </select>
        <label><span>Å½ijÃ­ ve stejnÃ© domÃ¡cnosti:</span></label>
        <select name="sibling_${i+1}_same_household">
          <option value="-" ${sib['sibling_' + (i+1) + '_same_household']==='-'?'selected':''}>-</option>
          <option value="Ano" ${sib['sibling_' + (i+1) + '_same_household']==='Ano'?'selected':''}>Ano</option>
          <option value="Ne" ${sib['sibling_' + (i+1) + '_same_household']==='Ne'?'selected':''}>Ne</option>
        </select>
        <div class="qa-block"><label><span>JakÃ½ majÃ­ vztah:</span></label><textarea class="long-text" name="sibling_${i+1}_relationship">${sib['sibling_' + (i+1) + '_relationship'] || ''}</textarea></div>
        <div class="qa-block"><label><span>FyzickÃ© a psychickÃ© diagnÃ³zy:</span></label><textarea class="long-text" name="sibling_${i+1}_diagnoses">${sib['sibling_' + (i+1) + '_diagnoses'] || ''}</textarea></div>
      `;
      document.getElementById('siblings_container').appendChild(fs);
    });
  }

  alert("FormulÃ¡Å™ byl obnoven z poslednÃ­ uloÅ¾enÃ© verze.");
}

// Clear history
function clearHistory() {
  if (confirm("Opravdu chcete smazat uloÅ¾enou historii?")) {
    localStorage.removeItem(formStorageKey);
    document.querySelector('form').reset();
    document.getElementById('additional_carers_container').innerHTML = '';
    document.getElementById('siblings_container').innerHTML = '';
    alert("Historie byla smazÃ¡na.");
  }
}

</script>

</body>
</html>
