<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DotaznÃ­k dÃ­tÄ›te</title>
<style>
  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f6f8; color: #333; margin: 0; padding: 20px; }
  h1 { color: #0000dc; text-align: center; margin-bottom: 30px; }
  form { max-width: 900px; margin: 0 auto; background-color: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
  fieldset { border: 1px solid #ccc; border-radius: 8px; padding: 15px; margin-bottom: 20px; background-color: #fafafa; min-width: 0; }
  legend { font-weight: bold; color: #0000dc; font-size: 16px; padding: 0 5px; }
  label {
    display: block;
    margin-bottom: 0;
    font-weight: 500;
    page-break-inside: avoid;
  }
  input, select, textarea {
    padding: 6px;
    border-radius: 5px;
    border: 1px solid #ccc;
    font-size: 16px;
    width: 100%;
    margin-left: 0;
    min-width: 0;
    box-sizing: border-box;
    margin-top: 6px;
    margin-bottom: 22px;
    line-height: 1.5;
    height: 40px;
    font-family: "Times New Roman", Times, serif;
    vertical-align: middle;
  }

  /* Fix for date inputs on mobile devices */
  input[type="date"] {
    -webkit-appearance: none;
    appearance: none;
    background-color: #fff;
  }

  /* Add this block for consistent focus styles */
  input:focus-visible,
  select:focus-visible,
  textarea:focus-visible {
    border-color: #0000dc; /* Change border to your accent color */
    outline: none; /* Remove the default browser outline */
  }

  /* Hide arrows from number inputs - for Chrome, Safari, Edge, Opera */
  input[type=number]::-webkit-outer-spin-button,
  input[type=number]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  /* Hide arrows from number inputs - for Firefox */
  input[type=number] {
    -moz-appearance: textfield;
    appearance: textfield;
  }

  textarea.long-text {
    width: 100%;
    overflow-wrap: break-word;
    resize: none;
    box-sizing: border-box;
    margin-top: 6px;
    margin-bottom: 22px;
  }
  
/* --- Button Styles --- */

/* Base button style for consistent sizing and font */
.btn {
  padding: 12px 22px;
  font-size: 15px;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.2s, border-color 0.2s, color 0.2s;
  border: 1px solid transparent; /* Reserve space for border */
  margin: 0; /* Reset margin */
}

/* Primary button style */
.btn.primary {
  background-color: #0000dc;
  color: white;
  border-color: #0000dc;
  font-weight: bold;
}

.btn.primary:hover {
  background-color: #0000aa;
  border-color: #0000aa;
}

/* Secondary button style */
.btn.btn-secondary {
  background-color: white;
  color: #0000dc;
  border: 1px solid #0000dc;
  font-weight: 500;
}

.btn.btn-secondary:hover:not(:disabled) {
  background-color: #e9f1ff; /* Light blue from tip-block */
}

.btn.btn-secondary:disabled {
  color: #999;
  border-color: #ccc;
  cursor: not-allowed;
}

/* Danger button style */
.btn.btn-danger {
  background-color: white;
  color: #dc3545; /* Bootstrap danger red */
  border: 1px solid #dc3545;
  font-weight: 500;
}

.btn.btn-danger:hover:not(:disabled) {
  background-color: #dc354510; /* Light red, consistent with other hovers */
}

/* Styl pro nenÃ¡padnÃ© smazÃ¡nÃ­ dat */
.btn-delete-link {
    background: none;
    border: none;
    color: #888; /* Å edÃ¡ barva, aby tlaÄÃ­tko "svÃ­tilo" co nejmÃ©nÄ› */
    text-decoration: underline;
    cursor: pointer;
    font-size: 12px;
    padding: 0;
    font-family: inherit;
    transition: color 0.2s ease;
}

.btn-delete-link:hover {
    color: #dc3545; /* ZÄervenÃ¡ aÅ¾ pÅ™i najetÃ­ (vizuÃ¡lnÃ­ varovÃ¡nÃ­) */
}


.alert-action-link {
    color: inherit; /* PÅ™ebÃ­rÃ¡ barvu okolnÃ­ho textu */
    text-decoration: underline;
    cursor: pointer;
    font-weight: inherit; /* VypadÃ¡ jako bÄ›Å¾nÃ½ text */
    transition: color 0.2s ease;
}

.alert-action-link:hover {
    color: #dc3545; /* ZÄervenÃ¡ pÅ™i najetÃ­ (shoda s mazacÃ­m odkazem) */
}


/* Flex container for save buttons */
.save-buttons {
  display: flex;
  gap: 10px;
  align-items: center; /* Align items vertically */
}

/* Smooth transitions for conditional blocks */
.qa-block {
  transition: opacity 0.4s ease, max-height 0.4s ease, margin 0.4s ease, padding 0.4s ease;
  overflow: hidden;
}

.qa-block.hidden {
  opacity: 0;
  max-height: 0;
  margin-top: 0 !important;
  margin-bottom: 0 !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}

.qa-block.hidden.is-visible {
  opacity: 1;
  max-height: none; /* Allow content to expand to its natural height. */
  margin-bottom: 22px !important; /* Restore original spacing */
}


/* Unified select-group alignment */
.select-group {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  width: 100%;
  margin-top: 6px;
  margin-bottom: 22px;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 8px;
  background: #fff;
  align-items: center;
  justify-content: flex-start;
  box-sizing: border-box;
}

.select-group label {
  display: flex;
  align-items: center;
  gap: 6px; /* spacing between input and text */
  font-weight: 500;
  margin: 0;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.15s ease, color 0.15s ease;
  user-select: none;
  min-height: 32px;
}

.select-group input[type="radio"],
.select-group input[type="checkbox"] {
  width: 18px;
  height: 18px;
  margin: 0; /* remove margin-right */
  accent-color: #0000dc;
}

.select-group label span {
  display: inline-block;
  padding: 2px 4px;
  border-radius: 4px;
  line-height: 1.2;
  height: auto;
}

html:not(.preview-mode-active) .select-group label:hover span {
  background-color: #0000dc08;
}

html:not(.preview-mode-active) .select-group input[type="radio"]:checked + span,
html:not(.preview-mode-active) .select-group input[type="checkbox"]:checked + span {
  background-color: #0000dc10;
  color: #0000dc;
}

.select-group input[type="radio"]:focus-visible,
.select-group input[type="checkbox"]:focus-visible {
  outline: 2px solid rgba(0, 0, 220, 0.2);
  outline-offset: 2px;
}


/* --- Custom styling for "Bez odpovÄ›di" --- */

/* 1. Default state: Grey text for "Bez odpovÄ›di" */
.select-group input[value="Bez odpovÄ›di"] + span {
  color: #6c757d; /* A neutral grey */
  transition: background-color 0.15s ease, color 0.15s ease; /* Smooth transition */
}

/* 2. Hover state: Highlight with a light red background */
html:not(.preview-mode-active) .select-group label:has(input[value="Bez odpovÄ›di"]):hover span {
  background-color: #dc354510; /* Light red background */
}

/* 3. Selected state: Red text and light red background */
html:not(.preview-mode-active) .select-group input[value="Bez odpovÄ›di"]:checked + span {
  color: #dc3545; /* Red text */
  background-color: #dc354510; /* Light red background */
}


  /* Tip / note block */
.tip-block {
  background-color: #e9f1ff; /* light blue tone matching your accent */
  border-bottom: 3px solid #B3C7FF;
  border-radius: 8px;
  padding: 14px 18px; /* Keep padding consistent */
  margin: 10px 0 20px;  font-size: 15px;
  font-style: italic;
  line-height: 1.6;
  color: #222;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  position: relative; /* Needed to position the arrow */
}

/* Arrow pointing DOWN (for tip blocks ABOVE a question) */
.tip-block::after {
  content: '';
  position: absolute;
  bottom: -10px; /* Position the arrow just below the block */
  left: 30px; /* Indent the arrow slightly */
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-top: 10px solid #B3C7FF; /* Arrow color matches the block */
}

/* New modifier class for a tip block placed UNDER a question */
.tip-block.tip-block-under {
  margin-top: 0px; /* Creates space from the question above */
  margin-bottom: 30px; /* Removes bottom margin */
  border-bottom: 0;
  border-top: 3px solid #B3C7FF; /* Change border to top */
}

/* Arrow pointing UP (for tip blocks UNDER a question) */
.tip-block.tip-block-under::after {
  bottom: auto; /* Unset the 'bottom' property from the default arrow */
  top: -10px; /* Position the arrow just above the block */
  border-top: none; /* Remove the downward-pointing arrow */
  border-bottom: 10px solid #B3C7FF; /* Create an upward-pointing arrow */
}

.tip-block::before {
  content: "ğŸ’¡ ProÄ se ptÃ¡me?";
  font-weight: 300;
  font-style: normal;
  color: #0000dc;
  display: block;
  margin-bottom: 6px;
}

/* Instruction block style */
.instruction-block {
  background-color: #f8f9fa;
  border-left: 3px solid #6c757d; /* Neutral grey border */
  border-radius: 8px;
  padding: 14px 18px;
  margin: 20px 0 30px 0;
  font-size: 15px;
  line-height: 1.6;
  color: #222;
}

.instruction-block::before {
  content: "Instrukce k vyplÅˆovÃ¡nÃ­";
  font-weight: bold;
  color: #333;
  display: block;
  margin-bottom: 8px;
}

.instruction-block.sharing-options::before {
  content: "MoÅ¾nosti uloÅ¾enÃ­ a sdÃ­lenÃ­";
  font-weight: bold;
  color: #333;
}

.instruction-block ul {
  padding-left: 25px; 
  margin-top: 10px;
  margin-bottom: 10px;
}

.manual-alert {
    background-color: #f4f8ff;
    border-left: 3px solid #0000dc;
    border-radius: 8px;
    padding: 12px 16px;
    margin: 15px 0;
    font-size: 14px;
    line-height: 1.5;
    color: #333;
}

.manual-alert strong {
    color: #0000dc;
    display: block; 
    margin-bottom: 4px; 
    font-weight: 600;
}


  .page-footer {
  width: 100%;
  text-align: center;
  font-size: 10pt;
  color: #666;
  font-family: "Times New Roman", Times, serif;
  border-top: 1px solid #ccc;
  padding: 10px 0;
  margin-top: 40px;
  position: relative;
}

/* --- Preview Floating Controls --- */
.preview-controls {
  display: none; /* Hidden by default */
}

.preview-mode-active .preview-controls {
  display: flex;
  gap: 15px;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 15px 25px;
  background-color: rgba(255, 255, 255, 0.95);
  border-radius: 12px;
  box-shadow: 0 -4px 12px rgba(0,0,0,0.15);
  z-index: 1001;
  border: 1px solid #ddd;
  border-bottom: none;
}



/* --- A4 Preview Layout --- */
@media screen {
  .preview-mode-active {
    background-color: #e0e0e0; /* Grey backdrop */
  }
  .preview-mode-active body {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0;
  }

  /* Scale down the A4 preview on smaller screens */
  @media (max-width: 230mm) {
    .preview-mode-active form {
      /* Calculate the scale factor to fit the viewport width */
      transform: scale(calc(100vw / 230mm));
      transform-origin: top center;
      /* Adjust margin to account for scaling */
      margin-top: calc(20px * (230mm / 100vw));
      margin-bottom: calc(20px * (230mm / 100vw));
    }
  }
}

.print-preview.preview-mode-active body, .print-preview body {
  background-color: #e0e0e0;
}


.print-preview fieldset > label,
.print-preview fieldset > input,
.print-preview fieldset > select,
.print-preview fieldset > textarea,
.print-preview fieldset > .select-group,
.print-preview fieldset > .qa-block {
  page-break-inside: avoid !important;
}

.print-preview #additional_carers_container fieldset,
.print-preview #siblings_container fieldset {
  border: none !important;
  margin: 0 0 10mm 0 !important;
  padding: 0 !important;
}

.print-preview #additional_carers_container legend,
.print-preview #siblings_container legend {
  font-size: 13pt !important;
  color: #000 !important;
  font-weight: bold !important;
  margin-left: 0 !important;
  margin-bottom: 4mm !important;
}

.print-preview #additional_carers_container .qa-block,
.print-preview #siblings_container .qa-block {
  margin-left: 8mm !important;
}

.print-preview #additional_carers_container span,
.print-preview #siblings_container span {
  margin-left: 0 !important;
  text-indent: 0 !important;
}

.print-preview h1 {
  font-weight: bold;
  font-size: 20pt;
  color: #0000dc;
  margin-bottom: 20px;
  font-family: "Times New Roman", Times, serif;
}

.print-preview .print-only-header {
  display: block;
}

.print-preview .tip-block,
.print-preview .instruction-block {
  display: none;
}

.preview-mode-active form {
  width: 230mm;
  min-height: 297mm;
  margin: 20px 0; /* Add some vertical margin for spacing from screen edges */
  padding: 20mm;
  background-color: white;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  border-radius: 0;
  box-sizing: border-box;
  border: none;
}

.print-preview form {
  font-family: "Times New Roman", Times, serif;
}

.print-preview fieldset {
  background: none;
  border: none !important;
  padding: 0 !important;
  margin-bottom: 25px !important;
  font-family: "Times New Roman", Times, serif;
}
.preview-mode-active fieldset {
  border-radius: 0;
}

.print-preview legend {
  color: #0000dc;
  font-size: 14pt;
  font-weight: normal;
  border-bottom: none;
  margin-left: 0 !important;
  padding: 0 !important;
  margin-bottom: 25px !important;
  text-align: left !important;
  font-family: "Times New Roman", Times, serif;
}

.print-preview label {
  display: block !important;
  justify-content: flex-start;
  margin-bottom: 6px !important;
  page-break-inside: avoid !important;
  font-weight: normal;
  color: black;
  font-family: "Times New Roman", Times, serif;
}

.print-preview label span {
  display: block;
  margin-bottom: 4px;
  font-weight: normal;
  color: black;
  font-family: "Times New Roman", Times, serif;
}

.print-preview input,
.print-preview select,
.print-preview textarea {
  display: block !important;
  border: none;
  background: none;
  width: 100% !important;
  font-weight: normal;
  margin-left: 0 !important;
  color: #444;
  font-family: "Times New Roman", Times, serif;
  font-size: 12pt !important;
  page-break-inside: auto !important;
  margin-bottom: 22px !important;
}
/* Make inputs non-editable in preview */
.print-preview.preview-mode-active input,
.print-preview.preview-mode-active select,
.print-preview.preview-mode-active textarea {
  pointer-events: none;
  caret-color: transparent;
}

.print-preview textarea {
  resize: none;
  white-space: pre-wrap;
  overflow: visible !important;
}

.print-preview .qa-block > label {
  page-break-after: avoid !important;
}

.print-preview select {
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
  pointer-events: none;
}

.print-preview select::-ms-expand { display: none !important; }

.print-preview textarea::-webkit-scrollbar { display: none !important; }

.print-preview .select-group {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 16px !important;
  margin-top: 0 !important;
  margin-bottom: 22px !important;
  padding: 0 !important;
  background: none !important;
  border: none !important;
  page-break-inside: avoid !important;
  pointer-events: none; /* Disable interaction on the whole group */
}

.print-preview .select-group label {
  display: flex !important;
  align-items: center !important;
  gap: 6px !important;
  font-weight: normal !important;
  font-size: 12pt !important;
  color: #000 !important;
  padding: 0 !important;
  margin: 0 !important;
  background: none !important;
  border: none !important;
  cursor: default !important;
}

.print-preview .select-group input[type="radio"],
.print-preview .select-group input[type="checkbox"] {
  width: 14px !important;
  height: 14px !important;
  margin: 0 !important;
  accent-color: #000 !important;
}

.print-preview .select-group label span {
  display: inline-block !important;
  line-height: 1.2 !important;
  color: #000 !important;
  font-weight: normal !important;
}

.print-preview .select-group input[type="radio"]:checked + span,
.print-preview .select-group input[type="checkbox"]:checked + span {
  font-weight: bold !important;
}

.print-preview .qa-block {
  display: block;
  margin-bottom: 22px !important;
}

.print-preview #preview-button,
.print-preview .save-buttons,
.print-preview #json-file-input {
 display: none !important; }

.print-preview .qa-block.hidden:not(.is-visible) { display: none !important; }

.print-preview .unanswered-mark {
  display: inline !important;
  font-weight: bold;
  color: #d00;
  margin-right: 6px;
}

.print-preview .unanswered-dot {
  display: none !important;
}

.print-preview .page-footer {
  display: none;
}

.print-preview .survey-utility-header {
    display: none !important;
}

.print-preview .header-wide {
  display: none;
}

/* --- Print Styles --- */

@media print {
  fieldset > label,
  fieldset > input,
  fieldset > select,
  fieldset > textarea,
  fieldset > .select-group,
  fieldset > .qa-block {
    page-break-inside: avoid !important;
  }

  @page { 
    size: A4; 
    margin: 20mm; 
  }

  html {
    font-size: 12pt; /* Set a base font size for print to prevent scaling issues */
  }


  form {
    box-shadow: none !important;
    padding: 0 !important;
  }

  /* Keep dynamic fieldsets (siblings, carers) visually grouped */
  #additional_carers_container fieldset,
  #siblings_container fieldset {
    border: none !important;
    margin: 0 0 10mm 0 !important; /* Remove indent, rely on qa-block margin */
    padding: 0 !important;
  }

  #additional_carers_container legend,
  #siblings_container legend {
    font-size: 13pt !important;
    color: #000 !important;
    font-weight: bold !important;
    margin-left: 0 !important;
    margin-bottom: 4mm !important;
  }

  /* Consistent alignment inside generated carers/siblings */
  #additional_carers_container .qa-block,
  #siblings_container .qa-block {
    margin-left: 8mm !important; /* Indent the questions for hierarchy */
  }

  #additional_carers_container span,
  #siblings_container span {
    margin-left: 0 !important;
    text-indent: 0 !important;
  }

  body {
    background-color: white;
    padding: 0;
    margin: 0;
    font-size: 12pt;
    font-family: "Times New Roman", Times, serif;
    color: black;
  }

  h1 {
    font-weight: bold;
    font-size: 20pt;
    color: #0000dc;
    margin-bottom: 20px;
    font-family: "Times New Roman", Times, serif;
  }

  .print-only-header {
    display: block !important;
  }

  .tip-block,
  .instruction-block {
    display: none;
  }

  form {
    box-shadow: none;
    background: none;
    padding: 0;
    max-width: 100%;
    font-family: "Times New Roman", Times, serif;
  }

  fieldset {
    background: none;
    border: none !important;
    padding: 0 !important;
    margin-bottom: 25px !important;
    font-family: "Times New Roman", Times, serif;
  }

  legend {
    color: #0000dc; 
    font-size: 14pt;
    font-weight: normal;
    border-bottom: none;
    margin-left: 0 !important;
    padding: 0 !important;
    margin-bottom: 25px !important;
    text-align: left !important;
    font-family: "Times New Roman", Times, serif;
  }

  label {
    display: block !important;
    justify-content: flex-start;
    margin-bottom: 6px !important;
    page-break-inside: avoid !important;
    font-weight: normal;
    color: black; 
    font-family: "Times New Roman", Times, serif;
  }

  label span {
    display: block;
    margin-bottom: 4px;
    font-weight: normal;
    color: black; 
    font-family: "Times New Roman", Times, serif;
  }

  input,
  select,
  textarea {
    display: block !important;
    border: none;
    background: none;
    width: 100% !important;
    font-weight: normal;
    margin-left: 0 !important;
    color: #444; 
    font-family: "Times New Roman", Times, serif;
    font-size: 12pt !important;
    page-break-inside: auto !important; /* Allow breaking inside long textareas */
    margin-bottom: 22px !important; /* Keep consistent spacing */
  }

  textarea {
    resize: none;
    white-space: pre-wrap;
    overflow: visible !important;
  }
  
  /* Ensure the label and the start of the textarea stay together */
  .qa-block > label {
    page-break-after: avoid !important;
  }

  select {
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    pointer-events: none;
  }

  select::-ms-expand { display: none !important; }

  textarea::-webkit-scrollbar { display: none !important; }

  .select-group {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 16px !important;
    margin-top: 0 !important;
    margin-bottom: 22px !important;
    padding: 0 !important;
    background: none !important;
    border: none !important;
    page-break-inside: avoid !important;
  }

  .select-group label {
    display: flex !important;
    align-items: center !important;
    gap: 6px !important;
    font-weight: normal !important;
    font-size: 12pt !important;
    color: #000 !important;
    padding: 0 !important;
    margin: 0 !important;
    background: none !important;
    border: none !important;
    cursor: default !important;
  }

  .select-group input[type="radio"],
  .select-group input[type="checkbox"] {
    width: 14px !important;
    height: 14px !important;
    margin: 0 !important;
    accent-color: #000 !important;
  }

  .select-group label span {
    display: inline-block !important;
    line-height: 1.2 !important;
    color: #000 !important;
    font-weight: normal !important;
  }

  .select-group input[type="radio"]:checked + span,
  .select-group input[type="checkbox"]:checked + span {
    font-weight: bold !important;
  }

  .qa-block {
    display: block;
    margin-bottom: 22px !important;
    /* The page-break-after:avoid on the label is more effective for this. */
  }

  /* Hide buttons and other non-printable elements */
  button,
  #json-file-input { display: none !important; }
  
  /* Only hide conditional blocks that are NOT visible on screen */
  .qa-block.hidden:not(.is-visible) { display: none !important; }

  /* Style for the unanswered question marker */
  .unanswered-mark {
    display: inline !important; /* Show the asterisk */
    font-weight: bold;
    color: #d00; /* Make it red to stand out */
    margin-right: 6px;
  }

  /* Hide the live validation dot on print */
  .unanswered-dot {
    display: none !important;
  }

  .preview-controls {
    display: none !important; /* Hide floating controls in the actual print output */
  }


 /*  .page-footer {
    display: block !important;
    position: relative;
    text-align: center;
    font-size: 10pt;
    color: #666;
    font-family: "Times New Roman", Times, serif;
    border-top: 1px solid #ccc;
    padding-top: 4mm;
    margin-top: 10mm;
    background: none;
  }

  .page-footer p {
    margin: 1px 0;
    line-height: 1.2;
  }
 */
.page-footer {
    display: none;
  } 

  .header-wide {
    display: none;
  }
}

/* --- Unanswered Question Dot (Live) --- */
.unanswered-dot {
  display: inline-block;
  width: 8px;
  height: 8px;
  background-color: #0000dc; /* Blue dot */
  border-radius: 50%;
  margin-right: 8px; /* Keep margin to prevent text jump */
  vertical-align: middle;
  transition: opacity 0.4s ease, width 0.4s ease, margin-right 0.4s ease; /* Animate width and margin */
  opacity: 1;
}


.unanswered-dot.answered {
  opacity: 0;
  width: 0; /* Animate width to 0 */
  margin-right: 0; /* Animate margin to 0 */
}

/* --- Mobile-specific adjustments --- */
@media (max-width: 600px) {
  body:not(.preview-mode-active) {
    padding: 5px; /* Reduce body padding on small screens */
  }
  form:not(.preview-mode-active form) {
    padding: 7px; /* Reduce form padding on small screens */
  }
}


/* --- Header bar --- */
.survey-utility-header {
    width: 100%;
    background-color: #ffffff;
    border-bottom: 1px solid #e0e0e0;
    padding: 8px 0;
    font-size: 13px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #666;
}

.header-inner {
    max-width: 900px; /* ZarovnÃ¡no s Å¡Ã­Å™kou vaÅ¡eho formulÃ¡Å™e */
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
}

.header-link, .version-link {
    text-decoration: none;
    color: #666;
    transition: color 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 5px;
}

.header-left {
    display: flex;
    gap: 25px;
}

.header-right {
    color: #0000dc;
    font-family: 'Roboto', sans-serif;
}

.header-link:hover {
    color: #0000dc;
}

.feedback-link {
    font-weight: 500;
}

.version-link {
    font-family: monospace;
    background: #f4f6f8;
    padding: 2px 8px;
    border-radius: 4px;
}

.version-link:hover {
    background: #0000dc10;
    color: #0000dc;
}

.changelog-text {
    font-size: 11px;
    opacity: 0.7;
}

.icon {
    font-size: 14px;
}

/* SkrytÃ­ v tiskovÃ©m nÃ¡hledu a pÅ™i tisku */
@media print {
    .survey-utility-header {
        display: none !important;
    }
}

/* MobilnÃ­ Ãºprava */
@media (max-width: 600px) {
    .header-inner {
        flex-direction: column;
        gap: 10px;
        text-align: center;
    }
}

/* Headline styles */

:root {
    --muni-blue: #0000dc;
    --text-black: #000000;
    --font-heavy: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
}

.header-wide {
    max-width: 1000px;
    margin: 60px auto;
    padding: 0 40px;
    display: flex;
    flex-direction: column;
    align-items: flex-end; /* PravostrannÃ© zarovnÃ¡nÃ­ */
    font-family: var(--font-heavy);
}

/* HlavnÃ­ titul na jednom Å™Ã¡dku */
.title-single-line {
    white-space: nowrap;
    color: var(--muni-blue);
    font-weight: 900;
    font-size: 32pt;
    line-height: 1;
    margin: 0;
    text-transform: uppercase;
    letter-spacing: -1px;
}

/* Podnadpis pod titulem */
.subtitle-wide {
    color: var(--text-black);
    font-weight: 700;
    font-size: 14pt;
    text-transform: uppercase;
    margin: 10px 0 0 0;
    letter-spacing: 2px;
}

/* GrafickÃ¡ liÅ¡ta s linkou a teÄkami */
.accent-row {
    display: flex;
    align-items: center;
    width: 100%;
    margin-top: 30px;
    justify-content: flex-end;
}

.accent-line {
    height: 2.5px;
    background-color: var(--muni-blue);
    flex-grow: 1;
    max-width: 600px;
    margin-right: 20px;
}

.dots-set {
    display: flex;
    align-items: center;
    gap: 12px;
}

.dot { border-radius: 50%; }

.dot-full {
    width: 20px;
    height: 20px;
    border: 2px solid var(--muni-blue);
    background-color: var(--muni-blue);
}

.dot-outline {
    width: 19px;
    height: 19px;
    border: 3px solid var(--muni-blue);
    background-color: transparent;
}

/* ResponzivnÃ­ chovÃ¡nÃ­ */
@media (max-width: 850px) {
    .title-single-line { font-size: 24pt; }
    .accent-line { max-width: 300px; }
}

@media (max-width: 600px) {
    .header-wide { align-items: center; text-align: center; }
    .title-single-line { white-space: normal; font-size: 20pt; }
    .accent-row { justify-content: center; }
    .accent-line { display: none; }
}

/* Hide the plain header on screen, show only in print/preview */
.print-only-header {
    display: none;
}

</style>
</head>
<body>


<form id="questionnaire">

  <div class="survey-utility-header">
    <div class="header-inner">
        <div class="header-left">
            <a href="manual.pdf" target="_blank" class="header-link">
                <span class="icon">ğŸ“–</span> MetodickÃ½ manuÃ¡l
            </a>
            <a href="https://forms.gle/EpxAt2FqTxr5nCu1A" target="_blank" class="header-link feedback-link">
                <span class="icon">ğŸ’¬</span> ZpÄ›tnÃ¡ vazba
            </a>
        </div>
        <div class="header-right">
        Verze 2.1 alpha
        </div>
    </div>
</div>


<header class="header-wide">
    <h1 class="title-single-line">ANAMNESTICKÃ DOTAZNÃK</h1>
    <h2 class="subtitle-wide">PRO DIAGNOSTIKU DÃTÄšTE</h2>

    <div class="accent-row">
        <div class="accent-line"></div>
        <div class="dots-set">
            <div class="dot dot-full"></div>
            <div class="dot dot-full"></div>
            <div class="dot dot-outline"></div>
        </div>
    </div>
</header>

  <h1 class="print-only-header">AnamnestickÃ½ dotaznÃ­k</h1>

  <div class="instruction-block">
    <p>Je moÅ¾nÃ©, Å¾e vÃ¡s nÄ›kterÃ½ ze specialistÅ¯ peÄujÃ­cÃ­ch o vaÅ¡e dÃ­tÄ› poÅ¾Ã¡dal o poskytnutÃ­ anamnestickÃ½ch informacÃ­. Tento dotaznÃ­k vÃ¡s provede otÃ¡zkami zamÄ›Å™enÃ½mi na rÅ¯znÃ© oblasti Å¾ivota vaÅ¡eho dÃ­tÄ›te. AnamnÃ©za by mÄ›la bÃ½t dÅ¯kladnÃ¡, aby specialistÅ¯m umoÅ¾nila vytvoÅ™it ucelenÃ½ obraz o vaÅ¡em dÃ­tÄ›ti a pÅ™esnÄ› zacÃ­lit nÃ¡slednou pomoc a doporuÄenÃ­. SnaÅ¾te se proto odpovÃ­dat upÅ™Ã­mnÄ› a u otevÅ™enÃ½ch odpovÄ›dÃ­ poskytovat dostateÄnÃ© detaily. U nÄ›kterÃ½ch otÃ¡zek vÅ¡ak staÄÃ­ i nÄ›kolik slov nebo jedna vÄ›ta â€“ je to na vaÅ¡em uvÃ¡Å¾enÃ­.</p>
    <ul>
      <li>DotaznÃ­k nenÃ­ krÃ¡tkÃ½ a k pohodlnÄ›jÅ¡Ã­mu vyplÅˆovÃ¡nÃ­ tedy doporuÄujeme pouÅ¾Ã­t stolnÃ­ poÄÃ­taÄ.</li>
      <li>BÄ›hem vyplÅˆovÃ¡nÃ­ se budou na zÃ¡kladÄ› vaÅ¡ich odpovÄ›dÃ­ rozbalovat doplÅˆujÃ­cÃ­ otÃ¡zky.</li>
      <li>Pro snadnÄ›jÅ¡Ã­ navigaci jsou nezodpovÄ›zenÃ© otÃ¡zky uvozeny modrou teÄkou.</li>
      <li>Pokud si pÅ™ejete poloÅ¾ku nezodpovÃ­dat, vyberte moÅ¾nost <em>â€œBez odpovÄ›diâ€</em> nebo nechte pole prÃ¡zdnÃ©.</li>
    </ul>

    <p>Data, kterÃ¡ budete zadÃ¡vat, mohou bÃ½t citlivÃ© povahy. Tento dotaznÃ­k nikdy neodesÃ­lÃ¡ data mimo vaÅ¡e zaÅ™Ã­zenÃ­. Pro jistotu jsou vaÅ¡e odpovÄ›di automaticky uklÃ¡dÃ¡ny lokÃ¡lnÄ› ve vaÅ¡em prohlÃ­Å¾eÄi (umoÅ¾Åˆuje obnovu v pÅ™Ã­padÄ› zavÅ™enÃ­ dotaznÃ­ku apod.). DosavadnÃ­ prÅ¯chod takÃ© mÅ¯Å¾ete uloÅ¾it tlaÄÃ­tkem <strong>PrÅ¯bÄ›Å¾nÄ› uloÅ¾it</strong> nebo si stÃ¡hnÄ›te soubor se svÃ½mi odpovÄ›Ämi (tlaÄÃ­tko <strong>UloÅ¾it do souboru</strong>). ObÄ› moÅ¾nosti naleznete na konci dotaznÃ­ku.</p>

    <p>VÃ¡mi uloÅ¾enÃ½ soubor s odpovÄ›Ämi naÄtete tlaÄÃ­tkem <strong>NaÄÃ­st ze souboru (.json)</strong>. Pokud existuje prÅ¯bÄ›Å¾nÄ› uloÅ¾enÃ½ prÅ¯chod, obnovÃ­te jej kliknutÃ­m na tlaÄÃ­tko <strong>NaÄÃ­st poslednÃ­ prÅ¯chod</strong>.</p>


    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; margin-top: 10px;">
      <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <button type="button" class="btn btn-secondary" onclick="document.getElementById('json-file-input').click()">NaÄÃ­st ze souboru (.json)</button>
        <button type="button" class="btn btn-secondary" id="load-from-storage-btn" onclick="loadForm()">NaÄÃ­st poslednÃ­ prÅ¯chod</button>
      </div>
      <div style="text-align: right; margin-left: auto;">
        <button type="button" class="btn-delete-link" onclick="clearHistory()">Smazat aktuÃ¡lnÃ­ prÅ¯chod a historii</button>
      </div>
    </div>
  </div>


  <!-- ZÃ¡kladnÃ­ Ãºdaje -->
<fieldset>
  <legend>ZÃ¡kladnÃ­ Ãºdaje</legend>

  <div class="qa-block">
    <label><span>JmÃ©no dÃ­tÄ›te:</span></label>
    <input class="short-text" type="text" name="child_name">
  </div>

  <div class="qa-block">
    <label><span>Jak si dÃ­tÄ› pÅ™eje bÃ½t oslovovÃ¡no:</span></label>
    <input class="short-text" type="text" name="child_preferred_name">
  </div>
  <div class="qa-block">
    <label><span>Datum narozenÃ­ dÃ­tÄ›te:</span></label>
    <input type="date" name="child_birthdate" id="child_birthdate">
  </div>

  <div class="qa-block">
    <label><span>VÄ›k:</span></label>
    <input type="text" name="child_age" id="child_age" readonly style="cursor:default; pointer-events: none;" placeholder="DopoÄÃ­tÃ¡ se z data narozenÃ­">
  </div>
</fieldset>

<fieldset>
  <legend>ZdravotnÃ­ anamnÃ©za</legend>
  <div class="qa-block">
    <label><span>Bylo dÃ­tÄ› nÄ›kdy vyÅ¡etÅ™eno neurologem, psychiatrem nebo klinickÃ½m psychologem?</span></label>
    <div class="select-group">
      <label><input type="radio" name="neurolog_exam" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="neurolog_exam" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="neurolog_exam" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_neurolog_exam_detail">
    <label><span>JakÃ© diagnÃ³zy stanovil/i:</span></label>
    <textarea class="long-text" name="diagnoses"></textarea>
  </div>
  <div class="qa-block">
    <label><span>TrpÃ­ dÃ­tÄ› nÄ›kterÃ½mi chronickÃ½mi onemocnÄ›nÃ­mi?</span></label>
    <textarea class="long-text" name="chronic_illnesses"></textarea>
  </div>
  <div class="qa-block">
    <label><span>ProdÄ›lalo dÃ­tÄ› v minulosti nÄ›jakÃ© vÃ¡Å¾nÃ© zdravotnÃ­ komplikace?</span></label>
    <textarea class="long-text" name="past_health_issues"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Byl dÃ­tÄ›ti nÄ›kdy vyÅ¡etÅ™en zrak?</span></label>
    <div class="select-group">
      <label><input type="radio" name="vision_exam" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="vision_exam" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="vision_exam" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› se zrakem nÄ›jakÃ© obtÃ­Å¾e?</span></label>
    <div class="select-group">
      <label><input type="radio" name="vision_issues" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="vision_issues" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="vision_issues" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_vision_issues_detail">
    <label><span>DÃ­tÄ›:</span></label>
    <div class="select-group">
      <label><input type="checkbox" name="vision_devices_glasses"><span>NosÃ­ brÃ½le</span></label>
      <label><input type="checkbox" name="vision_devices_contacts"><span>NosÃ­ kontaktnÃ­ ÄoÄky</span></label>
      <label><input type="checkbox" name="vision_devices_occluder"><span>PouÅ¾Ã­vÃ¡ okluzory</span></label>
      <label><input type="checkbox" name="vision_devices_surgery"><span>Podstoupilo operaci oÄÃ­</span></label>
    </div>
  </div>

</fieldset>

<fieldset>
  <legend>RodinnÃ¡ anamnÃ©za</legend>

    <div class="tip-block tip-block-under">
    V rodinnÃ©m prostÅ™edÃ­ dÃ­tÄ› trÃ¡vÃ­ velkou ÄÃ¡st, Äasto i vÄ›tÅ¡inu svÃ©ho Äasu. Rodina tak do znaÄnÃ© mÃ­ry urÄuje, jak mÃ¡ nastavenÃ© dennÃ­ reÅ¾imy, pravidla, i jakÃ© mÃ­Å™e zÃ¡tÄ›Å¾e je dlouhodobÄ› vystaveno.
    </div>

  <div class="qa-block">
    <label><span>JmÃ©no matky:</span></label>
    <input class="short-text" type="text" name="mother_name">
  </div>
  <div class="qa-block">
    <label><span>VÄ›k matky:</span></label>
    <input type="number" name="mother_age">
  </div>
  <div class="qa-block">
    <label><span>JmÃ©no otce:</span></label>
    <input class="short-text" type="text" name="father_name">
  </div>
  <div class="qa-block">
    <label><span>VÄ›k otce:</span></label>
    <input type="number" name="father_age">
  </div>
  <div class="qa-block">
    <label><span>RodiÄe jsou:</span></label>
    <div class="select-group">
      <label><input type="radio" name="parents_status" value="BiologiÄtÃ­"><span>BiologiÄtÃ­</span></label>
      <label><input type="radio" name="parents_status" value="VychovÃ¡vajÃ­cÃ­"><span>VychovÃ¡vajÃ­cÃ­</span></label>
      <label><input type="radio" name="parents_status" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>BiologickÃ¡ matka je vychovÃ¡vajÃ­cÃ­ matka?</span></label>
    <div class="select-group">
      <label><input type="radio" name="bio_mother_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="bio_mother_status" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="bio_mother_status" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>BiologickÃ½ otec je vychovÃ¡vajÃ­cÃ­ otec?</span></label>
    <div class="select-group">
      <label><input type="radio" name="bio_father_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="bio_father_status" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="bio_father_status" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>Existuje dalÅ¡Ã­ vychovÃ¡vajÃ­cÃ­ rodiÄ/peÄovatel?</span></label>
    <div class="select-group">
      <label><input type="radio" name="additional_carer_status" value="Ano - plnÃ¡ pÃ©Äe"><span>Ano - plnÃ¡ pÃ©Äe</span></label>
      <label><input type="radio" name="additional_carer_status" value="Ano - stÅ™Ã­davÃ¡ pÃ©Äe"><span>Ano - stÅ™Ã­davÃ¡ pÃ©Äe</span></label>
      <label><input type="radio" name="additional_carer_status" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="additional_carer_status" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ matka nÄ›jakÃ¡ zdravotnÃ­ omezenÃ­?</span></label>
    <div class="select-group">
      <label><input type="radio" name="mother_health" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="mother_health" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="mother_health" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_mother_health_detail">
    <label><span>Pokud ano, uveÄte prosÃ­m jakÃ¡ omezenÃ­:</span></label>
    <textarea class="long-text" name="mother_health_detail"></textarea>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ otec nÄ›jakÃ¡ zdravotnÃ­ omezenÃ­?</span></label>
    <div class="select-group">
      <label><input type="radio" name="father_health" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="father_health" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="father_health" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_father_health_detail">
    <label><span>Pokud ano, uveÄte prosÃ­m jakÃ¡ omezenÃ­:</span></label>
    <textarea class="long-text" name="father_health_detail"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Je matka dÃ­tÄ›te momentÃ¡lnÄ› zamÄ›stnanÃ¡?</span></label>
    <div class="select-group">
      <label><input type="radio" name="mother_employed" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="mother_employed" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="mother_employed" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_mother_jobs_detail">
    <label><span>JakÃ¡ zamÄ›stnÃ¡nÃ­ vykonÃ¡vÃ¡ matka:</span></label>
    <textarea class="long-text" name="mother_jobs"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Je otec dÃ­tÄ›te momentÃ¡lnÄ› zamÄ›stnanÃ½?</span></label>
    <div class="select-group">
      <label><input type="radio" name="father_employed" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="father_employed" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="father_employed" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_father_jobs_detail">
    <label><span>JakÃ¡ zamÄ›stnÃ¡nÃ­ vykonÃ¡vÃ¡ otec:</span></label>
    <textarea class="long-text" name="father_jobs"></textarea>
  </div>
   <div class="qa-block">
    <label><span>VychovÃ¡vÃ¡ dÃ­tÄ› i nÄ›kdo jinÃ½ (podstatnÃ½m zpÅ¯sobem zasahuje do Å¾ivota dÃ­tÄ›te)?</span></label>
    <div class="select-group">
      <label><input type="radio" name="other_carer_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="other_carer_status" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="other_carer_status" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_other_carer_detail">
    <label><span>Kolik dalÅ¡Ã­ch osob dÃ­tÄ› vychovÃ¡vÃ¡?</span></label>
    <input type="number" name="additional_carers_count" id="additional_carers_count" min="0">
  <div id="additional_carers_container"></div>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› sourozence?</span></label>
    <div class="select-group">
      <label><input type="radio" name="has_siblings" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="has_siblings" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="has_siblings" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_siblings_detail">
    <label><span>Kolik mÃ¡ sourozencÅ¯?</span></label>
    <input type="number" name="siblings_count" id="siblings_count" min="0">
    <div id="siblings_container"></div>
  </div>
</fieldset>


<fieldset>
  <legend>SociÃ¡lnÃ­ anamnÃ©za</legend>

<div class="tip-block tip-block-under">
 Tato sekce mapuje sociÃ¡lnÃ­ prostÅ™edÃ­, ve kterÃ©m dÃ­tÄ› Å¾ije (zda mÃ¡ stabilnÃ­ bydlenÃ­, vlastnÃ­ prostor pro plnÄ›nÃ­ povinnostÃ­ i volnÃ½ Äas), moÅ¾nosti peÄujÃ­cÃ­ch osob s dÃ­tÄ›tem trÃ¡vit Äas a jejich spoleÄnÃ© zÃ¡liby.
    </div>

  <div class="qa-block">
    <label><span>V jakÃ©m typu bydlenÃ­ Å¾ijete?</span></label>
    <div class="select-group">
      <label><input type="radio" name="housing_type" value="DÅ¯m"><span>DÅ¯m</span></label>
      <label><input type="radio" name="housing_type" value="Byt"><span>Byt</span></label>
      <label><input type="radio" name="housing_type" value="JinÃ©"><span>JinÃ©</span></label>
      <label><input type="radio" name="housing_type" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
    <div class="qa-block hidden" id="q_housing_specification_detail">
    <label><span>MÅ¯Å¾ete typ bydlenÃ­ specifikovat?</span></label>
    <textarea class="long-text" name="housing_specification"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Jak jste s bydlenÃ­m spokojenÃ­?</span></label>
    <textarea class="long-text" name="housing_satisfaction"></textarea>
  </div>
  <div class="qa-block">
    <label><span>Kolik lidÃ­ Å¾ije ve vaÅ¡Ã­ domÃ¡cnosti?</span></label>
    <input type="number" name="household_count">
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› vlastnÃ­ pokoj?</span></label>
    <div class="select-group">
      <label><input type="radio" name="child_own_room" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="child_own_room" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="child_own_room" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› vlastnÃ­ pracovnÃ­ stÅ¯l?</span></label>
    <div class="select-group">
      <label><input type="radio" name="child_own_desk" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="child_own_desk" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="child_own_desk" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>
  
  <div class="qa-block">
    <label><span>Kolik hodin dennÄ› trÃ¡vÃ­te (vy nebo dalÅ¡Ã­ rodiÄe / peÄovatelÃ©) doma s dÄ›tmi?</span></label>
    <input type="number" name="time_with_children">
  </div>

  <div class="qa-block">
    <label><span>MÃ¡te prostor s dÃ­tÄ›tem nÄ›co procviÄovat?</span></label>
    <div class="select-group">
      <label><input type="radio" name="practice_with_child" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="practice_with_child" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="practice_with_child" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>

  <div class="qa-block">
    <label><span>JakÃ¡ je vaÅ¡e oblÃ­benÃ¡ Äinnost s dÃ­tÄ›tem? (mÅ¯Å¾e jich bÃ½t i vÃ­ce)</span></label>
    <textarea class="long-text" name="fav_activity_with_child"></textarea>
  </div>

  <div class="qa-block">
    <label><span>JakÃ¡ je oblÃ­benÃ¡ Äinnost dÃ­tÄ›te obecnÄ›?</span></label>
    <textarea class="long-text" name="child_fav_activity"></textarea>
  </div>

  <div class="qa-block">
    <label><span>Jestli mÃ¡ dÃ­tÄ› oblÃ­benÃ½ film, jakÃ½ to je?</span></label>
    <input type="text" name="child_fav_movie">
  </div>

  <div class="qa-block">
    <label><span>Jestli mÃ¡ dÃ­tÄ› oblÃ­benou knihu, jakÃ¡ to je?</span></label>
    <input type="text" name="child_fav_book">
  </div>

  <div class="qa-block">
      <label><span>MÃ¡ dÃ­tÄ› pÅ™Ã­stup k telefonu nebo tabletu?</span></label>
      <div class="select-group">
        <label><input type="radio" name="child_has_device" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="child_has_device" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="child_has_device" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

  <div class="qa-block hidden" id="q_child_device_detail1">
    <label><span>Jak moc dÃ­tÄ› podle vÃ¡s pouÅ¾Ã­vÃ¡ mobil nebo tablet ve srovnÃ¡nÃ­ s vrstevnÃ­ky?</span></label>
    <textarea class="long-text" name="child_device_use_relative"></textarea>
  </div>

  <div class="qa-block hidden" id="q_child_device_detail2">
    <label><span>Co dÃ­tÄ› na telefonu nejÄastÄ›ji dÄ›lÃ¡? (seÅ™aÄte podle frekvence)</span></label>
    <textarea class="long-text" name="child_device_usage"></textarea>
  </div>

  <div class="qa-block hidden" id="q_child_device_detail3">
    <label><span>PokouÅ¡Ã­te se nÄ›jakÃ½m zpÅ¯sobem kontrolovat, co dÃ­tÄ› na telefonu dÄ›lÃ¡? (napÅ™. vÃ½chovnÄ› nebo omezenÃ­m pÅ™Ã­mo v telefonu)</span></label>
    <textarea class="long-text" name="child_device_control"></textarea>
  </div>

  <div class="qa-block">
    <label><span>Jak moc je pro vÃ¡s pouÅ¾Ã­vÃ¡nÃ­ mobilu Äi tabletu tÃ©matem ve vÃ½chovÄ›?</span></label>
    <textarea class="long-text" name="child_device_parenting_theme"></textarea>
  </div>
</fieldset>

<fieldset>
  <legend>Å kolka</legend>

  <div class="qa-block">
    <label><span>NavÅ¡tÄ›vuje vaÅ¡e dÃ­tÄ› Å¡kolku?</span></label>
    <div class="select-group">
      <label><input type="radio" name="attends_kindergarten" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="attends_kindergarten" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="attends_kindergarten" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>

  <div class="qa-block hidden" id="q_kindergarten_details">

    <div class="qa-block">
      <label><span>Do kolika Å¡kolek vaÅ¡e dÃ­tÄ› chodÃ­?</span></label>
      <input type="number" name="kg_how_many">
    </div>

    <div class="qa-block">
      <label><span>Kolik dnÃ­ v tÃ½dnu chodÃ­ vaÅ¡e dÃ­tÄ› do Å¡kolky?</span></label>
      <input type="number" name="kg_days_per_week">
    </div>

    <div class="qa-block">
      <label><span>Kolik z tÄ›chto dnÅ¯ trÃ¡vÃ­ ve Å¡kolce i odpoledne?</span></label>
      <input type="number" name="kg_afternoons">
    </div>

    <div class="qa-block">
      <label><span>Kdybyste mÄ›l/a zhodnotit, jak probÃ­hÃ¡ rannÃ­ vypravovÃ¡nÃ­ do Å¡kolky â€“ mÃ¡ s nÃ­m dÃ­tÄ› nÄ›jakÃ© obtÃ­Å¾e?</span></label>
      <div class="select-group">
        <label><input type="radio" name="kg_morning_issues" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_morning_issues" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_morning_issues" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_morning_issues_detail">
      <label><span>MÅ¯Å¾ete obtÃ­Å¾e specifikovat?</span></label>
      <textarea class="long-text" name="kg_morning_issues_detail"></textarea>
    </div>

    <div class="qa-block">
      <label><span>MÃ¡ dÃ­tÄ› problÃ©m se rozlouÄit pÅ™i odchodu do Å¡kolky?</span></label>
      <div class="select-group">
        <label><input type="radio" name="kg_separation_issues" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_separation_issues" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_separation_issues" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>Kdybyste mÄ›l/a zhodnotit, jak dÃ­tÄ› funguje (jak se chovÃ¡) po nÃ¡vratu ze Å¡kolky, co byste o nÄ›m Å™ekl/a?</span></label>
      <textarea class="long-text" name="kg_after_return_behavior"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Jak dÃ­tÄ› hodnotÃ­ Å¡kolku?</span></label>
      <textarea class="long-text" name="kg_child_rating"></textarea>
    </div>

    <div class="qa-block">
      <label><span>MluvÃ­ s vÃ¡mi dÃ­tÄ› o svÃ©m dni ve Å¡kolce?</span></label>
      <div class="select-group">
        <label><input type="radio" name="kg_talks_about_day" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_talks_about_day" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_talks_about_day" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>Jak je vaÅ¡e dÃ­tÄ› ve Å¡kolce posluÅ¡nÃ© podle uÄitelek?</span></label>
      <textarea class="long-text" name="kg_obedience"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Jak se vaÅ¡e dÃ­tÄ› podle uÄitelek zapojuje do dÄ›nÃ­ ve Å¡kolce?</span></label>
      <textarea class="long-text" name="kg_participation"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Jak uÄitelky ve Å¡kolce hodnotÃ­ chovÃ¡nÃ­ vaÅ¡eho dÃ­tÄ›te k jinÃ½m dÄ›tem? (hraje si s nimi / nezlobÃ­ je apod.)</span></label>
      <textarea class="long-text" name="kg_peer_behavior"></textarea>
    </div>

    <div class="qa-block">
      <label><span>StÄ›Å¾ujÃ­ si uÄitelky ve Å¡kolce na vaÅ¡e dÃ­tÄ›?</span></label>
      <div class="select-group">
        <label><input type="radio" name="kg_teachers_complain" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_teachers_complain" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_teachers_complain" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>VnÃ­majÃ­ uÄitelky problÃ©m, se kterÃ½m do poradny pÅ™ichÃ¡zÃ­te?</span></label>
      <div class="select-group">
        <label><input type="radio" name="kg_teachers_see_problem" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_teachers_see_problem" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_teachers_see_problem" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>ProbÃ­hÃ¡ ve Å¡kolce nÄ›jakÃ¡ forma pÅ™edÅ¡kolnÃ­ pÅ™Ã­pravy?</span></label>
      <div class="select-group">
        <label><input type="radio" name="kg_preschool_prep" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_preschool_prep" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_preschool_prep" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>Jak vaÅ¡emu dÃ­tÄ›ti jde Å¡kolnÃ­ pÅ™Ã­prava?</span></label>
      <textarea class="long-text" name="kg_prep_progress"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Jak vy osobnÄ› Å¡kolku hodnotÃ­te?</span></label>
      <textarea class="long-text" name="kg_parent_rating"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Nastupuje dÃ­tÄ› v nejbliÅ¾Å¡Ã­ dobÄ› do prvnÃ­ tÅ™Ã­dy?</span></label>
      <div class="select-group">
        <label><input type="radio" name="kg_starting_school" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_starting_school" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_starting_school" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

  </div> </fieldset>


 <fieldset>
  <legend>Å kola</legend>

  <div class="qa-block">
    <label><span>NavÅ¡tÄ›vuje dÃ­tÄ› Å¡kolu?</span></label>
    <div class="select-group">
      <label><input type="radio" name="attends_school" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="attends_school" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="attends_school" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>

  <div class="qa-block hidden" id="q_school_details">

    <div class="qa-block">
      <label><span>Je dÃ­tÄ› aktuÃ¡lnÄ› v prvnÃ­ tÅ™Ã­dÄ›?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_first_grade" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_first_grade" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_first_grade" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>MÃ¡ dÃ­tÄ› ve Å¡kole nÄ›jakÃ© oblÃ­benÃ© vyuÄovacÃ­ pÅ™edmÄ›ty?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_fav_subjects_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_fav_subjects_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_fav_subjects_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_fav_subjects_detail">
      <label><span>JakÃ© pÅ™edmÄ›ty to jsou?</span></label>
      <textarea class="long-text" name="school_fav_subjects_list"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Jsou nÄ›jakÃ© pÅ™edmÄ›ty, kterÃ© dÃ­tÄ› nemÃ¡ rÃ¡do?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_disliked_subjects_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_disliked_subjects_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_disliked_subjects_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_disliked_subjects_detail">
      <label><span>KterÃ© to jsou?</span></label>
      <textarea class="long-text" name="school_disliked_subjects_list"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Kolik vyuÄujÃ­cÃ­ch VaÅ¡e dÃ­tÄ› uÄÃ­?</span></label>
      <input type="number" name="school_teacher_count">
    </div>

    <div class="qa-block">
      <label><span>JakÃ½ typ hodnocenÃ­ se ve Å¡kole, kterou dÃ­tÄ› navÅ¡tÄ›vuje, pouÅ¾Ã­vÃ¡?</span></label>
      <div class="select-group">
        <label><input type="checkbox" name="school_grading_type_grades"><span>ZnÃ¡mkovÃ¡nÃ­</span></label>
        <label><input type="checkbox" name="school_grading_type_verbal"><span>SlovnÃ­ hodnocenÃ­</span></label>
        <label><input type="checkbox" name="school_grading_type_self"><span>SebehodnocenÃ­ dÃ­tÄ›te</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>DÃ­tÄ›ti se z hlediska hodnocenÃ­ Å¡kolnÃ­ho prospÄ›chu ve Å¡kole daÅ™Ã­ spÃ­Å¡e:</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_performance" value="DobÅ™e"><span>DobÅ™e</span></label>
        <label><input type="radio" name="school_performance" value="Å patnÄ›"><span>Å patnÄ›</span></label>
        <label><input type="radio" name="school_performance" value="NÄ›co mezi"><span>NÄ›co mezi</span></label>
        <label><input type="radio" name="school_performance" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>Å kola pro komunikaci s rodiÄi ohlednÄ› znÃ¡mek, domÃ¡cÃ­ch ÃºkolÅ¯ nebo absence vyuÅ¾Ã­vÃ¡:</span></label>
      <div class="select-group">
        <label><input type="checkbox" name="school_comm_app"><span>Elektronickou komunikaci, napÅ™. systÃ©m BakalÃ¡Å™i</span></label>
        <label><input type="checkbox" name="school_comm_notebook"><span>Å½Ã¡kovskou knÃ­Å¾ku ve fyzickÃ© podobÄ›</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>DostÃ¡vÃ¡ dÃ­tÄ› ve Å¡kole domÃ¡cÃ­ Ãºkoly?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_homework_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_homework_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_homework_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>StÄ›Å¾ujÃ­ si vyuÄujÃ­cÃ­, Å¾e dÃ­tÄ› neplnÃ­ domÃ¡cÃ­ Ãºkoly?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_homework_complaints" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_homework_complaints" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_homework_complaints" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>Je tÅ™eba, aby si dÃ­tÄ› ve Å¡kole samo zaznamenÃ¡valo Ãºkoly, kterÃ© mÃ¡ vypracovat doma?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_homework_tracking" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_homework_tracking" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_homework_tracking" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_homework_tracking_detail">
      <div class="qa-block">
        <label><span>MÃ¡ dÃ­tÄ› ÃºkolnÃ­Äek nebo jinou pomÅ¯cku, do kterÃ© si Ãºkoly zaznamenÃ¡vÃ¡?</span></label>
        <div class="select-group">
          <label><input type="radio" name="school_homework_notebook_exists" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_homework_notebook_exists" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_homework_notebook_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label><span>MyslÃ­te si, Å¾e se dÃ­tÄ›ti daÅ™Ã­ poznamenat si ve Å¡kole vÅ¡echny domÃ¡cÃ­ Ãºkoly?</span></label>
        <div class="select-group">
          <label><input type="radio" name="school_homework_tracking_success" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_homework_tracking_success" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_homework_tracking_success" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label><span>DÃ­tÄ› doma kontroluje ÃºkolnÃ­Äek nebo jinou pomÅ¯cku pro zaznamenÃ¡vÃ¡nÃ­ ÃºkolÅ¯:</span></label>
        <div class="select-group">
          <label><input type="checkbox" name="school_homework_check_self"><span>Samo</span></label>
          <label><input type="checkbox" name="school_homework_check_parent"><span>Se mnou</span></label>
          <label><input type="checkbox" name="school_homework_check_other"><span>S jinou vychovÃ¡vajÃ­cÃ­ osobou</span></label>
        </div>
      </div>
    </div>
    <div class="qa-block">
      <label><span>OÄekÃ¡vÃ¡te od dÃ­tÄ›te, Å¾e bude domÃ¡cÃ­ Ãºkoly vypracovÃ¡vat samo?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_homework_expectation_self" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_homework_expectation_self" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_homework_expectation_self" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>DÃ­tÄ› vypracovÃ¡vÃ¡ domÃ¡cÃ­ Ãºkoly:</span></label>
      <div class="select-group">
        <label><input type="checkbox" name="school_homework_do_self"><span>Samo</span></label>
        <label><input type="checkbox" name="school_homework_do_parent"><span>Se mnou</span></label>
        <label><input type="checkbox" name="school_homework_do_other"><span>S jinou vychovÃ¡vajÃ­cÃ­ osobou</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>Jak dÃ­tÄ› hodnotÃ­ jeho vyuÄujÃ­cÃ­ v rÃ¡mci tÅ™Ã­dnÃ­ch schÅ¯zek nebo jinÃ© komunikace s VÃ¡mi?</span></label>
      <textarea class="long-text" name="school_teacher_rating_by_child"></textarea>
    </div>

    <div class="qa-block">
      <label><span>StÄ›Å¾ujÃ­ si vyuÄujÃ­cÃ­ opakovanÄ› na nÄ›co, co se tÃ½kÃ¡ VaÅ¡eho dÃ­tÄ›te?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_teacher_complaints_general" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_teacher_complaints_general" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_teacher_complaints_general" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_teacher_complaints_detail">
      <label><span>Na co si vyuÄujÃ­cÃ­ stÄ›Å¾ujÃ­?</span></label>
      <textarea class="long-text" name="school_teacher_complaints_list"></textarea>
    </div>

    <div class="qa-block">
      <label><span>ChvÃ¡lÃ­ vyuÄujÃ­cÃ­ dÃ­tÄ› za nÄ›co?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_teacher_praise_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_teacher_praise_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_teacher_praise_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_teacher_praise_detail">
      <label><span>Za co vyuÄujÃ­cÃ­ VaÅ¡e dÃ­tÄ› chvÃ¡lÃ­?</span></label>
      <textarea class="long-text" name="school_teacher_praise_list"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Å kolnÃ­ tÅ™Ã­da je uspoÅ™Ã¡dÃ¡na:</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_seating_type" value="Po dvou"><span>V lavicÃ­ch po dvou</span></label>
        <label><input type="radio" name="school_seating_type" value="JinÃ©"><span>JinÃ© uspoÅ™Ã¡dÃ¡nÃ­</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_seating_pair_details">
      <div class="qa-block">
        <label><span>DÃ­tÄ› sedÃ­:</span></label>
        <div class="select-group">
          <label><input type="radio" name="school_seating_partner" value="Samo"><span>Samo</span></label>
          <label><input type="radio" name="school_seating_partner" value="S jinÃ½m dÃ­tÄ›tem"><span>S jinÃ½m dÃ­tÄ›tem</span></label>
          <label><input type="radio" name="school_seating_partner" value="S asistentem"><span>S asistentem/kou</span></label>
          <label><input type="radio" name="school_seating_partner" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label><span>Ve kterÃ© lavici dÃ­tÄ› sedÃ­?</span></label>
        <textarea class="long-text" name="school_seating_desk_row"></textarea>
      </div>
      <div class="qa-block">
        <label><span>Ve kterÃ© ÄÃ¡sti tÅ™Ã­dy dÃ­tÄ› sedÃ­?</span></label>
        <div class="select-group">
          <label><input type="radio" name="school_seating_location" value="U dveÅ™Ã­"><span>U dveÅ™Ã­</span></label>
          <label><input type="radio" name="school_seating_location" value="UprostÅ™ed"><span>UprostÅ™ed</span></label>
          <label><input type="radio" name="school_seating_location" value="U okna"><span>U okna</span></label>
          <label><input type="radio" name="school_seating_location" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
    </div>
    
    <div class="qa-block hidden" id="q_school_seating_other_detail">
      <label><span>MÅ¯Å¾ete uspoÅ™Ã¡dÃ¡nÃ­ tÅ™Ã­dy a mÃ­sto dÃ­tÄ›te popsat?</span></label>
      <textarea class="long-text" name="school_seating_other_description"></textarea>
    </div>

    <div class="qa-block">
      <label><span>MÃ¡ Å¡kolnÃ­ tÅ™Ã­da relaxaÄnÃ­ ÄÃ¡st?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_relax_zone_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_relax_zone_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_relax_zone_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_relax_zone_detail">
      <label><span>MÅ¯Å¾e dÃ­tÄ› relaxaÄnÃ­ ÄÃ¡st vyuÅ¾Ã­vat?</span></label>
      <textarea class="long-text" name="school_relax_zone_rules"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Kolik dÄ›tÃ­ je ve Å¡kolnÃ­ tÅ™Ã­dÄ›?</span></label>
      <input type="number" name="school_class_size">
    </div>

    <div class="qa-block">
      <label><span>MluvÃ­ dÃ­tÄ› doma o kamarÃ¡dech?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_talks_about_friends" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_talks_about_friends" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_talks_about_friends" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_friends_detail">
      <div class="qa-block">
        <label><span>MÃ¡ nÄ›koho, koho povaÅ¾uje za kamarÃ¡da/kamarÃ¡dku?</span></label>
        <div class="select-group">
          <label><input type="radio" name="school_has_friends" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_has_friends" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_has_friends" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label><span>MÃ¡ nÄ›jakÃ© kamarÃ¡dy/ky, o kterÃ½ch mluvÃ­ dlouhodobÄ›?</span></label>
        <div class="select-group">
          <label><input type="radio" name="school_has_longterm_friends" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_has_longterm_friends" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_has_longterm_friends" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
    </div>
    <div class="qa-block">
      <label><span>StÄ›Å¾uje si na nÄ›kterÃ© spoluÅ¾Ã¡ky nebo spoluÅ¾aÄky?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_complains_about_peers" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_complains_about_peers" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_complains_about_peers" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_complains_peers_detail">
      <div class="qa-block">
        <label><span>StÄ›Å¾uje si na nÄ›koho dlouhodobÄ›?</span></label>
        <div class="select-group">
          <label><input type="radio" name="school_complains_peers_longterm" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_complains_peers_longterm" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_complains_peers_longterm" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
    </div>
    <div class="qa-block">
      <label><span>StÄ›Å¾uje si dÃ­tÄ› na nÄ›co jinÃ©ho ohlednÄ› Å¡koly?</span></label>
      <div class="select-group">
        <label><input type="radio" name="school_complains_other" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_complains_other" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_complains_other" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_complains_other_detail">
      <label><span>Na co si dÃ­tÄ› stÄ›Å¾uje?</span></label>
      <textarea class="long-text" name="school_complaints_other_text"></textarea>
    </div>

    <div class="qa-block">
      <label><span>Kolik hodin tÃ½dnÄ› dÃ­tÄ› trÃ¡vÃ­ ve Å¡kole? (zapoÄÃ­tejte, prosÃ­m, pÅ™Ã­padnÃ© douÄovÃ¡nÃ­ a podobnÃ© aktivity)</span></label>
      <input type="number" name="school_hours_per_week">
    </div>

  </div> </fieldset>

<fieldset>
  <legend>KrouÅ¾ky a zÃ¡jmy</legend>

  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› nÄ›jakou volnoÄasovou aktivitu, kterÃ¡ jej hodnÄ› bavÃ­ nebo jÃ­ dokÃ¡Å¾e trÃ¡vit hodnÄ› Äasu?</span></label>
    <div class="select-group">
      <label><input type="radio" name="hobbies_fav_exists" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="hobbies_fav_exists" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="hobbies_fav_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>

  <div class="qa-block hidden" id="q_hobbies_fav_detail">
    <label><span>JakÃ¡ aktivita to je?</span></label>
    <input class="short-text" type="text" name="hobbies_fav_activity">
  </div>

  <div class="qa-block">
    <label><span>NavÅ¡tÄ›vuje dÃ­tÄ› nÄ›jakÃ© zÃ¡jmovÃ© krouÅ¾ky?</span></label>
    <div class="select-group">
      <label><input type="radio" name="hobbies_clubs_exists" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="hobbies_clubs_exists" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="hobbies_clubs_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>

  <div class="qa-block hidden" id="q_hobbies_clubs_detail">
    <div class="qa-block">
      <label><span>Kolik krouÅ¾kÅ¯ navÅ¡tÄ›vuje?</span></label>
      <input type="number" name="hobbies_clubs_count" min="0">
    </div>
    <div class="qa-block">
      <label><span>JakÃ© krouÅ¾ky dÃ­tÄ› navÅ¡tÄ›vuje? (vypiÅ¡te)</span></label>
      <textarea class="long-text" name="hobbies_clubs_list"></textarea>
    </div>
    <div class="qa-block">
      <label><span>Kolik hodin tÃ½dnÄ› trÃ¡vÃ­ dÃ­tÄ› v krouÅ¾cÃ­ch?</span></label>
      <input type="number" name="hobbies_clubs_hours" min="0">
    </div>
  </div>
</fieldset>

<fieldset>
  <legend>Doma</legend>

  <div class="qa-block">
    <label><span>MÃ¡ dÃ­tÄ› nÄ›jakÃ© domÃ¡cÃ­ povinnosti (napÅ™. Ãºklid pokoje)?</span></label>
    <div class="select-group">
      <label><input type="radio" name="home_chores_exists" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="home_chores_exists" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="home_chores_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>

  <div class="qa-block hidden" id="q_home_chores_detail">
    <div class="qa-block">
      <label><span>JakÃ© domÃ¡cÃ­ povinnosti by dÃ­tÄ› podle VÃ¡s mÄ›lo bÃ½t schopno splnit?</span></label>
      <input class="short-text" type="text" name="home_chores_expectation">
    </div>

    <div class="qa-block">
      <label><span>DaÅ™Ã­ se mu domÃ¡cÃ­ povinnosti plnit?</span></label>
      <div class="select-group">
        <label><input type="radio" name="home_chores_success" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="home_chores_success" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="home_chores_success" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>DokÃ¡Å¾e si dÃ­tÄ› samo kontrolovat plnÄ›nÃ­ domÃ¡cÃ­ch povinnostÃ­?</span></label>
      <div class="select-group">
        <label><input type="radio" name="home_chores_self_check" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="home_chores_self_check" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="home_chores_self_check" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>
  </div>

  <div class="qa-block">
    <label><span>ZvlÃ¡dne dÃ­tÄ› doma udÄ›lat nÄ›co, o co jej poÅ¾Ã¡dÃ¡te (napÅ™. nÄ›co donÃ©st, s nÄ›ÄÃ­m pomoci)?</span></label>
    <div class="select-group">
      <label><input type="radio" name="home_request_compliance" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="home_request_compliance" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="home_request_compliance" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>

  <div class="qa-block">
    <label><span>MÃ¡te doma s dÃ­tÄ›tem Äasto konflikty?</span></label>
    <div class="select-group">
      <label><input type="radio" name="home_conflicts_exists" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="home_conflicts_exists" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="home_conflicts_exists" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
    </div>
  </div>

  <div class="qa-block hidden" id="q_home_conflicts_detail">
    <div class="qa-block">
      <label><span>MÃ¡te pocit, Å¾e konflikty zvlÃ¡dÃ¡te Å™eÅ¡it tak, jak byste chtÄ›l*a?</span></label>
      <div class="select-group">
        <label><input type="radio" name="home_conflicts_resolution" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="home_conflicts_resolution" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="home_conflicts_resolution" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label><span>Ocenil*a byste radu nebo pomoc ohlednÄ› toho, jak konflikty Å™eÅ¡it?</span></label>
      <div class="select-group">
        <label><input type="radio" name="home_conflicts_help" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="home_conflicts_help" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="home_conflicts_help" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
      </div>
    </div>
  </div>

  <div class="qa-block">
    <label><span>Co VÃ¡s obecnÄ› ohlednÄ› dÃ­tÄ›te nejvÃ­ce trÃ¡pÃ­?</span></label>
    <input class="short-text" type="text" name="general_main_concern">
  </div>
</fieldset>


<!-- Save and Share Options -->
<div class="instruction-block sharing-options">
  <p>Dorazili jste na konec dotaznÃ­ku. NynÃ­ mÃ¡te dvÄ› moÅ¾nosti, jak svÃ© odpovÄ›di sdÃ­let se specialistou.</p>
  <ul>
    <li><strong>NÃ¡hled tisku/PDF:</strong> ZobrazÃ­ vaÅ¡e odpovÄ›di ve formÃ¡tu diagnostickÃ© zprÃ¡vy pro tisk nebo uloÅ¾enÃ­ do PDF.</li>
    <li><strong>UloÅ¾it do souboru:</strong> StÃ¡hne vaÅ¡e odpovÄ›di jako soubor (.json), kterÃ½ mÅ¯Å¾ete pÅ™edat specialistovi nebo si jej uloÅ¾it pro pÅ™Ã­Å¡tÄ›.</li>
  </ul>

    <p>V zÃ¡vislosti na dohodÄ› se specialistou vyberte preferovnou variantu. Pokud si nejste jisti, je lepÅ¡Ã­ zvolit <strong>UloÅ¾it do souboru</strong> a soubor pÅ™inÃ©st specialistovi (napÅ™Ã­klad na USB). Specialista mÅ¯Å¾e kdykoli vaÅ¡e odpovÄ›di pÅ™evÃ©st do PDF nebo vytisknout sÃ¡m.</p>
    


  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; margin-top: 20px;">
    <div class="save-buttons">
      <button type="button" class="btn primary" id="preview-button" onclick="togglePrintPreview()">NÃ¡hled tisku / PDF</button>
      <button type="button" class="btn primary" onclick="saveAsJsonFile()">UloÅ¾it do souboru</button>
    </div>
      <button type="button" class="btn btn-secondary" onclick="saveForm(true)" style="margin-left: auto;">PrÅ¯bÄ›Å¾nÄ› uloÅ¾it</button>
  </div>

  <div class="manual-alert">
    <strong>âš ï¸ UpozornÄ›nÃ­:</strong>
    <span>Data v uloÅ¾enÃ©m souboru nejsou Å¡ifrovÃ¡na a mohou bÃ½t ÄitelnÃ¡ tÅ™etÃ­mi stranami. 
    NÄ›kterÃ© formy sdÃ­lenÃ­, napÅ™Ã­klad skrze e-mail, mohou nÃ©st rizika.</span><br><br>
    <span>Pokud jste vyplnili dotaznÃ­k na veÅ™ejnÃ©m zaÅ™Ã­zenÃ­, nezapomeÅˆte po uloÅ¾enÃ­/exportu
      <span class="alert-action-link" onclick="clearHistory()">vymazat dotaznÃ­k a prÅ¯bÄ›Å¾nÄ› uloÅ¾enÃ¡ data</span>.
    </span>
  </div>

</div>

<footer class="page-footer">
  <p>Â© 2025 MUNI FSS - Diagnostika dÃ­tÄ›te</p>
  <p>Garant: Mgr. Zuzana MasopustovÃ¡, PhD.</p>
  <p>VolnÄ› dostupnÃ© na webu: <a href="https://diagnostikaditete.cz" target="_blank">diagnostikaditete.cz</a></p>
  <p>Verze 2.1-alpha (<a href="https://github.com/strojiladam/anamdotaznik.github.io" target="_blank">o aplikaci</a>)</p>
</footer>

</form>

<input type="file" id="json-file-input" accept=".json" style="display: none;">

<!-- Floating controls for Print Preview -->
<div class="preview-controls">
  <button type="button" class="btn btn-secondary" onclick="togglePrintPreview()">ZpÄ›t</button>
  <button type="button" class="btn primary" onclick="printWithUnansweredMarks()">Tisk PDF</button>
</div>

<script>


// Age calculation
const birthInput = document.getElementById('child_birthdate');
const ageInput = document.getElementById('child_age');

function formatYearsCzech(years) {
  if (years === 1) return '1 rok';
  if (years >= 2 && years <= 4) return `${years} roky`;
  return `${years} let`;
}

function formatMonthsCzech(months) {
  if (months === 1) return '1 mÄ›sÃ­c';
  if (months >= 2 && months <= 4) return `${months} mÄ›sÃ­ce`;
  return `${months} mÄ›sÃ­cÅ¯`;
}

birthInput.addEventListener('change', () => {
  const birthDate = new Date(birthInput.value);
  const today = new Date();

  if (isNaN(birthDate) || birthDate > today) {
    ageInput.value = 'Datum narozenÃ­ je zadÃ¡no chybnÄ›.';
    return;
  }

  let years = today.getFullYear() - birthDate.getFullYear();
  let months = today.getMonth() - birthDate.getMonth();
  if (months < 0) { 
    years--; 
    months += 12; 
  }

  const yearText = formatYearsCzech(years);
  const monthText = formatMonthsCzech(months);
  ageInput.value = `${yearText}, ${monthText}`;
});



// setupConditional that supports radio groups and <select>
function setupConditional(selectName, detailId, triggerValue = 'Ano') {
  const detailDiv = document.getElementById(detailId);
  if (!detailDiv) return; // Exit if the detail element doesn't exist

  const radios = Array.from(document.querySelectorAll(`[name="${selectName}"]`));
  const isRadioGroup = radios.length > 1 || (radios.length === 1 && radios[0].type === 'radio');

  if (isRadioGroup) {
    const update = () => {
      const checked = document.querySelector(`[name="${selectName}"]:checked`);
      const shouldShow = checked && checked.value === triggerValue;
      detailDiv.classList.toggle('is-visible', shouldShow);
    };

    radios.forEach(r => r.addEventListener('change', update));
    update(); // Initial check
  } else {
    // Single select or input
    const elem = document.querySelector(`[name="${selectName}"]`);
    if (!elem) return;

    const update = () => {
      const shouldShow = elem.value === triggerValue;
      detailDiv.classList.toggle('is-visible', shouldShow);
    };

    elem.addEventListener('change', update);
    update();
  }
}

function updateAllConditionals() {
  // Re-run all conditional checks to show/hide fields based on loaded data.
  setupConditional('mother_health', 'q_mother_health_detail', 'Ano');
  setupConditional('father_health', 'q_father_health_detail', 'Ano');
  setupConditional('other_carer_status', 'q_other_carer_detail', 'Ano');
  setupConditional('mother_employed', 'q_mother_jobs_detail', 'Ano');
  setupConditional('father_employed', 'q_father_jobs_detail', 'Ano');
  setupConditional('has_siblings', 'q_siblings_detail', 'Ano');
  setupConditional('child_has_device', 'q_child_device_detail1', 'Ano');
  setupConditional('child_has_device', 'q_child_device_detail2', 'Ano');
  setupConditional('child_has_device', 'q_child_device_detail3', 'Ano');
  setupConditional('neurolog_exam', 'q_neurolog_exam_detail', 'Ano');
  setupConditional('vision_issues', 'q_vision_issues_detail', 'Ano');
  setupConditional('housing_type', 'q_housing_specification_detail', 'JinÃ©');
  setupConditional('attends_kindergarten', 'q_kindergarten_details', 'Ano');
  setupConditional('kg_morning_issues', 'q_morning_issues_detail', 'Ano');
  setupConditional('attends_school', 'q_school_details', 'Ano');
  setupConditional('school_fav_subjects_exists', 'q_school_fav_subjects_detail', 'Ano');
  setupConditional('school_disliked_subjects_exists', 'q_school_disliked_subjects_detail', 'Ano');
  setupConditional('school_homework_tracking', 'q_school_homework_tracking_detail', 'Ano');
  setupConditional('school_teacher_complaints_general', 'q_school_teacher_complaints_detail', 'Ano');
  setupConditional('school_teacher_praise_exists', 'q_school_teacher_praise_detail', 'Ano');
  setupConditional('school_seating_type', 'q_school_seating_pair_details', 'Po dvou');
  setupConditional('school_seating_type', 'q_school_seating_other_detail', 'JinÃ©');
  setupConditional('school_relax_zone_exists', 'q_school_relax_zone_detail', 'Ano');
  setupConditional('school_talks_about_friends', 'q_school_friends_detail', 'Ano');
  setupConditional('school_complains_about_peers', 'q_school_complains_peers_detail', 'Ano');
  setupConditional('school_complains_other', 'q_school_complains_other_detail', 'Ano');
}

setupConditional('mother_health', 'q_mother_health_detail', 'Ano');
setupConditional('father_health', 'q_father_health_detail', 'Ano');
setupConditional('other_carer_status', 'q_other_carer_detail', 'Ano');
setupConditional('mother_employed', 'q_mother_jobs_detail', 'Ano');
setupConditional('father_employed', 'q_father_jobs_detail', 'Ano');
setupConditional('has_siblings', 'q_siblings_detail', 'Ano');
setupConditional('child_has_device', 'q_child_device_detail1', 'Ano');
setupConditional('child_has_device', 'q_child_device_detail2', 'Ano');
setupConditional('child_has_device', 'q_child_device_detail3', 'Ano');
setupConditional('neurolog_exam', 'q_neurolog_exam_detail', 'Ano');
setupConditional('vision_issues', 'q_vision_issues_detail', 'Ano');
setupConditional('housing_type', 'q_housing_specification_detail', 'JinÃ©');

setupConditional('attends_kindergarten', 'q_kindergarten_details', 'Ano');
setupConditional('kg_morning_issues', 'q_morning_issues_detail', 'Ano');

// --- Logika pro sekci Å kola ---
setupConditional('attends_school', 'q_school_details', 'Ano');
setupConditional('school_fav_subjects_exists', 'q_school_fav_subjects_detail', 'Ano');
setupConditional('school_disliked_subjects_exists', 'q_school_disliked_subjects_detail', 'Ano');
setupConditional('school_homework_tracking', 'q_school_homework_tracking_detail', 'Ano');
setupConditional('school_teacher_complaints_general', 'q_school_teacher_complaints_detail', 'Ano');
setupConditional('school_teacher_praise_exists', 'q_school_teacher_praise_detail', 'Ano');

// PodmÃ­nky pro sezenÃ­
setupConditional('school_seating_type', 'q_school_seating_pair_details', 'Po dvou');
setupConditional('school_seating_type', 'q_school_seating_other_detail', 'JinÃ©');

setupConditional('school_relax_zone_exists', 'q_school_relax_zone_detail', 'Ano');
setupConditional('school_talks_about_friends', 'q_school_friends_detail', 'Ano');
setupConditional('school_complains_about_peers', 'q_school_complains_peers_detail', 'Ano');
setupConditional('school_complains_other', 'q_school_complains_other_detail', 'Ano');


// --- Logika pro sekci KrouÅ¾ky a zÃ¡jmy/Doma ---
setupConditional('hobbies_fav_exists', 'q_hobbies_fav_detail', 'Ano');
setupConditional('hobbies_clubs_exists', 'q_hobbies_clubs_detail', 'Ano');
setupConditional('home_chores_exists', 'q_home_chores_detail', 'Ano');
setupConditional('home_conflicts_exists', 'q_home_conflicts_detail', 'Ano');



// Auto-expand and retract textarea with padding only after first character
function autoExpandTextarea(textarea) {
  textarea.style.height = 'auto'; // Reset height to recalc scrollHeight

  const style = getComputedStyle(textarea);
  const lineHeight = parseFloat(style.lineHeight) || 24;
  const numLines = Math.round(textarea.scrollHeight / lineHeight);

  // Only add padding if textarea has at least one character
  const hasContent = textarea.value.trim().length > 0;
  const basePadding = hasContent ? 10 : 0; // 0 if empty, else 10px
  const extraPadding = hasContent ? (numLines - 1) * 10 : 0;
  const padding = Math.min(basePadding + extraPadding, 50);

  textarea.style.height = `${textarea.scrollHeight + padding}px`;
}

// Apply to all long-text textareas
document.querySelectorAll('textarea.long-text').forEach(area => {
  area.addEventListener('input', () => autoExpandTextarea(area));
  // Initialize height in case of prefilled content
  autoExpandTextarea(area);
});



// Dynamic generation for additional carers
const additionalCarersCountInput = document.getElementById('additional_carers_count');
const additionalCarersContainer = document.getElementById('additional_carers_container');
additionalCarersCountInput.addEventListener('input', () => {
  const count = parseInt(additionalCarersCountInput.value) || 0;
  additionalCarersContainer.innerHTML = '';
  for (let i = 1; i <= count; i++) {
    const fs = document.createElement('fieldset');
    fs.innerHTML = `
      <legend>DalÅ¡Ã­ vychovÃ¡vajÃ­cÃ­ osoba ${i}</legend>
      <div class="qa-block">
      <label><span>JmÃ©no osoby ${i}:</span><input class="short-text" type="text" name="carer_${i}_name"></label>
            </div>
            <div class="qa-block">
      <label><span>VÄ›k osoby ${i}:</span><input type="number" name="carer_${i}_age"></label>
            </div>
      <div class="qa-block"><label><span>JakÃ© jsou vaÅ¡e vztahy s osobou ${i}:</span></label><textarea class="long-text" name="carer_${i}_relation"></textarea></div>
      <div class="qa-block"><label><span>V jakÃ© domÃ¡cnosti osoba ${i} dÃ­tÄ› vychovÃ¡vÃ¡:</span></label><textarea class="long-text" name="carer_${i}_household"></textarea></div>
    `;
    additionalCarersContainer.appendChild(fs);
    fs.querySelectorAll('textarea.long-text').forEach(area => {
      area.addEventListener('input', () => autoExpandTextarea(area));
            autoExpandTextarea(area); // Initialize height for newly created textareas

    });
  }
});

// Dynamic generation for siblings
const siblingsCountInput = document.getElementById('siblings_count');
const siblingsContainer = document.getElementById('siblings_container');
siblingsCountInput.addEventListener('input', () => {
  const count = parseInt(siblingsCountInput.value) || 0;
  siblingsContainer.innerHTML = '';
  for (let i = 1; i <= count; i++) {
    const fs = document.createElement('fieldset');
    fs.innerHTML = `
      <legend>Sourozenec ${i}</legend>
      <div class="qa-block">
      <label><span>JmÃ©no sourozence ${i}:</span><input class="short-text" type="text" name="sibling_${i}_name"></label>
            </div>
          <div class="qa-block">
      <label><span>VÄ›k sourozence ${i}:</span><input type="number" name="sibling_${i}_age"></label>
            </div>
      <div class="qa-block">
        <label><span>Jsou dÃ­tÄ› a sourozenec biologiÄtÃ­ pÅ™Ã­buznÃ­:</span></label>
        <div class="select-group">
          <label><input type="radio" name="sibling_${i}_biological" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="sibling_${i}_biological" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="sibling_${i}_biological" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label><span>MÃ¡ dÃ­tÄ› se sourozencem spoleÄnÃ© rodiÄe:</span></label>
        <div class="select-group">
          <label><input type="radio" name="sibling_${i}_common_parents" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="sibling_${i}_common_parents" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="sibling_${i}_common_parents" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label><span>Å½ijÃ­ ve stejnÃ© domÃ¡cnosti:</span></label>
        <div class="select-group">
          <label><input type="radio" name="sibling_${i}_same_household" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="sibling_${i}_same_household" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="sibling_${i}_same_household" value="Bez odpovÄ›di"><span>Bez odpovÄ›di</span></label>
        </div>
      </div>
      <div class="qa-block"><label><span>JakÃ½ majÃ­ vztah:</span></label><textarea class="long-text" name="sibling_${i}_relationship"></textarea></div>
      <div class="qa-block"><label><span>FyzickÃ© a psychickÃ© diagnÃ³zy:</span></label><textarea class="long-text" name="sibling_${i}_diagnoses"></textarea></div>
    `;
    siblingsContainer.appendChild(fs);
    fs.querySelectorAll('textarea.long-text').forEach(area => {
      area.addEventListener('input', () => autoExpandTextarea(area));
            autoExpandTextarea(area); // Initialize height for newly created textareas
    });
  }
});

//saving

const formStorageKey = 'child_questionnaire_data';

function getFormData() {
  const form = document.querySelector('form');
  const data = {};

  form.querySelectorAll('input, select, textarea').forEach(el => {
    if (el.type === 'radio') {
      if (el.checked) data[el.name] = el.value;
    } else if (el.type === 'checkbox') {
      data[el.name] = el.checked;
    } else {
      data[el.name] = el.value;
    }
  });

  // Save dynamic carers
  const carers = [];
  document.querySelectorAll('#additional_carers_container fieldset').forEach(fs => {
    const carerData = {};
    fs.querySelectorAll('input, textarea').forEach(el => {
      carerData[el.name] = el.value;
    });
    carers.push(carerData);
  });
  data['additional_carers'] = carers;

  // Save dynamic siblings
  const siblings = [];
  document.querySelectorAll('#siblings_container fieldset').forEach(fs => {
    const siblingData = {};
    fs.querySelectorAll('input, select, textarea').forEach(el => {
      if (el.type === 'radio') {
        if (el.checked) siblingData[el.name] = el.value;
      } else if (el.type === 'checkbox') {
        siblingData[el.name] = el.checked;
      } else {
        siblingData[el.name] = el.value;
      }
    });
    siblings.push(siblingData);
  });
  data['siblings'] = siblings;
  
  return data;
}

function saveForm(showNotification = false) {
  const data = getFormData();
  localStorage.setItem(formStorageKey, JSON.stringify(data));
  if (showNotification) {
    alert("FormulÃ¡Å™ byl uloÅ¾en.");
  }
  // Enable the load button if it was disabled
  const loadBtn = document.getElementById('load-from-storage-btn');
  if (loadBtn && loadBtn.disabled) {
    loadBtn.disabled = false;
  }
}

async function saveAsJsonFile() {
  const data = getFormData();
  const jsonData = JSON.stringify(data, null, 2); // Pretty print JSON
  const blob = new Blob([jsonData], { type: 'application/json' });

  const date = new Date();
  const timestamp = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
  const childName = data.child_name ? data.child_name.replace(/ /g, '_') : 'dite';
  const suggestedName = `dotaznik-${childName}-${timestamp}.json`;

  // Use the modern File System Access API if available
  if (window.showSaveFilePicker) {
    try {
      const handle = await window.showSaveFilePicker({
        suggestedName: suggestedName,
        types: [{
          description: 'JSON Soubor',
          accept: { 'application/json': ['.json'] },
        }],
      });
      const writable = await handle.createWritable();
      await writable.write(blob);
      await writable.close();
    } catch (err) {
      // Handle cases where the user cancels the dialog
      if (err.name !== 'AbortError') {
        console.error('File save error:', err);
      }
    }
  } else {
    // Fallback for older browsers
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = suggestedName;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(a.href);
  }
}

function loadData(data) {
  const form = document.querySelector('form');

  // Reset form first
  form.reset();
  document.getElementById('additional_carers_container').innerHTML = '';
  document.getElementById('siblings_container').innerHTML = '';

  // Load static fields
  form.querySelectorAll('input, select, textarea').forEach(el => {
    if (el.type === 'radio') {
      if (data[el.name] === el.value) el.checked = true;
    } else if (el.type === 'checkbox') {
      el.checked = !!data[el.name];
    } else if (data[el.name] !== undefined) {
      el.value = data[el.name];
    }
  });

  // Recreate dynamic carers
  if (data['additional_carers']) {
    data['additional_carers'].forEach((carer, i) => {
      const fs = document.createElement('fieldset');
      fs.innerHTML = `
        <legend>DalÅ¡Ã­ vychovÃ¡vajÃ­cÃ­ osoba ${i + 1}</legend>
        <label><span>JmÃ©no osoby ${i + 1}:</span><input class="short-text" type="text" name="carer_${i+1}_name" value="${carer['carer_' + (i+1) + '_name'] || ''}"></label>
        <label><span>VÄ›k osoby ${i + 1}:</span><input type="number" name="carer_${i+1}_age" value="${carer['carer_' + (i+1) + '_age'] || ''}"></label>
        <div class="qa-block"><label><span>JakÃ© jsou vaÅ¡e vztahy s osobou ${i + 1}:</span></label><textarea class="long-text" name="carer_${i+1}_relation">${carer['carer_' + (i+1) + '_relation'] || ''}</textarea></div>
        <div class="qa-block"><label><span>V jakÃ© domÃ¡cnosti osoba ${i + 1} dÃ­tÄ› vychovÃ¡vÃ¡:</span></label><textarea class="long-text" name="carer_${i+1}_household">${carer['carer_' + (i+1) + '_household'] || ''}</textarea></div>
      `;
      document.getElementById('additional_carers_container').appendChild(fs);
      fs.querySelectorAll('textarea.long-text').forEach(area => autoExpandTextarea(area));
    });
  }

  // Recreate dynamic siblings
  if (data['siblings']) {
    data['siblings'].forEach((sib, i) => {
      const fs = document.createElement('fieldset');
      fs.innerHTML = `
        <legend>Sourozenec ${i + 1}</legend>
        <div class="qa-block">
          <label><span>JmÃ©no sourozence ${i + 1}:</span><input class="short-text" type="text" name="sibling_${i+1}_name" value="${sib['sibling_' + (i+1) + '_name'] || ''}"></label>
        </div>
        <div class="qa-block">
          <label><span>VÄ›k sourozence ${i + 1}:</span><input type="number" name="sibling_${i+1}_age" value="${sib['sibling_' + (i+1) + '_age'] || ''}"></label>
        </div>
        <div class="qa-block">
          <label><span>Jsou dÃ­tÄ› a sourozenec biologiÄtÃ­ pÅ™Ã­buznÃ­:</span></label>
          <div class="select-group">
            <label><input type="radio" name="sibling_${i+1}_biological" value="Ano" ${sib['sibling_' + (i+1) + '_biological'] === 'Ano' ? 'checked' : ''}><span>Ano</span></label>
            <label><input type="radio" name="sibling_${i+1}_biological" value="Ne" ${sib['sibling_' + (i+1) + '_biological'] === 'Ne' ? 'checked' : ''}><span>Ne</span></label>
            <label><input type="radio" name="sibling_${i+1}_biological" value="Bez odpovÄ›di" ${sib['sibling_' + (i+1) + '_biological'] === 'Bez odpovÄ›di' ? 'checked' : ''}><span>Bez odpovÄ›di</span></label>
          </div>
        </div>
        <div class="qa-block">
          <label><span>MÃ¡ dÃ­tÄ› se sourozencem spoleÄnÃ© rodiÄe:</span></label>
          <div class="select-group">
            <label><input type="radio" name="sibling_${i+1}_common_parents" value="Ano" ${sib['sibling_' + (i+1) + '_common_parents'] === 'Ano' ? 'checked' : ''}><span>Ano</span></label>
            <label><input type="radio" name="sibling_${i+1}_common_parents" value="Ne" ${sib['sibling_' + (i+1) + '_common_parents'] === 'Ne' ? 'checked' : ''}><span>Ne</span></label>
            <label><input type="radio" name="sibling_${i+1}_common_parents" value="Bez odpovÄ›di" ${sib['sibling_' + (i+1) + '_common_parents'] === 'Bez odpovÄ›di' ? 'checked' : ''}><span>Bez odpovÄ›di</span></label>
          </div>
        </div>
        <div class="qa-block">
          <label><span>Å½ijÃ­ ve stejnÃ© domÃ¡cnosti:</span></label>
          <div class="select-group">
            <label><input type="radio" name="sibling_${i+1}_same_household" value="Ano" ${sib['sibling_' + (i+1) + '_same_household'] === 'Ano' ? 'checked' : ''}><span>Ano</span></label>
            <label><input type="radio" name="sibling_${i+1}_same_household" value="Ne" ${sib['sibling_' + (i+1) + '_same_household'] === 'Ne' ? 'checked' : ''}><span>Ne</span></label>
            <label><input type="radio" name="sibling_${i+1}_same_household" value="Bez odpovÄ›di" ${sib['sibling_' + (i+1) + '_same_household'] === 'Bez odpovÄ›di' ? 'checked' : ''}><span>Bez odpovÄ›di</span></label>
          </div>
        </div>
        <div class="qa-block"><label><span>JakÃ½ majÃ­ vztah:</span></label><textarea class="long-text" name="sibling_${i+1}_relationship">${sib['sibling_' + (i+1) + '_relationship'] || ''}</textarea></div>
        <div class="qa-block"><label><span>FyzickÃ© a psychickÃ© diagnÃ³zy:</span></label><textarea class="long-text" name="sibling_${i+1}_diagnoses">${sib['sibling_' + (i+1) + '_diagnoses'] || ''}</textarea></div>
      `;
      document.getElementById('siblings_container').appendChild(fs);
      fs.querySelectorAll('textarea.long-text').forEach(area => autoExpandTextarea(area));
    });
  }
  // Trigger visibility checks for all conditional fields
  updateAllConditionals();

  // Ensure all textareas are expanded to fit loaded content
  form.querySelectorAll('textarea.long-text').forEach(area => {
    autoExpandTextarea(area);
  });

  // After adding new fields, re-validate the form to show/hide dots
  validateAllQuestions();
}

// Load saved data
function loadForm() {
  const saved = localStorage.getItem(formStorageKey);
  if (!saved) {
    alert("Å½Ã¡dnÃ¡ uloÅ¾enÃ¡ data nejsou k dispozici.");
    return;
  }
  const data = JSON.parse(saved);
  loadData(data);
  alert("FormulÃ¡Å™ byl obnoven z poslednÃ­ uloÅ¾enÃ© verze.");
}

// Clear history
function clearHistory() {
  if (confirm("Opravdu chcete smazat uloÅ¾enou historii?\n\nTato akce trvale odstranÃ­ veÅ¡kerÃ¡ data uloÅ¾enÃ¡ v prohlÃ­Å¾eÄi a vymaÅ¾e aktuÃ¡lnÄ› vyplnÄ›nÃ½ formulÃ¡Å™.")) {
    localStorage.removeItem(formStorageKey);
    document.querySelector('form').reset();
    document.getElementById('additional_carers_container').innerHTML = '';
    document.getElementById('siblings_container').innerHTML = '';
    alert("Historie byla smazÃ¡na.");
    document.getElementById('load-from-storage-btn').disabled = true;
    validateAllQuestions(); // Re-validate to show all dots again
  }
}

// --- Live Unanswered Question Validation ---

function validateQuestionBlock(block) {
  const label = block.querySelector('label > span');
  if (!label) return;

  let isUnanswered = false;

  // Ignore the calculated age field
  if (block.querySelector('#child_age')) {
    return;
  }

  // Case 1: Text, number, date, or textarea inputs
  const textInput = block.querySelector(':scope > input[type="text"], :scope > input[type="number"], :scope > input[type="date"], :scope > textarea, :scope > label > input[type="text"], :scope > label > input[type="number"]');
  if (textInput && textInput.value.trim() === '') {
    isUnanswered = true;
  }

  // Case 2: Radio button groups
  const radioGroup = block.querySelector(':scope > .select-group input[type="radio"]');
  if (radioGroup) {
    const checkedRadio = block.querySelector(`:scope > .select-group input[name="${radioGroup.name}"]:checked`);
    if (!checkedRadio) {
      isUnanswered = true;
    }
  }

  // Case 3: Checkbox groups (unanswered if none are checked)
  const checkboxGroup = block.querySelector(':scope > .select-group input[type="checkbox"]');
  if (checkboxGroup) {
    const isAnyCheckboxChecked = block.querySelector(':scope > .select-group input[type="checkbox"]:checked');
    if (!isAnyCheckboxChecked) {
      isUnanswered = true;
    }
  }

  const existingDot = label.querySelector('.unanswered-dot');

  if (isUnanswered) {
    if (!existingDot) {
      const dot = document.createElement('span');
      dot.className = 'unanswered-dot';
      label.prepend(dot);
    } else {
      existingDot.classList.remove('answered'); // Make it visible again
    }
  } else if (existingDot) {
    existingDot.classList.add('answered'); // Animate it out
  }
}

function validateAllQuestions() {
  document.querySelectorAll('.qa-block:not(.hidden), .qa-block.is-visible').forEach(validateQuestionBlock);
}

function debounce(func, delay) {
  let timeout;
  return function(...args) {
    const context = this;
    clearTimeout(timeout);
    timeout = setTimeout(() => func.apply(context, args), delay);
  };
}

function setupLiveValidation() {
  const form = document.getElementById('questionnaire');
  // Create a debounced auto-save function that saves silently.
  const autoSave = debounce(() => saveForm(false), 1500);

  form.addEventListener('input', (event) => {
    const block = event.target.closest('.qa-block');
    if (block) {
      autoSave(); // Trigger auto-save on any input.
      validateQuestionBlock(block);
    }
    // After adding new fields, re-validate the form to show/hide dots
    setTimeout(() => {
      validateAllQuestions();
    }, 100); // Delay to ensure dynamic elements are fully rendered
  });

  // Initial validation on page load
  validateAllQuestions();
}



// --- Print with Unanswered Marks ---

function removeUnansweredMarks() {
  document.querySelectorAll('.unanswered-mark').forEach(mark => mark.remove());
}

function togglePrintPreview() {
  const body = document.body;
  const html = document.documentElement;
  const button = document.getElementById('preview-button');
  const form = document.getElementById('questionnaire');
  const isPreviewing = html.classList.toggle('preview-mode-active');
  body.classList.toggle('print-preview', isPreviewing);

  // Select all input fields
  const inputs = form.querySelectorAll('input, textarea, select');

  if (isPreviewing) {
    markUnansweredQuestions();
    window.scrollTo(0, 0); // Scroll to top

    // Make all fields non-editable
    inputs.forEach(el => {
      if (el.tagName.toLowerCase() !== 'select' && el.type !== 'radio' && el.type !== 'checkbox') {
        el.readOnly = true;
      }
    });

    // Reset textarea height for preview so CSS can take over
    // Recalculate height to fit content exactly, removing auto-expand gaps.
    document.querySelectorAll('textarea.long-text').forEach(area => {
        const buffer = area.scrollHeight * 0.15; // buffer as 15% of scrollHeight
        area.style.height = 'auto'; // Reset height
        area.style.height = `${area.scrollHeight + buffer}px`; // Set to content height + buffer
        area.style.overflow = 'hidden'; // Hide scrollbar that might appear
    });

  } else {
    removeUnansweredMarks();
    inputs.forEach(el => {
        el.readOnly = false;
    });

    // Re-apply auto-expand to textareas when exiting preview
    document.querySelectorAll('textarea.long-text').forEach(area => {
        area.style.overflow = ''; // Restore default overflow
        autoExpandTextarea(area);
    });
  }
}

function markUnansweredQuestions() {
  // Find all question blocks that are currently visible
  document.querySelectorAll('.qa-block:not(.hidden), .qa-block.is-visible').forEach(block => {
    const label = block.querySelector('label > span');
    if (!label) return;

    // Ignore the calculated age field from being marked as unanswered
    if (block.querySelector('#child_age')) {
        return;
    }

    let isUnanswered = false;
    // Case 1: Text, number, date, or textarea inputs
    // This selector handles both direct children and inputs nested inside the label.
    const textInput = block.querySelector(':scope > input[type="text"], :scope > input[type="number"], :scope > input[type="date"], :scope > textarea, :scope > label > input[type="text"], :scope > label > input[type="number"]');

    if (textInput && textInput.value.trim() === '') {
      isUnanswered = true;
    }

    // Case 2: Radio button groups
    const radioGroup = block.querySelector(':scope > .select-group input[type="radio"]');
    if (radioGroup) {
      const checkedRadio = block.querySelector(`:scope > .select-group input[name="${radioGroup.name}"]:checked`);
      if (!checkedRadio || checkedRadio.value === 'Bez odpovÄ›di') {
        isUnanswered = true;
      }
    }

    // Case 3: Checkbox groups (if none are checked)
    const checkboxGroup = block.querySelector(':scope > .select-group input[type="checkbox"]');
    if (checkboxGroup) {
      const isAnyCheckboxChecked = block.querySelector(':scope > .select-group input[type="checkbox"]:checked');
      if (!isAnyCheckboxChecked) isUnanswered = true;
    }

    // Add the asterisk if the question is unanswered
    if (isUnanswered) {
      const mark = document.createElement('span');
      mark.className = 'unanswered-mark';
      mark.style.display = 'none'; // Hide by default, shown by print styles
      mark.textContent = '*';
      label.prepend(mark);
    }
  });
}

function printWithUnansweredMarks() {
  // This function is now used for the "Tisk PDF" button in preview
  window.print();
}

window.addEventListener('afterprint', () => {
  // Only remove marks if we are NOT in preview mode.
  if (!document.documentElement.classList.contains('preview-mode-active')) {
    removeUnansweredMarks();
  }
});

// Initialize all dynamic functionalities on page load
document.addEventListener('DOMContentLoaded', () => {
  setupLiveValidation();

  // Check if there's saved data and enable/disable the load button
  const loadBtn = document.getElementById('load-from-storage-btn');
  if (loadBtn && !localStorage.getItem(formStorageKey)) {
    loadBtn.disabled = true;
  }

  const fileInput = document.getElementById('json-file-input');
  fileInput.addEventListener('change', (event) => {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        const data = JSON.parse(e.target.result);
        loadData(data);
        alert("Data byla ÃºspÄ›Å¡nÄ› naÄtena ze souboru.");
      } catch (error) {
        alert("Chyba pÅ™i ÄtenÃ­ souboru. UjistÄ›te se, Å¾e se jednÃ¡ o platnÃ½ JSON soubor.");
      }
    };
    reader.readAsText(file);
    fileInput.value = ''; // Reset input so the same file can be loaded again
  });
});






</script>

</body>
</html>
