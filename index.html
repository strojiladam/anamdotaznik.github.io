<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dotazn√≠k d√≠tƒõte</title>
<style>
  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f6f8; color: #333; margin: 0; padding: 20px; }
  h1 { color: #0000dc; text-align: center; margin-bottom: 30px; }
  form { max-width: 900px; margin: 0 auto; background-color: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
  fieldset { border: 1px solid #ccc; border-radius: 8px; padding: 15px; margin-bottom: 20px; background-color: #fafafa; min-width: 0; }
  legend { font-weight: bold; color: #0000dc; font-size: 16px; padding: 0 5px; }
  label {
    display: block;
    margin-bottom: 0;
    font-weight: 500;
    page-break-inside: avoid;
  }
  input, select, textarea {
    padding: 6px;
    border-radius: 5px;
    border: 1px solid #ccc;
    font-size: 16px;
    width: 100%;
    margin-left: 0;
    min-width: 0;
    box-sizing: border-box;
    margin-top: 6px;
    margin-bottom: 22px;
    line-height: 1.5;
    height: 40px;
    font-family: "Times New Roman", Times, serif;
    vertical-align: middle;
  }

  /* Fix for date inputs on mobile devices */
  input[type="date"] {
    -webkit-appearance: none;
    appearance: none;
    background-color: #fff;
  }

  /* Add this block for consistent focus styles */
  input:focus-visible,
  select:focus-visible,
  textarea:focus-visible {
    border-color: #0000dc; /* Change border to your accent color */
    outline: none; /* Remove the default browser outline */
  }

  /* Hide arrows from number inputs - for Chrome, Safari, Edge, Opera */
  input[type=number]::-webkit-outer-spin-button,
  input[type=number]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  /* Hide arrows from number inputs - for Firefox */
  input[type=number] {
    -moz-appearance: textfield;
    appearance: textfield;
  }

  textarea.long-text {
    width: 100%;
    overflow-wrap: break-word;
    resize: none;
    box-sizing: border-box;
    margin-top: 6px;
    margin-bottom: 22px;
  }
  
/* --- Button Styles --- */

/* Base button style for consistent sizing and font */
.btn {
  padding: 12px 22px;
  font-size: 15px;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.2s, border-color 0.2s, color 0.2s;
  border: 1px solid transparent; /* Reserve space for border */
  margin: 0; /* Reset margin */
}

/* Primary button style */
.btn.primary {
  background-color: #0000dc;
  color: white;
  border-color: #0000dc;
  font-weight: bold;
}

.btn.primary:hover {
  background-color: #0000aa;
  border-color: #0000aa;
}

/* Secondary button style */
.btn.btn-secondary {
  background-color: white;
  color: #0000dc;
  border: 1px solid #0000dc;
  font-weight: 500;
}

.btn.btn-secondary:hover:not(:disabled) {
  background-color: #e9f1ff; /* Light blue from tip-block */
}

.btn.btn-secondary:disabled {
  color: #999;
  border-color: #ccc;
  cursor: not-allowed;
}

/* Danger button style */
.btn.btn-danger {
  background-color: white;
  color: var(--color-error);
  border: 1px solid var(--color-error);
  font-weight: 500;
}

.btn.btn-danger:hover:not(:disabled) {
  background-color: rgba(176, 42, 55, 0.1); /* Light red, consistent with other hovers */
}

/* Styl pro nen√°padn√© smaz√°n√≠ dat */
.btn-delete-link {
    background: none;
    border: none;
    color: #535353;
    text-decoration: underline;
    cursor: pointer;
    font-size: 12px;
    padding: 0;
    font-family: inherit;
    transition: color 0.2s ease;
}

.btn-delete-link:hover {
    color: var(--color-error); /* Zƒçerven√° a≈æ p≈ôi najet√≠ (vizu√°ln√≠ varov√°n√≠) */
}


.alert-action-link {
    color: inherit; /* P≈ôeb√≠r√° barvu okoln√≠ho textu */
    text-decoration: underline;
    cursor: pointer;
    font-weight: inherit; /* Vypad√° jako bƒõ≈æn√Ω text */
    transition: color 0.2s ease;
}

.alert-action-link:hover {
    color: var(--color-error); /* Zƒçerven√° p≈ôi najet√≠ (shoda s mazac√≠m odkazem) */
}

/* Styl pro dynamick√© pole (style-soft) */
.style-soft {
    background: #fff;
    border: 1px solid #ccc; 
    border-radius: 8px;
    margin-bottom: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    padding: 0 !important;
}
.style-soft-header {
    padding: 15px 20px 10px; 
    display: flex; justify-content: space-between; align-items: center;
    border-bottom: 1px solid #f0f0f0; 
}
.style-soft-header legend {
    font-weight: 700; color: #0000dc; font-size: 16px; margin: 0 !important;
    border-bottom: none !important;
    padding: 0;
}
.style-soft-body { padding: 15px 20px 20px; }

/* Inputy v tomto stylu */

/* UPRAVEN√â TLAƒå√çTKO ODEBRAT */
.btn-remove-3 {
    background: none;
    border: 1px solid transparent; /* Rezerva pro r√°meƒçek p≈ôi hoveru */
    color: #666;
    font-size: 14px; /* Men≈°√≠ p√≠smo pro text */
    font-weight: 500;
    cursor: pointer;
    display: inline-flex; align-items: center; gap: 8px; /* Zarovn√°n√≠ ikony a textu */
    padding: 6px 12px;
    border-radius: 4px;
    transition: all 0.2s;
}
.btn-remove-3:hover {
    color: #c62828; /* ƒåerven√° */
    background-color: #fff5f5; /* Jemnƒõ ƒçerven√© pozad√≠ */
    border-color: #ffd6d6;
}

.preview-mode-active .btn-add-item, 
.preview-mode-active .btn-remove-3 {
    display: none !important;
}

/* Flex container for save buttons */
.save-buttons {
  display: flex;
  gap: 10px;
  align-items: center; /* Align items vertically */
}

/* Smooth transitions for conditional blocks */
.qa-block {
  transition: opacity 0.4s ease, max-height 0.4s ease, margin 0.4s ease, padding 0.4s ease;
  overflow: hidden;
}

.qa-block.hidden {
  opacity: 0;
  max-height: 0;
  margin-top: 0 !important;
  margin-bottom: 0 !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}

.qa-block.hidden.is-visible {
  opacity: 1;
  max-height: none; /* Allow content to expand to its natural height. */
  margin-bottom: 22px !important; /* Restore original spacing */
}

/* Kompenzace pro qa-group, aby se ≈°ipka tip-blocku neo≈ô√≠zla, ale nevznikla velk√° mezera */
.qa-group.hidden.is-visible {
  margin-top: -12px !important;
  padding-top: 12px !important;
}


/* Unified select-group alignment */
.select-group {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  width: 100%;
  margin-top: 6px;
  margin-bottom: 22px;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 8px;
  background: #fff;
  align-items: center;
  justify-content: flex-start;
  box-sizing: border-box;
}

.select-group label {
  display: flex;
  align-items: center;
  gap: 6px; /* spacing between input and text */
  font-weight: 500;
  margin: 0;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.15s ease, color 0.15s ease;
  user-select: none;
  min-height: 32px;
}

.select-group input[type="radio"],
.select-group input[type="checkbox"] {
  width: 18px;
  height: 18px;
  margin: 0; /* remove margin-right */
  accent-color: #0000dc;
}

.select-group label span {
  display: inline-block;
  padding: 2px 4px;
  border-radius: 4px;
  line-height: 1.2;
  height: auto;
}

html:not(.preview-mode-active) .select-group label:hover span {
  background-color: #0000dc08;
}

html:not(.preview-mode-active) .select-group input[type="radio"]:checked + span,
html:not(.preview-mode-active) .select-group input[type="checkbox"]:checked + span {
  background-color: #0000dc10;
  color: #0000dc;
}

.select-group input[type="radio"]:focus-visible,
.select-group input[type="checkbox"]:focus-visible {
  outline: 2px solid rgba(0, 0, 220, 0.2);
  outline-offset: 2px;
}


/* --- Custom styling for "Bez odpovƒõdi" --- */

/* 1. Default state: Grey text for "Bez odpovƒõdi" */
.select-group input[value="Bez odpovƒõdi"] + span {
  color: #6c757d; /* A neutral grey */
  transition: background-color 0.15s ease, color 0.15s ease; /* Smooth transition */
}

/* 2. Hover state: Highlight with a light red background */
html:not(.preview-mode-active) .select-group label:has(input[value="Bez odpovƒõdi"]):hover span {
  background-color: rgba(176, 42, 55, 0.1); /* Light red background */
}

/* 3. Selected state: Red text and light red background */
html:not(.preview-mode-active) .select-group input[value="Bez odpovƒõdi"]:checked + span {
  color: var(--color-error); /* Red text */
  background-color: rgba(176, 42, 55, 0.1); /* Light red background */
}


  /* Tip / note block */
.tip-block {
  background-color: #e9f1ff; /* light blue tone matching your accent */
  border-bottom: 3px solid #B3C7FF;
  border-radius: 8px;
  padding: 14px 18px; /* Keep padding consistent */
  margin: 10px 0 20px;  font-size: 15px;
  font-style: italic;
  line-height: 1.6;
  color: #222;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  position: relative; /* Needed to position the arrow */
}

/* Arrow pointing DOWN (for tip blocks ABOVE a question) */
.tip-block::after {
  content: '';
  position: absolute;
  bottom: -10px; /* Position the arrow just below the block */
  left: 30px; /* Indent the arrow slightly */
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-top: 10px solid #B3C7FF; /* Arrow color matches the block */
}

/* New modifier class for a tip block placed UNDER a question */
.tip-block.tip-block-under {
  margin-top: 0px; /* Reset na 0px, o≈ôez√°n√≠ ≈°ipky ≈ôe≈°√≠me posunem rodiƒçe (.qa-group) */
  margin-bottom: 30px; /* Removes bottom margin */
  border-bottom: 0;
  border-top: 3px solid #B3C7FF; /* Change border to top */
}

/* Arrow pointing UP (for tip blocks UNDER a question) */
.tip-block.tip-block-under::after {
  bottom: auto; /* Unset the 'bottom' property from the default arrow */
  top: -10px; /* Position the arrow just above the block */
  border-top: none; /* Remove the downward-pointing arrow */
  border-bottom: 10px solid #B3C7FF; /* Create an upward-pointing arrow */
}

.tip-block::before {
  content: "üí° Proƒç se pt√°me?";
  font-weight: 300;
  font-style: normal;
  color: #0000dc;
  display: block;
  margin-bottom: 6px;
}

/* Instruction block style */
.instruction-block {
  background-color: #f8f9fa;
  border: 1px solid #ccc;
  border-left: 3px solid #6c757d; /* Neutral grey border */
  border-radius: 8px;
  padding: 14px 18px;
  margin: 20px 0 30px 0;
  font-size: 15px;
  line-height: 1.6;
  color: #222;
}

.instruction-block::before {
  content: "Instrukce k vypl≈àov√°n√≠";
  font-weight: bold;
  color: #333;
  display: block;
  margin-bottom: 8px;
}

.instruction-block.sharing-options::before {
  content: "Mo≈ænosti ulo≈æen√≠ a sd√≠len√≠";
  font-weight: bold;
  color: #333;
}

.instruction-block ul {
  padding-left: 25px; 
  margin-top: 10px;
  margin-bottom: 10px;
}

.manual-alert {
    background-color: var(--color-warning-bg);
    border: 1px solid var(--color-warning-border);
    border-left: 4px solid var(--color-warning-accent);
    border-radius: 8px;
    padding: 12px 16px;
    margin: 15px 0;
    font-size: 14px;
    line-height: 1.5;
    color: var(--color-warning-text);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.manual-alert strong {
    color: var(--color-warning);
    display: block; 
    margin-bottom: 4px; 
    font-weight: 600;
}


  .page-footer {
  width: 100%;
  text-align: center;
  font-size: 10pt;
  color: #666;
  font-family: "Times New Roman", Times, serif;
  border-top: 1px solid #ccc;
  padding: 10px 0;
  margin-top: 40px;
  position: relative;
}

/* --- Preview Floating Controls --- */
.preview-controls {
  display: none; /* Hidden by default */
}

.preview-mode-active .preview-controls {
  display: flex;
  gap: 15px;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 15px 25px;
  background-color: rgba(255, 255, 255, 0.95);
  border-radius: 12px;
  box-shadow: 0 -4px 12px rgba(0,0,0,0.15);
  z-index: 1001;
  border: 1px solid #ddd;
  border-bottom: none;
}

/* --- Print Text Replacement (Shadow DIV) --- */
.print-text-replacement {
  display: none; /* Norm√°lnƒõ neviditeln√© */
  white-space: pre-wrap; /* Zachov√° od≈ô√°dkov√°n√≠ */
  font-family: "Times New Roman", Times, serif;
  font-size: 12pt;
  color: #444; /* Shoda s barvou input≈Ø p≈ôi tisku */
  line-height: 1.5;
  margin-bottom: 22px;
  width: 100%;
  overflow-wrap: break-word;
  min-height: 1.5em; /* Zajist√≠ alespo≈à jeden ≈ô√°dek m√≠sta */
  padding: 6px; /* Odsazen√≠ textu stejnƒõ jako u input≈Ø */
  box-sizing: border-box;
  margin-top: 6px;
}


/* --- A4 Preview Layout --- */
@media screen {
  .preview-mode-active {
    background-color: #e0e0e0; /* Grey backdrop */
  }
  .preview-mode-active body {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0;
  }

  .preview-mode-active main {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
  }

  /* Scale down the A4 preview on smaller screens */
  @media (max-width: 230mm) {
    .preview-mode-active form {
      /* Calculate the scale factor to fit the viewport width */
      transform: scale(calc(100vw / 230mm));
      transform-origin: top center;
      /* Adjust margin to account for scaling */
      margin-top: calc(20px * (230mm / 100vw));
      margin-bottom: calc(20px * (230mm / 100vw));
    }
  }
}

.print-preview.preview-mode-active body, .print-preview body {
  background-color: #e0e0e0;
}


.print-preview fieldset > label,
.print-preview fieldset > input,
.print-preview fieldset > select,
.print-preview fieldset > textarea,
.print-preview fieldset > .select-group,
.print-preview fieldset > .qa-block {
  page-break-inside: avoid !important;
}

.print-preview #additional_carers_container fieldset,
.print-preview #siblings_container fieldset {
  border: none !important;
  margin: 0 0 10mm 0 !important;
  padding: 0 !important;
}

.print-preview #additional_carers_container legend,
.print-preview #siblings_container legend {
  font-size: 13pt !important;
  color: #000 !important;
  font-weight: bold !important;
  margin-left: 0 !important;
  margin-bottom: 4mm !important;
}

.print-preview #additional_carers_container .qa-block,
.print-preview #siblings_container .qa-block {
  margin-left: 8mm !important;
}

.print-preview #additional_carers_container span,
.print-preview #siblings_container span {
  margin-left: 0 !important;
  text-indent: 0 !important;
}

.print-preview h1 {
  font-weight: bold;
  font-size: 20pt;
  color: #0000dc;
  margin-bottom: 20px;
  font-family: "Times New Roman", Times, serif;
}

.print-preview .print-only-header {
  display: block;
}

.print-preview .tip-block,
.print-preview .instruction-block {
  display: none;
}

.preview-mode-active form {
  width: 230mm;
  min-height: 297mm;
  margin: 20px 0; /* Add some vertical margin for spacing from screen edges */
  padding: 20mm;
  background-color: white;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  border-radius: 0;
  box-sizing: border-box;
  border: none;
}

.print-preview form {
  font-family: "Times New Roman", Times, serif;
}

.print-preview .qa-block {
  display: block;
  page-break-inside: auto !important; /* Povol√≠ roztr≈æen√≠ bloku vejp≈Øl */
}

.print-preview fieldset {
  background: none;
  border: none !important;
  padding: 0 !important;
  margin-bottom: 25px !important;
  font-family: "Times New Roman", Times, serif;
}
.preview-mode-active fieldset {
  border-radius: 0;
}

.print-preview legend {
  color: #0000dc;
  font-size: 14pt;
  font-weight: normal;
  border-bottom: none;
  margin-left: 0 !important;
  padding: 0 !important;
  margin-bottom: 25px !important;
  text-align: left !important;
  font-family: "Times New Roman", Times, serif;
}

.print-preview label {
  display: block !important;
  justify-content: flex-start;
  margin-bottom: 6px !important;
  page-break-inside: avoid !important;
  font-weight: normal;
  color: black;
  font-family: "Times New Roman", Times, serif;
}

.print-preview label span {
  display: block;
  margin-bottom: 4px;
  font-weight: normal;
  color: black;
  font-family: "Times New Roman", Times, serif;
}

.print-preview input,
.print-preview select,
.print-preview textarea {
  display: block !important;
  border: none;
  background: none;
  width: 100% !important;
  font-weight: normal;
  margin-left: 0 !important;
  color: #444;
  font-family: "Times New Roman", Times, serif;
  font-size: 12pt !important;
  page-break-inside: auto !important;
  margin-bottom: 22px !important;
}

.print-preview textarea {
  display: none !important;
}
.print-preview .print-text-replacement {
  display: block !important;
}

/* Make inputs non-editable in preview */
.print-preview.preview-mode-active input,
.print-preview.preview-mode-active select,
.print-preview.preview-mode-active textarea {
  pointer-events: none;
  caret-color: transparent;
}

.print-preview .qa-block > label {
  page-break-after: avoid !important;
}

.print-preview select {
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
  pointer-events: none;
}

.print-preview select::-ms-expand { display: none !important; }

.print-preview textarea::-webkit-scrollbar { display: none !important; }

.print-preview .select-group {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 16px !important;
  margin-top: 0 !important;
  margin-bottom: 22px !important;
  padding: 0 !important;
  background: none !important;
  border: none !important;
  page-break-inside: avoid !important;
  pointer-events: none; /* Disable interaction on the whole group */
}

.print-preview .select-group label {
  display: flex !important;
  align-items: center !important;
  gap: 6px !important;
  font-weight: normal !important;
  font-size: 12pt !important;
  color: #000 !important;
  padding: 0 !important;
  margin: 0 !important;
  background: none !important;
  border: none !important;
  cursor: default !important;
}

.print-preview .select-group input[type="radio"],
.print-preview .select-group input[type="checkbox"] {
  width: 14px !important;
  height: 14px !important;
  margin: 0 !important;
  accent-color: #000 !important;
}

.print-preview .select-group label span {
  display: inline-block !important;
  line-height: 1.2 !important;
  color: #000 !important;
  font-weight: normal !important;
}

.print-preview .select-group input[type="radio"]:checked + span,
.print-preview .select-group input[type="checkbox"]:checked + span {
  font-weight: bold !important;
}

.print-preview #preview-button,
.print-preview .save-buttons,
.print-preview #json-file-input {
 display: none !important; }

.print-preview .qa-block.hidden:not(.is-visible) { display: none !important; }

.print-preview .unanswered-mark {
  display: inline !important;
  font-weight: bold;
  color: var(--color-error);
  margin-right: 6px;
}

.print-preview .unanswered-dot {
  display: none !important;
}

.print-preview .page-footer {
  display: none;
}

.print-preview .survey-utility-header {
    display: none !important;
}

.print-preview .header-wide {
  display: none;
}

/* --- Print Styles --- */

@media print {
  fieldset > label,
  fieldset > input,
  fieldset > select,
  fieldset > textarea,
  fieldset > .select-group,
  fieldset > .qa-block {
    page-break-inside: avoid !important;
  }

  @page { 
    size: A4; 
    margin: 20mm; 
  }

  html {
    font-size: 12pt; /* Set a base font size for print to prevent scaling issues */
  }


  form {
    box-shadow: none !important;
    padding: 0 !important;
  }

  /* Keep dynamic fieldsets (siblings, carers) visually grouped */
  #additional_carers_container fieldset,
  #siblings_container fieldset {
    border: none !important;
    margin: 0 0 10mm 0 !important; /* Remove indent, rely on qa-block margin */
    padding: 0 !important;
  }

  #additional_carers_container legend,
  #siblings_container legend {
    font-size: 13pt !important;
    color: #000 !important;
    font-weight: bold !important;
    margin-left: 0 !important;
    margin-bottom: 4mm !important;
  }

  /* Consistent alignment inside generated carers/siblings */
  #additional_carers_container .qa-block,
  #siblings_container .qa-block {
    margin-left: 8mm !important; /* Indent the questions for hierarchy */
  }

  #additional_carers_container span,
  #siblings_container span {
    margin-left: 0 !important;
    text-indent: 0 !important;
  }

  body {
    background-color: white;
    padding: 0;
    margin: 0;
    font-size: 12pt;
    font-family: "Times New Roman", Times, serif;
    color: black;
  }

  h1 {
    font-weight: bold;
    font-size: 20pt;
    color: #0000dc;
    margin-bottom: 20px;
    font-family: "Times New Roman", Times, serif;
  }

  .print-only-header {
    display: block !important;
  }

  .tip-block,
  .instruction-block {
    display: none;
  }

  form {
    box-shadow: none;
    background: none;
    padding: 0;
    max-width: 100%;
    font-family: "Times New Roman", Times, serif;
  }

  fieldset {
    background: none;
    border: none !important;
    padding: 0 !important;
    margin-bottom: 25px !important;
    font-family: "Times New Roman", Times, serif;
  }

  legend {
    color: #0000dc; 
    font-size: 14pt;
    font-weight: normal;
    border-bottom: none;
    margin-left: 0 !important;
    padding: 0 !important;
    margin-bottom: 25px !important;
    text-align: left !important;
    font-family: "Times New Roman", Times, serif;
  }

  label {
    display: block !important;
    justify-content: flex-start;
    margin-bottom: 6px !important;
    page-break-inside: avoid !important;
    font-weight: normal;
    color: black; 
    font-family: "Times New Roman", Times, serif;
  }

  label span {
    display: block;
    margin-bottom: 4px;
    font-weight: normal;
    color: black; 
    font-family: "Times New Roman", Times, serif;
  }

  input,
  select,
  textarea {
    display: block !important;
    border: none;
    background: none;
    width: 100% !important;
    font-weight: normal;
    margin-left: 0 !important;
    color: #444; 
    font-family: "Times New Roman", Times, serif;
    font-size: 12pt !important;
    page-break-inside: auto !important; /* Allow breaking inside long textareas */
    margin-bottom: 22px !important; /* Keep consistent spacing */
  }

  /* Hide textareas and show replacement divs for better pagination */
  textarea {
    display: none !important;
  }
  .print-text-replacement {
    display: block !important;
  }

  textarea {
    resize: none;
    white-space: pre-wrap;
    overflow: visible !important;
  }
  
  /* Ensure the label and the start of the textarea stay together */
  .qa-block > label {
    page-break-after: avoid !important;
  }

  select {
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    pointer-events: none;
  }

  select::-ms-expand { display: none !important; }

  textarea::-webkit-scrollbar { display: none !important; }

  .select-group {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 16px !important;
    margin-top: 0 !important;
    margin-bottom: 22px !important;
    padding: 0 !important;
    background: none !important;
    border: none !important;
    page-break-inside: avoid !important;
  }

  .select-group label {
    display: flex !important;
    align-items: center !important;
    gap: 6px !important;
    font-weight: normal !important;
    font-size: 12pt !important;
    color: #000 !important;
    padding: 0 !important;
    margin: 0 !important;
    background: none !important;
    border: none !important;
    cursor: default !important;
  }

  .select-group input[type="radio"],
  .select-group input[type="checkbox"] {
    width: 14px !important;
    height: 14px !important;
    margin: 0 !important;
    accent-color: #000 !important;
  }

  .select-group label span {
    display: inline-block !important;
    line-height: 1.2 !important;
    color: #000 !important;
    font-weight: normal !important;
  }

  .select-group input[type="radio"]:checked + span,
  .select-group input[type="checkbox"]:checked + span {
    font-weight: bold !important;
  }

  .qa-block {
    display: block;
    page-break-inside: auto !important; /* Allow breaking inside long text blocks */
  }

  /* Hide buttons and other non-printable elements */
  button,
  #json-file-input { display: none !important; }
  
  /* Only hide conditional blocks that are NOT visible on screen */
  .qa-block.hidden:not(.is-visible) { display: none !important; }

  /* Style for the unanswered question marker */
  .unanswered-mark {
    display: inline !important; /* Show the asterisk */
    font-weight: bold;
    color: var(--color-error); /* Make it red to stand out */
    margin-right: 6px;
  }

  /* Hide the live validation dot on print */
  .unanswered-dot {
    display: none !important;
  }

  .preview-controls {
    display: none !important; /* Hide floating controls in the actual print output */
  }


.page-footer {
    display: none;
  } 

  .header-wide {
    display: none;
  }
}

/* --- Unanswered Question Dot (Live) --- */
.unanswered-dot {
  display: inline-block;
  width: 9px;
  height: 9px;
  background-color: var(--muni-blue); /* Pln√° modr√° pro nezodpovƒõzen√© */
  border: 1px solid var(--muni-blue);
  border-radius: 50%;
  margin-right: 9px;
  vertical-align: middle;
  box-sizing: border-box;
  transition: background-color 0.4s ease, border-color 0.4s ease;
  opacity: 1;
}

/* Stav po zodpovƒõzen√≠: Teƒçka se "vypr√°zdn√≠" */
.unanswered-dot.answered {
  background-color: transparent; /* Zmiz√≠ barva uvnit≈ô */
  border-color: var(--muni-blue); /* Z≈Østane jen modr√Ω obrys */
  opacity: 0.4; /* M√≠rn√© zpr≈Øhlednƒõn√≠, aby hotov√© ot√°zky vizu√°lnƒõ ustoupily */
}

/* --- Mobile-specific adjustments --- */
@media (max-width: 600px) {
  body:not(.preview-mode-active) {
    padding: 5px; /* Reduce body padding on small screens */
  }
  form:not(.preview-mode-active form) {
    padding: 7px; /* Reduce form padding on small screens */
  }
}


/* --- Header bar --- */
.survey-utility-header {
    width: 100%;
    background-color: #ffffff;
    border-bottom: 1px solid #e0e0e0;
    padding: 8px 0;
    font-size: 13px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #666;
}

.header-inner {
    max-width: 900px; /* Zarovn√°no s ≈°√≠≈ôkou va≈°eho formul√°≈ôe */
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
}

.header-link, .version-link {
    text-decoration: none;
    color: #666;
    transition: color 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 5px;
}

.header-left {
    color: #0000dc;
    font-family: 'Roboto', sans-serif;
    font-size: 16px;
}

.header-right {
    display: flex;
    gap: 25px;
}

.header-link:hover {
    color: #0000dc;
}

.feedback-link {
    font-weight: 500;
}

.version-link {
    font-family: monospace;
    background: #f4f6f8;
    padding: 2px 8px;
    border-radius: 4px;
}

.version-link:hover {
    background: #0000dc10;
    color: #0000dc;
}

.changelog-text {
    font-size: 11px;
    opacity: 0.7;
}

.icon {
    font-size: 14px;
}

/* Skryt√≠ v tiskov√©m n√°hledu a p≈ôi tisku */
@media print {
    .survey-utility-header {
        display: none !important;
    }
}

/* Mobiln√≠ √∫prava */
@media (max-width: 600px) {
    .header-inner {
        flex-direction: column;
        gap: 17px;
        text-align: center;
    }
}

/* Headline styles */

:root {
    --muni-blue: #0000dc;
    --text-black: #000000;
    --font-heavy: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;

    /* Unified Accessible Colors (WCAG AA compliant) */
    --color-success: #1a7a33; 
    --color-error: #c62828;   
    --color-warning: #BF360C;        /* Pro nadpis a ikony */
    --color-warning-text: #4E342E;   /* Pro hlavn√≠ text - High Contrast */
    --color-warning-bg: #FFF9F0;     /* Pozad√≠ */
    --color-warning-accent: #E65100; /* Tlust√° ƒç√°ra vlevo */
    --color-warning-border: #FFCC80; /* Jemn√Ω r√°meƒçek kolem */
}

.header-wide {
    max-width: 1000px;
    margin: 60px auto;
    padding: 0 40px;
    display: flex;
    flex-direction: column;
    align-items: flex-end; /* Pravostrann√© zarovn√°n√≠ */
    font-family: var(--font-heavy);
}

/* Hlavn√≠ titul na jednom ≈ô√°dku */
.title-single-line {
    white-space: nowrap;
    color: var(--muni-blue);
    font-weight: 900;
    font-size: 32pt;
    line-height: 1;
    margin: 0;
    text-transform: uppercase;
    letter-spacing: -1px;
}

/* Podnadpis pod titulem */
.subtitle-wide {
    color: var(--text-black);
    font-weight: 700;
    font-size: 14pt;
    text-transform: uppercase;
    margin: 10px 0 0 0;
    letter-spacing: 2px;
}

/* Grafick√° li≈°ta s linkou a teƒçkami */
.accent-row {
    display: flex;
    align-items: center;
    width: 100%;
    margin-top: 30px;
    justify-content: flex-end;
}

.accent-line {
    height: 2.5px;
    background-color: var(--muni-blue);
    flex-grow: 1;
    max-width: 600px;
    margin-right: 20px;
}

.dots-set {
    display: flex;
    align-items: center;
    gap: 12px;
}

.dot { border-radius: 50%; }

.dot-full {
    width: 20px;
    height: 20px;
    border: 2px solid var(--muni-blue);
    background-color: var(--muni-blue);
}

.dot-outline {
    width: 19px;
    height: 19px;
    border: 3px solid var(--muni-blue);
    background-color: transparent;
}

/* Responzivn√≠ chov√°n√≠ */
@media (max-width: 850px) {
    .title-single-line { font-size: 24pt; }
    .accent-line { max-width: 300px; }
}

@media (max-width: 600px) {
    .header-wide { align-items: center; text-align: center; }
    .title-single-line { white-space: normal; font-size: 20pt; }
    .accent-row { justify-content: center; }
    .accent-line { display: none; }
}

/* Hide the plain header on screen, show only in print/preview */
.print-only-header {
    display: none;
}


/* --- Error messages --- */
/* Kontejner pro bublinu, kter√Ω zaji≈°≈•uje plynul√© vysunut√≠ */
.error-bubble {
    background-color: #fff5f5;  /* Velmi jemn√° ƒçerven√° */
    border-left: 4px solid var(--color-error);
    border-radius: 4px;
    padding: 0 12px;           /* Vertik√°ln√≠ padding animujeme p≈ôes max-height */
    margin-top: -15px;         /* Kompenzace marginu pod inputem */
    margin-bottom: 20px;
    color: var(--color-error);
    font-size: 13px;
    font-weight: 500;
    line-height: 1.4;
    
    /* Animaƒçn√≠ vlastnosti */
    overflow: hidden;
    max-height: 0;
    opacity: 0;
    transition: all 0.3s ease-in-out;
    box-shadow: 0 2px 5px rgba(176, 42, 55, 0.1);
}

/* T≈ô√≠da pro aktivn√≠ zobrazen√≠ bubliny */
.error-bubble.is-visible {
    max-height: 100px;         /* Dostateƒçn√° rezerva pro v√≠ce≈ô√°dkov√Ω text */
    opacity: 1;
    padding: 10px 12px;
    margin-top: -10px;         /* Mezera pod inputem v aktivn√≠m stavu */
}

/* ƒåerven√© ohraniƒçen√≠ pro samotn√Ω input */
input.input-error {
    border-color: var(--color-error) !important;
}

/* Vypnuto pro tisk a preview */
@media print {
    .error-bubble {
        display: none !important;
    }
}

.print-preview .error-bubble {
  display: none;
}

/* Placeholdery */
    /* 1. Pro fyzick√Ω tisk (vyvolan√Ω p≈ôes Ctrl+P) */
    @media print {
        input::placeholder,
        textarea::placeholder {
            color: transparent !important;
            -webkit-text-fill-color: transparent !important;
            opacity: 0 !important;
        }
    }

    /* 2. Pro n√°hled na obrazovce (p≈ôidan√° t≈ô√≠da do HTML/Body) */
    .preview-mode-active input::placeholder,
    .preview-mode-active textarea::placeholder {
        color: transparent !important;
        -webkit-text-fill-color: transparent !important;
        opacity: 0 !important;
    }

/* --- SEGMENTOVAN√ù PROGRESS BAR --- */
#progress-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 18px; /* M√≠rnƒõ vy≈°≈°√≠ pro lep≈°√≠ manipulaci */
    background: rgba(255, 255, 255, 0.9); /* Polopr≈Øhledn√° b√≠l√° */
    z-index: 10000;
    
    /* Vrstven√Ω st√≠n: prvn√≠ je jemn√Ω a ≈°irok√Ω, druh√Ω je ost≈ôej≈°√≠ pro definici hrany */
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.08), 
        0 1px 2px rgba(0, 0, 0, 0.05),
        inset 0 -1px 0 rgba(0, 0, 220, 0.1); /* Velmi jemn√° linka v MUNI modr√© na spodn√≠ hranƒõ */

    /* Sklenƒõn√Ω efekt (rozost≈ô√≠ obsah pod barem) */
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);

    display: flex;
    flex-direction: column;
    justify-content: center;
    
    /* Animace zobrazen√≠ */
    opacity: 0;
    transform: translateY(-100%);
    transition: opacity 0.4s cubic-bezier(0.165, 0.84, 0.44, 1), 
                transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
    pointer-events: none;
}

/* T≈ô√≠da, kterou p≈ôid√°me pomoc√≠ JS p≈ôi scrollu */
#progress-container.is-visible {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
}

#segmented-wrapper {
    display: flex;
    gap: 4px;
    padding: 0 10px;
    width: 100%;
    box-sizing: border-box;
}

.progress-segment {
    flex: 1;
    height: 8px;
    background: #e0e0e0;
    border-radius: 2px;
    overflow: hidden;
    position: relative;
    transition: transform 0.2s ease;
}

.segment-fill {
    height: 100%;
    width: 0%;
    background: var(--muni-blue);
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.3s;
}

/* Zelen√° barva pro dokonƒçen√Ω segment */
.progress-segment.completed .segment-fill {
    background: var(--color-success);
}

/* Skryt√≠ progress baru p≈ôi tisku */
@media print {
    #progress-container { display: none !important; }
}
     
  .preview-mode-active #progress-container {
        display: none !important;
    }
    


/* --- SOUHRNN√ù PANEL (SUMMARY) --- */
.summary-container {
    background-color: #fff;
    border: 1px solid #ccc;
    border-left: 3px solid #0000dc; /* MUNI Modr√° */
    border-radius: 8px;
    margin: 40px 0 30px 0;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    overflow: hidden;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.summary-header {
    padding: 15px 20px;
    background-color: #f8f9fa;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.2s;
    flex-wrap: wrap;
    gap: 15px;
}
.summary-header:hover { background-color: #e9f1ff; }

.summary-stats { 
    display: flex; 
    gap: 30px; 
    flex-wrap: wrap; 
}

.stat-item { 
    text-align: center; 
    min-width: 80px; 
}

.stat-value { 
    display: block; 
    font-weight: 800; 
    font-size: 20px; 
    line-height: 1.2; 
}

.stat-label { 
    font-size: 11px; 
    text-transform: uppercase; 
    color: #666; 
    letter-spacing: 0.5px; 
    font-weight: 600; 
    white-space: nowrap; 
}

/* Barvy statistik */
.stat-answered .stat-value { color: var(--color-success); } /* Zelen√° */
.stat-empty .stat-value { color: var(--color-error); }    /* ƒåerven√° */
.stat-refused .stat-value { color: var(--color-warning-accent); }  /* Oran≈æov√°/Hnƒõd√° */

.toggle-icon { 
    font-size: 13px; 
    color: #0000dc; 
    font-weight: 600; 
    display: flex; 
    align-items: center; 
    gap: 6px; 
    margin-left: auto;
}

/* Detaily (rozbalovac√≠ ƒç√°st) */
.summary-details {
    max-height: 0;
    overflow: hidden; /* Zru≈°en scrollbar pro plynulost */
    transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    background-color: #fff;
    opacity: 0.5;
}

.summary-details.is-open { 
    max-height: 3000px; /* Dostateƒçn√° v√Ω≈°ka pro obsah */
    border-top: 1px solid #eee; 
    opacity: 1;
    transition: max-height 0.6s ease-in-out, opacity 0.4s ease-in;
}

.summary-list { list-style: none; padding: 0; margin: 0; }

.summary-list-item {
    padding: 12px 20px;
    border-bottom: 1px solid #f0f0f0;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 8px;
    transition: background-color 0.2s;
}
.summary-list-item:hover { background-color: #f4f8ff; }

.item-info { 
    display: flex; 
    flex-direction: column; 
    flex: 1; 
    min-width: 200px;
}

.item-section { font-size: 10px; text-transform: uppercase; color: #999; font-weight: 700; margin-bottom: 2px; }
.item-question { font-size: 14px; font-weight: 500; color: #333; }

.item-status { 
    font-size: 11px; 
    padding: 4px 8px; 
    border-radius: 4px; 
    font-weight: 600; 
    text-transform: uppercase; 
    white-space: nowrap; 
    flex-shrink: 0;
}
.item-status.empty { background: #ffebeb; color: var(--color-error); border: 1px solid #fadbd8; }
.item-status.refused { background: var(--color-warning-bg); color: var(--color-warning); border: 1px solid var(--color-warning-border); }


/* Skryt√≠ p≈ôi tisku */
@media print { .summary-container { display: none !important; } }

  .preview-mode-active #summary-container {
        display: none !important;
    }

/* Mobiln√≠ √∫prava */
@media (max-width: 600px) {
    .summary-stats { gap: 15px; justify-content: space-between; width: 100%; }
    .stat-item { min-width: auto; flex: 1; }
    .stat-value { font-size: 18px; }
    .stat-label { font-size: 10px; }
    .toggle-icon { width: 100%; justify-content: center; margin-top: 5px; padding-top: 5px; border-top: 1px solid #eee; }
}




/* --- PULZN√ç VƒåELKA --- */

/* Odstranƒõn√≠ o≈ôezu u bloku i u nad≈ôazen√©ho fieldsetu */
.qa-block.highlighted-dot,
.allow-overflow {
    overflow: visible !important;
}

.qa-block.highlighted-dot .unanswered-dot {
    background-color: var(--color-warning-accent) !important;
    border-color: var(--color-warning-accent) !important;
    opacity: 1 !important;
    position: relative;
    z-index: 1000; /* Vystoup√≠ nad v≈°e ostatn√≠ */
    /* Animace p≈ôesnƒõ podle va≈°eho n√°vrhu: 2s, jemn√Ω puls */
    animation: orange-pulse 3.5s ease-in-out forwards;
}

@keyframes orange-pulse {
    /* PRVN√ç PULS */
    0%   { transform: scale(1);   box-shadow: 0 0 0 0 rgba(230, 81, 0, 0.7); }
    25%  { transform: scale(1.25); box-shadow: 0 0 0 15px rgba(230, 81, 0, 0); }
    50%  { transform: scale(1);   box-shadow: 0 0 0 0 rgba(230, 81, 0, 0); } /* √öpln√Ω reset st√≠nu */

    /* KR√ÅTK√Å PAUZA (BEAT) */
    55%  { transform: scale(1);   box-shadow: 0 0 0 0 rgba(230, 81, 0, 0.7); }

    /* DRUH√ù PULS */
    80%  { transform: scale(1.25); box-shadow: 0 0 0 15px rgba(230, 81, 0, 0); }
    100% { transform: scale(1);   box-shadow: 0 0 0 0 rgba(230, 81, 0, 0); }
}



/* --- INTEGROVAN√ù SYST√âM DIALOG≈Æ --- */
#custom-confirm {
    border: none;
    border-radius: 10px;
    padding: 0;
    max-width: 450px;
    width: 90%;
    box-shadow: 0 15px 50px rgba(0,0,0,0.2);
    outline: none;
}

#custom-confirm::backdrop {
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
}

/* VARIANTA 3: ƒåERVEN√Å (Kritick√© smaz√°n√≠) */
#custom-confirm.type-delete {
    background-color: #ffffff;    /* B√≠l√© pozad√≠ dle p≈ô√°n√≠ */
    border-left: 4px solid var(--color-error); /* ƒåerven√Ω pruh */
}
#custom-confirm.type-delete h3 { 
    color: var(--color-error); /* ƒåerven√Ω nadpis */
}

/* Varianta ORAN≈ΩOV√Å (Smaz√°n√≠ / Varov√°n√≠) */
#custom-confirm.type-warning {
    background-color: #ffffff;
    border-left: 4px solid var(--color-warning-accent);
}
#custom-confirm.type-warning h3 { color: var(--color-warning); }

/* Varianta MODR√Å (Ulo≈æen√≠ / Info) */
#custom-confirm.type-success, 
#custom-confirm.type-info {
    background-color: #ffffff;
    border-left: 4px solid #0000dc;
}
#custom-confirm.type-success h3,
#custom-confirm.type-info h3 { color: #0000dc; }

.dialog-inner { padding: 30px; }
.dialog-inner h3 { margin: 0 0 10px 0; font-size: 20px; font-weight: 700; }
.dialog-inner p { color: #333; line-height: 1.6; margin-bottom: 30px; font-size: 15px; }
.dialog-buttons { display: flex; gap: 12px; justify-content: flex-end; }

#custom-confirm[open] {
    animation: dialog-appear 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes dialog-appear {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
}



</style>
</head>
<body>

<div id="progress-container">
    <div id="segmented-wrapper">
        </div>
</div>
<main>
<form id="questionnaire">

  <div class="survey-utility-header">
    <div class="header-inner">
        <div class="header-left">
                  Verze 1.0 beta | <a href="https://diagnostikaditete.cz/" target="_blank" class="header-link feedback-link">diagnostikaditete.cz</a>
        </div>
        <div class="header-right">
          <a href="manual.pdf" target="_blank" class="header-link">
                <span class="icon">üìñ</span> Metodick√Ω manu√°l
            </a>
            <a href="https://forms.gle/EpxAt2FqTxr5nCu1A" target="_blank" class="header-link feedback-link">
                <span class="icon">üí¨</span> Zpƒõtn√° vazba
            </a>
        </div>
    </div>
</div>


<header class="header-wide">
    <h1 class="title-single-line">ANAMNESTICK√ù DOTAZN√çK</h1>
    <h2 class="subtitle-wide">PRO DIAGNOSTIKU D√çTƒöTE</h2>

    <div class="accent-row">
        <div class="accent-line"></div>
        <div class="dots-set">
            <div class="dot dot-full"></div>
            <div class="dot dot-full"></div>
            <div class="dot dot-outline"></div>
        </div>
    </div>
</header>

  <h1 class="print-only-header">Anamnestick√Ω dotazn√≠k</h1>

  <div class="instruction-block">
    <p>Je mo≈æn√©, ≈æe v√°s nƒõkter√Ω ze specialist≈Ø peƒçuj√≠c√≠ch o va≈°e d√≠tƒõ po≈æ√°dal o poskytnut√≠ anamnestick√Ωch informac√≠. Tento dotazn√≠k v√°s provede ot√°zkami zamƒõ≈ôen√Ωmi na r≈Øzn√© oblasti ≈æivota va≈°eho d√≠tƒõte. Anamn√©za by mƒõla b√Ωt d≈Økladn√°, aby specialist≈Øm umo≈ænila vytvo≈ôit ucelen√Ω obraz o va≈°em d√≠tƒõti a p≈ôesnƒõ zac√≠lit n√°slednou pomoc a doporuƒçen√≠. Sna≈æte se proto odpov√≠dat up≈ô√≠mnƒõ a u otev≈ôen√Ωch odpovƒõd√≠ poskytovat dostateƒçn√© detaily. U nƒõkter√Ωch ot√°zek v≈°ak staƒç√≠ i nƒõkolik slov nebo jedna vƒõta ‚Äì je to na va≈°em uv√°≈æen√≠.</p>
    <ul>
      <li>Dotazn√≠k nen√≠ kr√°tk√Ω a k pohodlnƒõj≈°√≠mu vypl≈àov√°n√≠ tedy doporuƒçujeme pou≈æ√≠t poƒç√≠taƒç/laptop.</li>
      <li>Bƒõhem vypl≈àov√°n√≠ se budou na z√°kladƒõ va≈°ich odpovƒõd√≠ rozbalovat dopl≈àuj√≠c√≠ ot√°zky.</li>
      <li>Pro snadnƒõj≈°√≠ navigaci jsou nezodpovƒõzen√© ot√°zky oznaƒçeny modrou teƒçkou.</li>
      <li>Li≈°ta naho≈ôe bude ukazovat v√°≈° postup v sekc√≠ch dotazn√≠ku; zelen√° barva znaƒç√≠ kompletnƒõ dokonƒçenou ƒç√°st.</li>
      <li>Pokud si p≈ôejete polo≈æku nezodpov√≠dat, vyberte mo≈ænost <em>‚ÄúBez odpovƒõdi‚Äù</em> nebo nechte pole pr√°zdn√©.</li>
    </ul>

    <p>Data, kter√° budete zad√°vat, mohou b√Ωt citliv√© povahy. Tento dotazn√≠k nikdy neodes√≠l√° data mimo va≈°e za≈ô√≠zen√≠. Pro jistotu jsou va≈°e odpovƒõdi automaticky ukl√°d√°ny lok√°lnƒõ ve va≈°em prohl√≠≈æeƒçi (umo≈æ≈àuje obnovu v p≈ô√≠padƒõ zav≈ôen√≠ dotazn√≠ku apod.). Dosavadn√≠ pr≈Øchod tak√© m≈Ø≈æete ulo≈æit tlaƒç√≠tkem <strong>Pr≈Øbƒõ≈ænƒõ ulo≈æit</strong> nebo si st√°hnƒõte soubor se sv√Ωmi odpovƒõƒèmi (tlaƒç√≠tko <strong>Ulo≈æit do souboru</strong>). Obƒõ mo≈ænosti naleznete na konci dotazn√≠ku.</p>

    <p>V√°mi ulo≈æen√Ω soubor s odpovƒõƒèmi naƒçtete tlaƒç√≠tkem <strong>Naƒç√≠st ze souboru</strong>. Pokud existuje pr≈Øbƒõ≈ænƒõ ulo≈æen√Ω pr≈Øchod, obnov√≠te jej kliknut√≠m na tlaƒç√≠tko <strong>Naƒç√≠st posledn√≠ pr≈Øchod</strong>.</p>


    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; margin-top: 10px;">
      <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <button type="button" class="btn btn-secondary" onclick="document.getElementById('json-file-input').click()">Naƒç√≠st ze souboru</button>
        <button type="button" class="btn btn-secondary" id="load-from-storage-btn" onclick="loadForm()">Naƒç√≠st posledn√≠ pr≈Øchod</button>
      </div>
      <div style="text-align: right; margin-left: auto;">
        <button type="button" class="btn-delete-link" onclick="clearHistory()">Smazat aktu√°ln√≠ pr≈Øchod a historii</button>
      </div>
    </div>
  </div>


  <!-- Z√°kladn√≠ √∫daje -->
<fieldset>
  <legend>Z√°kladn√≠ √∫daje</legend>

  <div class="qa-block">
    <label for="child_name"><span>Jm√©no d√≠tƒõte:</span></label>
    <input class="short-text" type="text" name="child_name" id="child_name">
  </div>

  <div class="qa-block">
    <label for="child_preferred_name"><span>Jak si d√≠tƒõ p≈ôeje b√Ωt oslovov√°no:</span></label>
    <input class="short-text" type="text" name="child_preferred_name" id="child_preferred_name">
  </div>
  <div class="qa-block">
    <label for="child_birthdate"><span>Datum narozen√≠ d√≠tƒõte:</span></label>
    <input type="date" name="child_birthdate" id="child_birthdate">
  </div>

  <div class="qa-block">
    <label for="child_age"><span>Vƒõk:</span></label>
    <input type="text" name="child_age" id="child_age" readonly style="cursor:default; pointer-events: none;" placeholder="Dopoƒç√≠t√° se z data narozen√≠">
  </div>
</fieldset>

<fieldset>
  <legend>Zdravotn√≠ anamn√©za</legend>

    <div class="tip-block tip-block-under">
    Zdravotn√≠ stav d√≠tƒõte do znaƒçn√© m√≠ry urƒçuje, jakou m√° kapacitu soust≈ôedit se, uƒçit se, zvl√°dat bƒõ≈æn√Ω den ve ≈°kole i doma a regulovat svoje chov√°n√≠. ≈òada obt√≠≈æ√≠, se kter√Ωmi se ve ≈°koln√≠m prost≈ôed√≠ m≈Ø≈æe d√≠tƒõ pot√Ωkat (nesoust≈ôedƒõnost, pomal√© tempo, vyru≈°ov√°n√≠, emoƒçn√≠ v√Ωbuchy), m≈Ø≈æe b√Ωt ovlivnƒõna tak√© t√≠m, jak vid√≠ a sly≈°√≠, ale tak√© chronick√Ωmi nemocemi nebo bolestmi.    
    </div>

  <div class="qa-block">
    <label id="lbl_neurolog_exam"><span>Bylo d√≠tƒõ nƒõkdy vy≈°et≈ôeno neurologem, psychiatrem nebo klinick√Ωm psychologem?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_neurolog_exam">
      <label><input type="radio" name="neurolog_exam" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="neurolog_exam" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="neurolog_exam" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_neurolog_exam_detail" data-controlled-by="neurolog_exam">
    <label for="diagnoses"><span>Jak√© diagn√≥zy stanovil/i:</span></label>
    <textarea class="long-text" name="diagnoses" id="diagnoses"></textarea>
  </div>
  <div class="qa-block">
    <label id="lbl_chronic_illnesses_status"><span>Trp√≠ d√≠tƒõ nƒõkter√Ωmi chronick√Ωmi onemocnƒõn√≠mi?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_chronic_illnesses_status">
      <label><input type="radio" name="chronic_illnesses_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="chronic_illnesses_status" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="chronic_illnesses_status" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_chronic_illnesses_detail" data-controlled-by="chronic_illnesses_status">
    <label for="chronic_illnesses_detail"><span>Jak√Ωmi chronick√Ωmi onemocnƒõn√≠mi?</span></label>
    <textarea class="long-text" name="chronic_illnesses_detail" id="chronic_illnesses_detail"></textarea>
  </div>
  <div class="qa-block">
    <label id="lbl_past_health_issues_status"><span>Prodƒõlalo d√≠tƒõ v minulosti nƒõjak√© v√°≈æn√© zdravotn√≠ komplikace (hospitalizace, chirurgick√Ω z√°krok, apod.)?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_past_health_issues_status">
      <label><input type="radio" name="past_health_issues_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="past_health_issues_status" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="past_health_issues_status" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_past_health_issues_detail" data-controlled-by="past_health_issues_status">
    <label for="past_health_issues_detail"><span>Jak√© zdravotn√≠ komplikace to byly?</span></label>
    <textarea class="long-text" name="past_health_issues_detail" id="past_health_issues_detail"></textarea>
  </div>
  <div class="qa-block">
    <label id="lbl_vision_exam"><span>Byl d√≠tƒõti nƒõkdy vy≈°et≈ôen zrak?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_vision_exam">
      <label><input type="radio" name="vision_exam" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="vision_exam" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="vision_exam" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label id="lbl_vision_issues"><span>M√° d√≠tƒõ se zrakem nƒõjak√© obt√≠≈æe?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_vision_issues">
      <label><input type="radio" name="vision_issues" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="vision_issues" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="vision_issues" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_vision_issues_detail" data-controlled-by="vision_issues">
    <label id="lbl_vision_devices"><span>D√≠tƒõ:</span></label>
    <div class="select-group" role="group" aria-labelledby="lbl_vision_devices">
      <label><input type="checkbox" name="vision_devices_glasses"><span>Nos√≠ br√Ωle</span></label>
      <label><input type="checkbox" name="vision_devices_contacts"><span>Nos√≠ kontaktn√≠ ƒçoƒçky</span></label>
      <label><input type="checkbox" name="vision_devices_occluder"><span>Pou≈æ√≠v√° okluzory</span></label>
      <label><input type="checkbox" name="vision_devices_surgery"><span>Podstoupilo operaci oƒç√≠</span></label>
      <label><input type="checkbox" name="vision_devices_other"><span>M√° jin√Ω probl√©m</span></label>
    </div>
  </div>

  <div class="qa-block">
    <label id="lbl_hearing_exam"><span>Byl d√≠tƒõti nƒõkdy vy≈°et≈ôen sluch (nap≈ô√≠klad na ORL)?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_hearing_exam">
      <label><input type="radio" name="hearing_exam" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="hearing_exam" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="hearing_exam" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label id="lbl_hearing_issues"><span>M√° d√≠tƒõ se sluchem nƒõjak√© dlouhodob√© obt√≠≈æe?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_hearing_issues">
      <label><input type="radio" name="hearing_issues" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="hearing_issues" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="hearing_issues" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_hearing_issues_detail" data-controlled-by="hearing_issues">
    <label for="hearing_issues_detail"><span>Jak√© sluchov√© obt√≠≈æe to jsou?</span></label>
    <textarea class="long-text" name="hearing_issues_detail" id="hearing_issues_detail"></textarea>
  </div>

  <div class="qa-block">
    <label id="lbl_speech_therapist_visit"><span>Doch√°z√≠ nebo doch√°zelo d√≠tƒõ k logopedovi?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_speech_therapist_visit">
      <label><input type="radio" name="speech_therapist_visit" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="speech_therapist_visit" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="speech_therapist_visit" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label id="lbl_speech_difficulties"><span>Doch√°z√≠ u d√≠tƒõte k ≈ôeƒçov√Ωm obt√≠≈æ√≠m?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_speech_difficulties">
      <label><input type="radio" name="speech_difficulties" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="speech_difficulties" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="speech_difficulties" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

</fieldset>

<fieldset>
  <legend>Rodinn√° anamn√©za</legend>

    <div class="tip-block tip-block-under">
    V rodinn√©m prost≈ôed√≠ d√≠tƒõ tr√°v√≠ velkou ƒç√°st, ƒçasto i vƒõt≈°inu sv√©ho ƒçasu. Rodina tak do znaƒçn√© m√≠ry urƒçuje, jak m√° nastaven√© denn√≠ re≈æimy, pravidla, i jak√© m√≠≈ôe z√°tƒõ≈æe je dlouhodobƒõ vystaveno.
    </div>

  <div class="qa-block">
    <label id="lbl_respondent_relation"><span>V jak√©m vztahu jste k d√≠tƒõti vy?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_respondent_relation">
      <label><input type="radio" name="respondent_relation" value="Biologick√Ω rodiƒç"><span>Biologick√Ω rodiƒç</span></label>
      <label><input type="radio" name="respondent_relation" value="Vychov√°vaj√≠c√≠ rodiƒç"><span>Vychov√°vaj√≠c√≠ rodiƒç</span></label>
      <label><input type="radio" name="respondent_relation" value="Jin√Ω vztah"><span>Jin√Ω vztah</span></label>
      <label><input type="radio" name="respondent_relation" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>



  <!-- Bio parent -->

  <div class="qa-block qa-group hidden" id="group_bio_parents_combined" data-controlled-by="respondent_relation" data-trigger-value="Biologick√Ω rodiƒç">


  <fieldset>
    <legend>√ödaje o V√°s</legend>

  <div class="qa-block">
    <label for="bio_p1_age"><span>V√°≈° vƒõk:</span></label>
    <input type="number" name="bio_p1_age" id="bio_p1_age">
  </div>

  <div class="qa-block">
    <label id="lbl_bio_p1_job_status"><span>Jste zamƒõstnan√Ω/√°?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_bio_p1_job_status">
      <label><input type="radio" name="bio_p1_job_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="bio_p1_job_status" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="bio_p1_job_status" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_bio_p1_job_detail" data-controlled-by="bio_p1_job_status" data-trigger-value="Ano">
    <label for="bio_p1_job_text"><span>Jak√© je va≈°e zamƒõstn√°n√≠?</span></label>
    <input class="short-text" type="text" name="bio_p1_job_text" id="bio_p1_job_text">
  </div>

  <div class="qa-block">
    <label id="lbl_bio_p1_mental"><span>M√°te nƒõjak√© du≈°evn√≠ obt√≠≈æe?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_bio_p1_mental">
      <label><input type="radio" name="bio_p1_mental" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="bio_p1_mental" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="bio_p1_mental" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_bio_p1_mental_detail" data-controlled-by="bio_p1_mental" data-trigger-value="Ano">
    <label for="bio_p1_mental_text"><span>Jak√© du≈°evn√≠ obt√≠≈æe to jsou?</span></label>
    <textarea class="long-text" name="bio_p1_mental_text" id="bio_p1_mental_text"></textarea>
  </div>

  <div class="qa-block">
    <label id="lbl_bio_p1_physical"><span>M√°te nƒõjak√° fyzick√° omezen√≠ (nap≈ô. nemoci, hendikep)?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_bio_p1_physical">
      <label><input type="radio" name="bio_p1_physical" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="bio_p1_physical" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="bio_p1_physical" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_bio_p1_physical_detail" data-controlled-by="bio_p1_physical" data-trigger-value="Ano">
    <label for="bio_p1_physical_text"><span>Jak√° fyzick√° omezen√≠ to jsou?</span></label>
    <textarea class="long-text" name="bio_p1_physical_text" id="bio_p1_physical_text"></textarea>
  </div>

  </fieldset>


  <fieldset>
    <legend>Druh√Ω biologick√Ω rodiƒç</legend>

    <div class="qa-block">
      <label for="bio_p2_age"><span>Vƒõk:</span></label>
      <input type="number" name="bio_p2_age" id="bio_p2_age">
    </div>

    <div class="qa-block">
      <label id="lbl_bio_p2_carer"><span>Je z√°rove≈à vychov√°vaj√≠c√≠m rodiƒçem?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_bio_p2_carer">
        <label><input type="radio" name="bio_p2_carer" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="bio_p2_carer" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="bio_p2_carer" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_bio_p2_mental"><span>M√°/mƒõl(a) nƒõjak√© du≈°evn√≠ obt√≠≈æe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_bio_p2_mental">
        <label><input type="radio" name="bio_p2_mental" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="bio_p2_mental" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="bio_p2_mental" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_bio_p2_mental_detail" data-controlled-by="bio_p2_mental" data-trigger-value="Ano">
      <label for="bio_p2_mental_text"><span>Jak√© du≈°evn√≠ obt√≠≈æe to jsou/byla?</span></label>
      <textarea class="long-text" name="bio_p2_mental_text" id="bio_p2_mental_text"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_bio_p2_physical"><span>M√°/mƒõl(a) nƒõjak√° fyzick√° omezen√≠ (nap≈ô. nemoci, hendikep)?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_bio_p2_physical">
        <label><input type="radio" name="bio_p2_physical" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="bio_p2_physical" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="bio_p2_physical" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_bio_p2_physical_detail" data-controlled-by="bio_p2_physical" data-trigger-value="Ano">
      <label for="bio_p2_physical_text"><span>Jak√° fyzick√° omezen√≠ to jsou/byla?</span></label>
      <textarea class="long-text" name="bio_p2_physical_text" id="bio_p2_physical_text"></textarea>
    </div>
  </fieldset>

</div>
<!-- End of bio parent -->


<!-- Step Parent -->

<div class="qa-block qa-group hidden" id="group_stepparent_combined" data-controlled-by="respondent_relation" data-trigger-value="Nevlastn√≠ rodiƒç">

  <fieldset>
    <legend>√ödaje o V√°s</legend>

    <div class="qa-block">
      <label for="step_resp_age"><span>V√°≈° vƒõk:</span></label>
      <input type="number" name="step_resp_age" id="step_resp_age">
    </div>

    <div class="qa-block">
      <label id="lbl_step_resp_job_status"><span>Jste zamƒõstnan√Ω/√°?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_step_resp_job_status">
        <label><input type="radio" name="step_resp_job_status" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="step_resp_job_status" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="step_resp_job_status" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_step_resp_job_detail" data-controlled-by="step_resp_job_status" data-trigger-value="Ano">
      <label for="step_resp_job_text"><span>Jak√© je va≈°e zamƒõstn√°n√≠?</span></label>
      <input class="short-text" type="text" name="step_resp_job_text" id="step_resp_job_text">
    </div>

    <div class="qa-block">
      <label id="lbl_step_resp_mental"><span>M√°te nƒõjak√© du≈°evn√≠ obt√≠≈æe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_step_resp_mental">
        <label><input type="radio" name="step_resp_mental" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="step_resp_mental" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="step_resp_mental" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_step_resp_mental_detail" data-controlled-by="step_resp_mental" data-trigger-value="Ano">
      <label for="step_resp_mental_text"><span>Jak√© du≈°evn√≠ obt√≠≈æe to jsou?</span></label>
      <textarea class="long-text" name="step_resp_mental_text" id="step_resp_mental_text"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_step_resp_physical"><span>M√°te nƒõjak√° fyzick√° omezen√≠ (nap≈ô. nemoci, hendikep)?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_step_resp_physical">
        <label><input type="radio" name="step_resp_physical" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="step_resp_physical" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="step_resp_physical" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_step_resp_physical_detail" data-controlled-by="step_resp_physical" data-trigger-value="Ano">
      <label for="step_resp_physical_text"><span>Jak√° fyzick√° omezen√≠ to jsou?</span></label>
      <textarea class="long-text" name="step_resp_physical_text" id="step_resp_physical_text"></textarea>
    </div>
  </fieldset>


  <fieldset>
    <legend>Biologick√° matka</legend>

    <div class="qa-block">
      <label for="step_bio_m_age"><span>Vƒõk:</span></label>
      <input type="number" name="step_bio_m_age" id="step_bio_m_age">
    </div>

    <div class="qa-block">
      <label id="lbl_step_bio_m_carer"><span>Je z√°rove≈à vychov√°vaj√≠c√≠m rodiƒçem?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_step_bio_m_carer">
        <label><input type="radio" name="step_bio_m_carer" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="step_bio_m_carer" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="step_bio_m_carer" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_step_bio_m_mental"><span>M√°/mƒõla nƒõjak√© du≈°evn√≠ obt√≠≈æe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_step_bio_m_mental">
        <label><input type="radio" name="step_bio_m_mental" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="step_bio_m_mental" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="step_bio_m_mental" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_step_bio_m_mental_detail" data-controlled-by="step_bio_m_mental" data-trigger-value="Ano">
      <label for="step_bio_m_mental_text"><span>Jak√© du≈°evn√≠ obt√≠≈æe to jsou/byly?</span></label>
      <textarea class="long-text" name="step_bio_m_mental_text" id="step_bio_m_mental_text"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_step_bio_m_physical"><span>M√°/mƒõla nƒõjak√° fyzick√° omezen√≠ (nap≈ô. nemoci, hendikep)?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_step_bio_m_physical">
        <label><input type="radio" name="step_bio_m_physical" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="step_bio_m_physical" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="step_bio_m_physical" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_step_bio_m_physical_detail" data-controlled-by="step_bio_m_physical" data-trigger-value="Ano">
      <label for="step_bio_m_physical_text"><span>Jak√° fyzick√° omezen√≠ to jsou/byla?</span></label>
      <textarea class="long-text" name="step_bio_m_physical_text" id="step_bio_m_physical_text"></textarea>
    </div>
  </fieldset>


  <fieldset>
    <legend>Biologick√Ω otec</legend>

    <div class="qa-block">
      <label for="step_bio_f_age"><span>Vƒõk:</span></label>
      <input type="number" name="step_bio_f_age" id="step_bio_f_age">
    </div>

    <div class="qa-block">
      <label id="lbl_step_bio_f_carer"><span>Je z√°rove≈à vychov√°vaj√≠c√≠m rodiƒçem?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_step_bio_f_carer">
        <label><input type="radio" name="step_bio_f_carer" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="step_bio_f_carer" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="step_bio_f_carer" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_step_bio_f_mental"><span>M√°/mƒõl nƒõjak√© du≈°evn√≠ obt√≠≈æe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_step_bio_f_mental">
        <label><input type="radio" name="step_bio_f_mental" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="step_bio_f_mental" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="step_bio_f_mental" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_step_bio_f_mental_detail" data-controlled-by="step_bio_f_mental" data-trigger-value="Ano">
      <label for="step_bio_f_mental_text"><span>Jak√© du≈°evn√≠ obt√≠≈æe to jsou/byly?</span></label>
      <textarea class="long-text" name="step_bio_f_mental_text" id="step_bio_f_mental_text"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_step_bio_f_physical"><span>M√°/mƒõl nƒõjak√° fyzick√° omezen√≠ (nap≈ô. nemoci, hendikep)?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_step_bio_f_physical">
        <label><input type="radio" name="step_bio_f_physical" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="step_bio_f_physical" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="step_bio_f_physical" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_step_bio_f_physical_detail" data-controlled-by="step_bio_f_physical" data-trigger-value="Ano">
      <label for="step_bio_f_physical_text"><span>Jak√° fyzick√° omezen√≠ to jsou/byla?</span></label>
      <textarea class="long-text" name="step_bio_f_physical_text" id="step_bio_f_physical_text"></textarea>
    </div>
  </fieldset>

</div>

<!-- End of step parent -->
 
<!-- Other relationship -->

<div class="qa-block qa-group hidden" id="group_other_combined" data-controlled-by="respondent_relation" data-trigger-value="Jin√Ω vztah">

  <fieldset>
    <legend>√ödaje o V√°s</legend>

    <div class="qa-block">
      <label for="other_resp_relation_spec"><span>Jak√Ω je v√°≈° vztah k d√≠tƒõti?</span></label>
      <input class="short-text" type="text" name="other_resp_relation_spec" id="other_resp_relation_spec">
    </div>

    <div class="qa-block">
      <label for="other_resp_age"><span>V√°≈° vƒõk:</span></label>
      <input type="number" name="other_resp_age" id="other_resp_age">
    </div>

    <div class="qa-block">
      <label id="lbl_other_resp_job_status"><span>Jste zamƒõstnan√Ω/√°?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_resp_job_status">
        <label><input type="radio" name="other_resp_job_status" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="other_resp_job_status" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="other_resp_job_status" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_other_resp_job_detail" data-controlled-by="other_resp_job_status" data-trigger-value="Ano">
      <label for="other_resp_job_text"><span>Jak√© je va≈°e zamƒõstn√°n√≠?</span></label>
      <input class="short-text" type="text" name="other_resp_job_text" id="other_resp_job_text">
    </div>

    <div class="qa-block">
      <label id="lbl_other_resp_mental"><span>M√°te nƒõjak√© du≈°evn√≠ obt√≠≈æe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_resp_mental">
        <label><input type="radio" name="other_resp_mental" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="other_resp_mental" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="other_resp_mental" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_other_resp_mental_detail" data-controlled-by="other_resp_mental" data-trigger-value="Ano">
      <label for="other_resp_mental_text"><span>Jak√© du≈°evn√≠ obt√≠≈æe to jsou?</span></label>
      <textarea class="long-text" name="other_resp_mental_text" id="other_resp_mental_text"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_other_resp_physical"><span>M√°te nƒõjak√° fyzick√° omezen√≠ (nap≈ô. nemoci, hendikep)?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_resp_physical">
        <label><input type="radio" name="other_resp_physical" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="other_resp_physical" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="other_resp_physical" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_other_resp_physical_detail" data-controlled-by="other_resp_physical" data-trigger-value="Ano">
      <label for="other_resp_physical_text"><span>Jak√° fyzick√° omezen√≠ to jsou?</span></label>
      <textarea class="long-text" name="other_resp_physical_text" id="other_resp_physical_text"></textarea>
    </div>
  </fieldset>


  <fieldset>
    <legend>Biologick√° matka</legend>

    <div class="qa-block">
      <label for="other_bio_m_age"><span>Vƒõk:</span></label>
      <input type="number" name="other_bio_m_age" id="other_bio_m_age">
    </div>

    <div class="qa-block">
      <label id="lbl_other_bio_m_carer"><span>Je z√°rove≈à vychov√°vaj√≠c√≠m rodiƒçem?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_bio_m_carer">
        <label><input type="radio" name="other_bio_m_carer" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="other_bio_m_carer" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="other_bio_m_carer" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_other_bio_m_mental"><span>M√°/mƒõla nƒõjak√© du≈°evn√≠ obt√≠≈æe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_bio_m_mental">
        <label><input type="radio" name="other_bio_m_mental" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="other_bio_m_mental" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="other_bio_m_mental" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_other_bio_m_mental_detail" data-controlled-by="other_bio_m_mental" data-trigger-value="Ano">
      <label for="other_bio_m_mental_text"><span>Jak√© du≈°evn√≠ obt√≠≈æe to jsou/byly?</span></label>
      <textarea class="long-text" name="other_bio_m_mental_text" id="other_bio_m_mental_text"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_other_bio_m_physical"><span>M√°/mƒõla nƒõjak√° fyzick√° omezen√≠ (nap≈ô. nemoci, hendikep)?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_bio_m_physical">
        <label><input type="radio" name="other_bio_m_physical" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="other_bio_m_physical" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="other_bio_m_physical" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_other_bio_m_physical_detail" data-controlled-by="other_bio_m_physical" data-trigger-value="Ano">
      <label for="other_bio_m_physical_text"><span>Jak√° fyzick√° omezen√≠ to jsou/byla?</span></label>
      <textarea class="long-text" name="other_bio_m_physical_text" id="other_bio_m_physical_text"></textarea>
    </div>
  </fieldset>


  <fieldset>
    <legend>Biologick√Ω otec</legend>

    <div class="qa-block">
      <label for="other_bio_f_age"><span>Vƒõk:</span></label>
      <input type="number" name="other_bio_f_age" id="other_bio_f_age">
    </div>

    <div class="qa-block">
      <label id="lbl_other_bio_f_carer"><span>Je z√°rove≈à vychov√°vaj√≠c√≠m rodiƒçem?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_bio_f_carer">
        <label><input type="radio" name="other_bio_f_carer" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="other_bio_f_carer" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="other_bio_f_carer" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_other_bio_f_mental"><span>M√°/mƒõl nƒõjak√© du≈°evn√≠ obt√≠≈æe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_bio_f_mental">
        <label><input type="radio" name="other_bio_f_mental" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="other_bio_f_mental" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="other_bio_f_mental" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_other_bio_f_mental_detail" data-controlled-by="other_bio_f_mental" data-trigger-value="Ano">
      <label for="other_bio_f_mental_text"><span>Jak√© du≈°evn√≠ obt√≠≈æe to jsou/byly?</span></label>
      <textarea class="long-text" name="other_bio_f_mental_text" id="other_bio_f_mental_text"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_other_bio_f_physical"><span>M√°/mƒõl nƒõjak√° fyzick√° omezen√≠ (nap≈ô. nemoci, hendikep)?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_bio_f_physical">
        <label><input type="radio" name="other_bio_f_physical" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="other_bio_f_physical" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="other_bio_f_physical" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_other_bio_f_physical_detail" data-controlled-by="other_bio_f_physical" data-trigger-value="Ano">
      <label for="other_bio_f_physical_text"><span>Jak√° fyzick√° omezen√≠ to jsou/byla?</span></label>
      <textarea class="long-text" name="other_bio_f_physical_text" id="other_bio_f_physical_text"></textarea>
    </div>
  </fieldset>

</div>

<!-- End of Other relationship -->

   <div class="qa-block">
    <label id="lbl_other_carer_status"><span>Pod√≠l√≠ se na v√Ωchovƒõ d√≠tƒõte je≈°tƒõ nƒõkdo dal≈°√≠?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_other_carer_status">
      <label><input type="radio" name="other_carer_status" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="other_carer_status" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="other_carer_status" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_other_carer_detail" data-controlled-by="other_carer_status">
    <div id="additional_carers_container"></div>
    <div class="qa-block" style="text-align: center; margin-top: 15px;">
        <button type="button" class="btn btn-secondary btn-add-item" onclick="addCarer()">+ P≈ôidat vychov√°vaj√≠c√≠ osobu</button>
    </div>
  </div>
  <div class="qa-block">
    <label id="lbl_has_siblings"><span>M√° d√≠tƒõ sourozence?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_has_siblings">
      <label><input type="radio" name="has_siblings" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="has_siblings" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="has_siblings" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block hidden" id="q_siblings_detail" data-controlled-by="has_siblings">
    <div id="siblings_container"></div>
    <div class="qa-block" style="text-align: center; margin-top: 15px;">
        <button type="button" class="btn btn-secondary btn-add-item" onclick="addSibling()">+ P≈ôidat sourozence</button>
    </div>
  </div>
</fieldset>


<fieldset>
  <legend>Soci√°ln√≠ anamn√©za</legend>

<div class="tip-block tip-block-under">
 Tato sekce mapuje soci√°ln√≠ prost≈ôed√≠, ve kter√©m d√≠tƒõ ≈æije (zda m√° stabiln√≠ bydlen√≠, vlastn√≠ prostor pro plnƒõn√≠ povinnost√≠ i voln√Ω ƒças), mo≈ænosti peƒçuj√≠c√≠ch osob s d√≠tƒõtem tr√°vit ƒças a jejich spoleƒçn√© z√°liby.
    </div>

  <div class="qa-block">
    <label id="lbl_housing_type"><span>V jak√©m typu bydlen√≠ ≈æijete?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_housing_type">
      <label><input type="radio" name="housing_type" value="D≈Øm"><span>D≈Øm</span></label>
      <label><input type="radio" name="housing_type" value="Byt"><span>Byt</span></label>
      <label><input type="radio" name="housing_type" value="Jin√©"><span>Jin√©</span></label>
      <label><input type="radio" name="housing_type" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
    <div class="qa-block hidden" id="q_housing_specification_detail" data-controlled-by="housing_type" data-trigger-value="Jin√©">
    <label for="housing_specification"><span>M≈Ø≈æete typ bydlen√≠ specifikovat?</span></label>
    <textarea class="long-text" name="housing_specification" id="housing_specification"></textarea>
  </div>
  <div class="qa-block">
    <label for="housing_satisfaction"><span>Jak jste s bydlen√≠m spokojen√≠?</span></label>
    <textarea class="long-text" name="housing_satisfaction" id="housing_satisfaction"></textarea>
  </div>
  <div class="qa-block">
    <label for="household_count"><span>Kolik lid√≠ ≈æije ve va≈°√≠ dom√°cnosti?</span></label>
    <input type="number" name="household_count" id="household_count">
  </div>
  <div class="qa-block">
    <label id="lbl_child_own_room"><span>M√° d√≠tƒõ vlastn√≠ pokoj?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_child_own_room">
      <label><input type="radio" name="child_own_room" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="child_own_room" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="child_own_room" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  <div class="qa-block">
    <label id="lbl_child_own_desk"><span>M√° d√≠tƒõ vlastn√≠ pracovn√≠ st≈Øl?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_child_own_desk">
      <label><input type="radio" name="child_own_desk" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="child_own_desk" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="child_own_desk" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>
  
  <div class="qa-block">
    <label id="lbl_time_with_children"><span>Kolik ƒçasu dennƒõ tr√°v√≠te vy osobnƒõ s d√≠tƒõtem (staƒç√≠ pouh√° p≈ô√≠tomnost doma)?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_time_with_children">
      <label><input type="radio" name="time_with_children" value="Do 2 hodin"><span>Do 2 hodin</span></label>
      <label><input type="radio" name="time_with_children" value="2‚Äì5 hodin"><span>2‚Äì5 hodin</span></label>
      <label><input type="radio" name="time_with_children" value="5‚Äì8 hodin"><span>5‚Äì8 hodin</span></label>
      <label><input type="radio" name="time_with_children" value="8 hodin a v√≠ce"><span>8 hodin a v√≠ce</span></label>
      <label><input type="radio" name="time_with_children" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block">
    <label id="lbl_time_with_child_active"><span>Kolik ƒçasu dennƒõ se d√≠tƒõti vy osobnƒõ p≈ô√≠mo vƒõnujete (hra, spoleƒçn√© ƒçinnosti, rozhovor)?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_time_with_child_active">
      <label><input type="radio" name="time_with_child_active" value="0-30 minut"><span>0-30 minut</span></label>
      <label><input type="radio" name="time_with_child_active" value="30-60 minut"><span>30-60 minut</span></label>
      <label><input type="radio" name="time_with_child_active" value="2-3 hodiny"><span>2-3 hodiny</span></label>
      <label><input type="radio" name="time_with_child_active" value="3 hodiny a v√≠ce"><span>3 hodiny a v√≠ce</span></label>
      <label><input type="radio" name="time_with_child_active" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block">
    <label id="lbl_time_with_child_others"><span>Kolik ƒçasu dennƒõ se d√≠tƒõti p≈ô√≠mo vƒõnuj√≠ dal≈°√≠ osoby (hra, spoleƒçn√© ƒçinnosti, rozhovor)?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_time_with_child_others">
      <label><input type="radio" name="time_with_child_others" value="0-30 minut"><span>0-30 minut</span></label>
      <label><input type="radio" name="time_with_child_others" value="30-60 minut"><span>30-60 minut</span></label>
      <label><input type="radio" name="time_with_child_others" value="2-3 hodiny"><span>2-3 hodiny</span></label>
      <label><input type="radio" name="time_with_child_others" value="3 hodiny a v√≠ce"><span>3 hodiny a v√≠ce</span></label>
      <label><input type="radio" name="time_with_child_others" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  

  <div class="qa-block">
    <label id="lbl_practice_with_child"><span>M√°te prostor s d√≠tƒõtem nƒõco procviƒçovat?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_practice_with_child">
      <label><input type="radio" name="practice_with_child" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="practice_with_child" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="practice_with_child" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block">
    <label for="fav_activity_with_child"><span>Jak√° je va≈°e obl√≠ben√° ƒçinnost s d√≠tƒõtem? (m≈Ø≈æe jich b√Ωt i v√≠ce)</span></label>
    <textarea class="long-text" name="fav_activity_with_child" id="fav_activity_with_child"></textarea>
  </div>

  <div class="qa-block">
    <label for="child_fav_activity"><span>Jak√° je obl√≠ben√° ƒçinnost d√≠tƒõte obecnƒõ?</span></label>
    <textarea class="long-text" name="child_fav_activity" id="child_fav_activity"></textarea>
  </div>

  <div class="qa-block">
    <label for="child_fav_movie"><span>Jestli m√° d√≠tƒõ obl√≠ben√Ω film, jak√Ω to je?</span></label>
    <input type="text" name="child_fav_movie" id="child_fav_movie">
  </div>

  <div class="qa-block">
    <label for="child_fav_book"><span>Jestli m√° d√≠tƒõ obl√≠benou knihu, jak√° to je?</span></label>
    <input type="text" name="child_fav_book" id="child_fav_book">
  </div>

  <div class="qa-block">
      <label id="lbl_child_has_device"><span>M√° d√≠tƒõ p≈ô√≠stup k telefonu nebo tabletu?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_child_has_device">
        <label><input type="radio" name="child_has_device" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="child_has_device" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="child_has_device" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

  <div class="qa-block qa-group hidden" id="q_child_device_details" data-controlled-by="child_has_device">
    <div class="qa-block">
      <label for="child_device_use_relative"><span>Jak moc d√≠tƒõ podle v√°s pou≈æ√≠v√° mobil nebo tablet ve srovn√°n√≠ s vrstevn√≠ky?</span></label>
      <textarea class="long-text" name="child_device_use_relative" id="child_device_use_relative"></textarea>
    </div>
    <div class="qa-block">
      <label for="child_device_usage"><span>Co d√≠tƒõ na telefonu nejƒçastƒõji dƒõl√°? (se≈ôaƒète podle frekvence)</span></label>
      <textarea class="long-text" name="child_device_usage" id="child_device_usage"></textarea>
    </div>
    <div class="qa-block">
      <label for="child_device_control"><span>Pokou≈°√≠te se nƒõjak√Ωm zp≈Øsobem kontrolovat, co d√≠tƒõ na telefonu dƒõl√°? (nap≈ô. v√Ωchovnƒõ nebo omezen√≠m p≈ô√≠mo v telefonu)</span></label>
      <textarea class="long-text" name="child_device_control" id="child_device_control"></textarea>
    </div>
  </div>

  <div class="qa-block">
    <label for="child_device_parenting_theme"><span>Jak moc je pro v√°s pou≈æ√≠v√°n√≠ mobilu ƒçi tabletu t√©matem ve v√Ωchovƒõ?</span></label>
    <textarea class="long-text" name="child_device_parenting_theme" id="child_device_parenting_theme"></textarea>
  </div>
</fieldset>

<fieldset>
  <legend>≈†kolka</legend>
  <div class="qa-block">
    <label id="lbl_attends_kindergarten"><span>Nav≈°tƒõvuje va≈°e d√≠tƒõ ≈°kolku?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_attends_kindergarten">
      <label><input type="radio" name="attends_kindergarten" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="attends_kindergarten" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="attends_kindergarten" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block qa-group hidden" id="q_kindergarten_details" data-controlled-by="attends_kindergarten">

    <div class="tip-block tip-block-under">
Tato sekce mapuje zku≈°enosti d√≠tƒõte s p≈ôed≈°koln√≠m vzdƒõl√°v√°n√≠m - zda a v jak√©m re≈æimu d√≠tƒõ ≈°kolku nav≈°tƒõvuje, jak prob√≠h√° adaptace na prost≈ôed√≠, fungov√°n√≠ v dƒõtsk√©m kolektivu nebo zvl√°d√°n√≠ p≈ôed≈°koln√≠ p≈ô√≠pravy. Ve ≈°kolce m√° d√≠tƒõ mo≈ænost rozv√≠jet soci√°ln√≠ dovednosti, vrstevnick√© vztahy, sebeobsluhu, schopnost fungovat mimo rodinu a tak√© odolnost v≈Øƒçi zmƒõn√°m a z√°tƒõ≈æi.
</div>

    <div class="qa-block">
      <label for="kg_how_many"><span>Do kolika ≈°kolek va≈°e d√≠tƒõ chod√≠?</span></label>
      <input type="number" name="kg_how_many" id="kg_how_many">
    </div>

    <div class="qa-block">
      <label for="kg_days_per_week"><span>Kolik dn√≠ v t√Ωdnu chod√≠ va≈°e d√≠tƒõ do ≈°kolky?</span></label>
      <input type="number" name="kg_days_per_week" id="kg_days_per_week">
    </div>

    <div class="qa-block">
      <label for="kg_afternoons"><span>Kolik z tƒõchto dn≈Ø tr√°v√≠ ve ≈°kolce i odpoledne?</span></label>
      <input type="number" name="kg_afternoons" id="kg_afternoons">
    </div>

    <div class="qa-block">
      <label id="lbl_kg_morning_issues"><span>Kdybyste mƒõl/a zhodnotit, jak prob√≠h√° rann√≠ vypravov√°n√≠ do ≈°kolky ‚Äì m√° s n√≠m d√≠tƒõ nƒõjak√© obt√≠≈æe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_kg_morning_issues">
        <label><input type="radio" name="kg_morning_issues" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_morning_issues" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_morning_issues" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_morning_issues_detail" data-controlled-by="kg_morning_issues">
      <label for="kg_morning_issues_detail"><span>M≈Ø≈æete obt√≠≈æe specifikovat?</span></label>
      <textarea class="long-text" name="kg_morning_issues_detail" id="kg_morning_issues_detail"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_kg_separation_issues"><span>M√° d√≠tƒõ probl√©m se rozlouƒçit p≈ôi odchodu do ≈°kolky?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_kg_separation_issues">
        <label><input type="radio" name="kg_separation_issues" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_separation_issues" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_separation_issues" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label for="kg_after_return_behavior"><span>Kdybyste mƒõl/a zhodnotit, jak d√≠tƒõ funguje (jak se chov√°) po n√°vratu ze ≈°kolky, co byste o nƒõm ≈ôekl/a?</span></label>
      <textarea class="long-text" name="kg_after_return_behavior" id="kg_after_return_behavior"></textarea>
    </div>

    <div class="qa-block">
      <label for="kg_child_rating"><span>Jak d√≠tƒõ hodnot√≠ ≈°kolku?</span></label>
      <textarea class="long-text" name="kg_child_rating" id="kg_child_rating"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_kg_talks_about_day"><span>Mluv√≠ s v√°mi d√≠tƒõ o sv√©m dni ve ≈°kolce?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_kg_talks_about_day">
        <label><input type="radio" name="kg_talks_about_day" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_talks_about_day" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_talks_about_day" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label for="kg_obedience"><span>Jak je va≈°e d√≠tƒõ ve ≈°kolce poslu≈°n√© podle uƒçitelek?</span></label>
      <textarea class="long-text" name="kg_obedience" id="kg_obedience"></textarea>
    </div>

    <div class="qa-block">
      <label for="kg_participation"><span>Jak se va≈°e d√≠tƒõ podle uƒçitelek zapojuje do dƒõn√≠ ve ≈°kolce?</span></label>
      <textarea class="long-text" name="kg_participation" id="kg_participation"></textarea>
    </div>

    <div class="qa-block">
      <label for="kg_peer_behavior"><span>Jak uƒçitelky ve ≈°kolce hodnot√≠ chov√°n√≠ va≈°eho d√≠tƒõte k jin√Ωm dƒõtem? (hraje si s nimi / nezlob√≠ je apod.)</span></label>
      <textarea class="long-text" name="kg_peer_behavior" id="kg_peer_behavior"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_kg_teachers_complain"><span>Stƒõ≈æuj√≠ si uƒçitelky ve ≈°kolce na va≈°e d√≠tƒõ?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_kg_teachers_complain">
        <label><input type="radio" name="kg_teachers_complain" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_teachers_complain" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_teachers_complain" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_kg_teachers_see_problem"><span>Zmi≈àuj√≠ uƒçitelky probl√©m, kv≈Øli kter√©mu bude nyn√≠ d√≠tƒõ podstupovat vy≈°et≈ôen√≠?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_kg_teachers_see_problem">
        <label><input type="radio" name="kg_teachers_see_problem" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_teachers_see_problem" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_teachers_see_problem" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_kg_preschool_prep"><span>Prob√≠h√° ve ≈°kolce nƒõjak√° forma p≈ôed≈°koln√≠ p≈ô√≠pravy?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_kg_preschool_prep">
        <label><input type="radio" name="kg_preschool_prep" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_preschool_prep" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_preschool_prep" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_kg_prep_progress_detail" data-controlled-by="kg_preschool_prep">
      <label for="kg_prep_progress"><span>Jak uƒçitelky hodnot√≠ fungov√°n√≠ d√≠tƒõte p≈ôi ≈°koln√≠ p≈ô√≠pravƒõ?</span></label>
      <textarea class="long-text" name="kg_prep_progress" id="kg_prep_progress"></textarea>
    </div>

    <div class="qa-block">
      <label for="kg_parent_rating"><span>Jak vy osobnƒõ ≈°kolku hodnot√≠te?</span></label>
      <textarea class="long-text" name="kg_parent_rating" id="kg_parent_rating"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_kg_starting_school"><span>Nastupuje d√≠tƒõ v nejbli≈æ≈°√≠ dobƒõ do prvn√≠ t≈ô√≠dy?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_kg_starting_school">
        <label><input type="radio" name="kg_starting_school" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="kg_starting_school" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="kg_starting_school" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

  </div> </fieldset>


 <fieldset>
  <legend>≈†kola</legend>

  <div class="qa-block">
    <label id="lbl_attends_school"><span>Nav≈°tƒõvuje d√≠tƒõ ≈°kolu?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_attends_school">
      <label><input type="radio" name="attends_school" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="attends_school" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="attends_school" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block qa-group hidden" id="q_school_details" data-controlled-by="attends_school">

    <div class="tip-block tip-block-under">
≈†koln√≠ doch√°zka m≈Ø≈æe pro dƒõti p≈ôedstavovat velkou v√Ωzvu - vy≈æaduje dlouhodobou pozornost, regulaci emoc√≠ i chov√°n√≠, organizaci, pr√°ci podle instrukc√≠ a schopnost vztahovat se adekv√°tn√≠m zp≈Øsobem k ostatn√≠m dƒõtem i vyuƒçuj√≠c√≠m. V dotazn√≠ku se sna≈æ√≠me z√≠skat co nejv√≠ce informac√≠ o tom, jak konkr√©tnƒõ vypad√° ≈°koln√≠ re≈æim, uspo≈ô√°d√°n√≠ t≈ô√≠dy a ≈°koln√≠ povinnosti d√≠tƒõte. V≈°echny tyto faktory se mohou prom√≠tat do ≈°koln√≠ho v√Ωkonu i psychick√© pohody d√≠tƒõte. 
</div>

    <div class="qa-block">
      <label id="lbl_school_first_grade"><span>Je d√≠tƒõ aktu√°lnƒõ v prvn√≠ t≈ô√≠dƒõ?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_first_grade">
        <label><input type="radio" name="school_first_grade" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_first_grade" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_first_grade" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block qa-group hidden" id="q_school_first_grade_history" data-controlled-by="school_first_grade">

      <div class="tip-block tip-block-under">
      Tato ƒç√°st dotazn√≠ku se vrac√≠ k obdob√≠ p≈ôed≈°koln√≠ho vƒõku, kdy se zaƒç√≠naj√≠ objevovat prvn√≠ n√°znaky pot√≠≈æ√≠ ƒçi naopak siln√Ωch str√°nek, kter√© mohou ovliv≈àovat fungov√°n√≠ d√≠tƒõte ve ≈°kole i dnes. Va≈°e odpovƒõdi n√°m pomohou z√≠skat p≈ôedstavu o tom, jak√° doporuƒçen√≠ nebo podp≈Ørn√° opat≈ôen√≠ by d√≠tƒõti ve ≈°kole mohla prosp√≠vat.</div>

      <div class="qa-block">
        <label for="school_history_kg_obedience"><span>Jak bylo va≈°e d√≠tƒõ ve ≈°kolce poslu≈°n√© podle uƒçitelek?</span></label>
        <textarea class="long-text" name="school_history_kg_obedience" id="school_history_kg_obedience"></textarea>
      </div>
      <div class="qa-block">
        <label for="school_history_kg_participation"><span>Jak se va≈°e d√≠tƒõ podle uƒçitelek zapojovalo do dƒõn√≠ ve ≈°kolce?</span></label>
        <textarea class="long-text" name="school_history_kg_participation" id="school_history_kg_participation"></textarea>
      </div>
      <div class="qa-block">
        <label for="school_history_kg_peer_behavior"><span>Jak uƒçitelky ve ≈°kolce hodnotily chov√°n√≠ va≈°eho d√≠tƒõte k jin√Ωm dƒõtem? (hraje si s nimi / nezlob√≠ je apod.)</span></label>
        <textarea class="long-text" name="school_history_kg_peer_behavior" id="school_history_kg_peer_behavior"></textarea>
      </div>
      <div class="qa-block">
        <label for="school_history_kg_prep_progress"><span>Jak uƒçitelky ve ≈°kolce hodnotily fungov√°n√≠ d√≠tƒõte p≈ôi ≈°koln√≠ p≈ô√≠pravƒõ?</span></label>
        <textarea class="long-text" name="school_history_kg_prep_progress" id="school_history_kg_prep_progress"></textarea>
      </div>
      <div class="qa-block">
        <label for="school_history_kg_prep_see_problem"><span>Zmi≈àovaly uƒçitelky ve ≈°kolce probl√©m, kv≈Øli kter√©mu bude nyn√≠ d√≠tƒõ podstupovat vy≈°et≈ôen√≠?</span></label>
        <textarea class="long-text" name="school_history_kg_prep_see_problem" id="school_history_kg_prep_see_problem"></textarea>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_school_fav_subjects_exists"><span>M√° d√≠tƒõ ve ≈°kole nƒõjak√© obl√≠ben√© vyuƒçovac√≠ p≈ôedmƒõty?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_fav_subjects_exists">
        <label><input type="radio" name="school_fav_subjects_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_fav_subjects_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_fav_subjects_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_fav_subjects_detail" data-controlled-by="school_fav_subjects_exists">
      <label for="school_fav_subjects_list"><span>Jak√© p≈ôedmƒõty to jsou?</span></label>
      <textarea class="long-text" name="school_fav_subjects_list" id="school_fav_subjects_list"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_school_disliked_subjects_exists"><span>Jsou nƒõjak√© p≈ôedmƒõty, kter√© d√≠tƒõ nem√° r√°do?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_disliked_subjects_exists">
        <label><input type="radio" name="school_disliked_subjects_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_disliked_subjects_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_disliked_subjects_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_disliked_subjects_detail" data-controlled-by="school_disliked_subjects_exists">
      <label for="school_disliked_subjects_list"><span>Kter√© to jsou?</span></label>
      <textarea class="long-text" name="school_disliked_subjects_list" id="school_disliked_subjects_list"></textarea>
    </div>

    <div class="qa-block">
      <label for="school_teacher_count"><span>Kolik vyuƒçuj√≠c√≠ch Va≈°e d√≠tƒõ uƒç√≠?</span></label>
      <input type="number" name="school_teacher_count" id="school_teacher_count">
    </div>

    <div class="qa-block">
      <label id="lbl_school_grading_type"><span>Jak√Ω typ hodnocen√≠ se ve ≈°kole, kterou d√≠tƒõ nav≈°tƒõvuje, pou≈æ√≠v√°?</span></label>
      <div class="select-group" role="group" aria-labelledby="lbl_school_grading_type">
        <label><input type="checkbox" name="school_grading_type_grades"><span>Zn√°mkov√°n√≠</span></label>
        <label><input type="checkbox" name="school_grading_type_verbal"><span>Slovn√≠ hodnocen√≠</span></label>
        <label><input type="checkbox" name="school_grading_type_self"><span>Sebehodnocen√≠ d√≠tƒõte</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_school_performance"><span>D√≠tƒõti se z hlediska hodnocen√≠ ≈°koln√≠ho prospƒõchu ve ≈°kole da≈ô√≠ sp√≠≈°e:</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_performance">
        <label><input type="radio" name="school_performance" value="Dob≈ôe"><span>Dob≈ôe</span></label>
        <label><input type="radio" name="school_performance" value="≈†patnƒõ"><span>≈†patnƒõ</span></label>
        <label><input type="radio" name="school_performance" value="Nƒõco mezi"><span>Nƒõco mezi</span></label>
        <label><input type="radio" name="school_performance" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_school_comm_app"><span>≈†kola pro komunikaci s rodiƒçi ohlednƒõ zn√°mek, dom√°c√≠ch √∫kol≈Ø nebo absence vyu≈æ√≠v√°:</span></label>
      <div class="select-group" role="group" aria-labelledby="lbl_school_comm_app">
        <label><input type="checkbox" name="school_comm_app"><span>Elektronickou komunikaci, nap≈ô. syst√©m Bakal√°≈ôi</span></label>
        <label><input type="checkbox" name="school_comm_notebook"><span>≈Ω√°kovskou kn√≠≈æku ve fyzick√© podobƒõ</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_school_homework_exists"><span>Dost√°v√° d√≠tƒõ ve ≈°kole dom√°c√≠ √∫koly?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_homework_exists">
        <label><input type="radio" name="school_homework_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_homework_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_homework_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

      <div class="qa-block qa-group hidden" id="q_school_homework_detail" data-controlled-by="school_homework_exists">

    <div class="qa-block">
      <label id="lbl_school_homework_complaints"><span>Stƒõ≈æuj√≠ si vyuƒçuj√≠c√≠, ≈æe d√≠tƒõ nepln√≠ dom√°c√≠ √∫koly?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_homework_complaints">
        <label><input type="radio" name="school_homework_complaints" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_homework_complaints" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_homework_complaints" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_school_homework_tracking"><span>Je t≈ôeba, aby si d√≠tƒõ ve ≈°kole samo zaznamen√°valo √∫koly, kter√© m√° vypracovat doma?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_homework_tracking">
        <label><input type="radio" name="school_homework_tracking" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_homework_tracking" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_homework_tracking" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block qa-group hidden" id="q_school_homework_tracking_detail" data-controlled-by="school_homework_tracking">
      <div class="qa-block">
        <label id="lbl_school_homework_notebook_exists"><span>M√° d√≠tƒõ √∫koln√≠ƒçek nebo jinou pom≈Øcku, do kter√© si √∫koly zaznamen√°v√°?</span></label>
        <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_homework_notebook_exists">
          <label><input type="radio" name="school_homework_notebook_exists" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_homework_notebook_exists" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_homework_notebook_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label id="lbl_school_homework_tracking_success"><span>Mysl√≠te si, ≈æe se d√≠tƒõti da≈ô√≠ poznamenat si ve ≈°kole v≈°echny dom√°c√≠ √∫koly?</span></label>
        <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_homework_tracking_success">
          <label><input type="radio" name="school_homework_tracking_success" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_homework_tracking_success" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_homework_tracking_success" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label id="lbl_school_homework_check"><span>D√≠tƒõ doma kontroluje √∫koln√≠ƒçek nebo jinou pom≈Øcku pro zaznamen√°v√°n√≠ √∫kol≈Ø:</span></label>
        <div class="select-group" role="group" aria-labelledby="lbl_school_homework_check">
          <label><input type="checkbox" name="school_homework_check_self"><span>Samo</span></label>
          <label><input type="checkbox" name="school_homework_check_parent"><span>Se mnou</span></label>
          <label><input type="checkbox" name="school_homework_check_other"><span>S jinou vychov√°vaj√≠c√≠ osobou</span></label>
        </div>
      </div>
    </div>
    <div class="qa-block">
      <label id="lbl_school_homework_expectation_self"><span>Oƒçek√°v√°te od d√≠tƒõte, ≈æe bude dom√°c√≠ √∫koly vypracov√°vat samo?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_homework_expectation_self">
        <label><input type="radio" name="school_homework_expectation_self" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_homework_expectation_self" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_homework_expectation_self" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_school_homework_do"><span>D√≠tƒõ vypracov√°v√° dom√°c√≠ √∫koly:</span></label>
      <div class="select-group" role="group" aria-labelledby="lbl_school_homework_do">
        <label><input type="checkbox" name="school_homework_do_self"><span>Samo</span></label>
        <label><input type="checkbox" name="school_homework_do_parent"><span>Se mnou</span></label>
        <label><input type="checkbox" name="school_homework_do_other"><span>S jinou vychov√°vaj√≠c√≠ osobou</span></label>
      </div>
    </div>

    </div>


    <div class="qa-block">
      <label for="school_teacher_rating_by_child"><span>Jak d√≠tƒõ hodnot√≠ jeho vyuƒçuj√≠c√≠ v r√°mci t≈ô√≠dn√≠ch sch≈Øzek nebo jin√© komunikace s V√°mi?</span></label>
      <textarea class="long-text" name="school_teacher_rating_by_child" id="school_teacher_rating_by_child"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_school_teacher_complaints_general"><span>Stƒõ≈æuj√≠ si vyuƒçuj√≠c√≠ opakovanƒõ na nƒõco, co se t√Ωk√° Va≈°eho d√≠tƒõte?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_teacher_complaints_general">
        <label><input type="radio" name="school_teacher_complaints_general" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_teacher_complaints_general" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_teacher_complaints_general" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_teacher_complaints_detail" data-controlled-by="school_teacher_complaints_general">
      <label for="school_teacher_complaints_list"><span>Na co si vyuƒçuj√≠c√≠ stƒõ≈æuj√≠?</span></label>
      <textarea class="long-text" name="school_teacher_complaints_list" id="school_teacher_complaints_list"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_school_teacher_praise_exists"><span>Chv√°l√≠ vyuƒçuj√≠c√≠ d√≠tƒõ za nƒõco?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_teacher_praise_exists">
        <label><input type="radio" name="school_teacher_praise_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_teacher_praise_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_teacher_praise_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_teacher_praise_detail" data-controlled-by="school_teacher_praise_exists">
      <label for="school_teacher_praise_list"><span>Za co vyuƒçuj√≠c√≠ Va≈°e d√≠tƒõ chv√°l√≠?</span></label>
      <textarea class="long-text" name="school_teacher_praise_list" id="school_teacher_praise_list"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_school_seating_type"><span>≈†koln√≠ t≈ô√≠da je uspo≈ô√°d√°na:</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_seating_type">
        <label><input type="radio" name="school_seating_type" value="Po dvou"><span>V lavic√≠ch po dvou</span></label>
        <label><input type="radio" name="school_seating_type" value="Jin√©"><span>Jin√© uspo≈ô√°d√°n√≠</span></label>
      </div>
    </div>

    <div class="qa-block qa-group hidden" id="q_school_seating_pair_details" data-controlled-by="school_seating_type" data-trigger-value="Po dvou">
      <div class="qa-block">
        <label id="lbl_school_seating_partner"><span>D√≠tƒõ sed√≠:</span></label>
        <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_seating_partner">
          <label><input type="radio" name="school_seating_partner" value="Samo"><span>Samo</span></label>
          <label><input type="radio" name="school_seating_partner" value="S jin√Ωm d√≠tƒõtem"><span>S jin√Ωm d√≠tƒõtem</span></label>
          <label><input type="radio" name="school_seating_partner" value="S asistentem"><span>S asistentem/kou</span></label>
          <label><input type="radio" name="school_seating_partner" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label id="lbl_school_seating_desk_row"><span>V kolik√°t√© lavici d√≠tƒõ sed√≠? (poƒç√≠tejte od tabule)</span></label>
        <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_seating_desk_row">
          <label><input type="radio" name="school_seating_desk_row" value="1. lavice"><span>1. lavice</span></label>
          <label><input type="radio" name="school_seating_desk_row" value="2. lavice"><span>2. lavice</span></label>
          <label><input type="radio" name="school_seating_desk_row" value="3. lavice"><span>3. lavice</span></label>
          <label><input type="radio" name="school_seating_desk_row" value="4. lavice nebo dal≈°√≠"><span>4. lavice nebo dal≈°√≠</span></label>
          <label><input type="radio" name="school_seating_desk_row" value="Nelze ≈ô√≠ci"><span>Nelze ≈ô√≠ci</span></label>
          <label><input type="radio" name="school_seating_desk_row" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label id="lbl_school_seating_location"><span>Ve kter√© ƒç√°sti t≈ô√≠dy d√≠tƒõ sed√≠?</span></label>
        <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_seating_location">
          <label><input type="radio" name="school_seating_location" value="U dve≈ô√≠"><span>U dve≈ô√≠</span></label>
          <label><input type="radio" name="school_seating_location" value="Uprost≈ôed"><span>Uprost≈ôed</span></label>
          <label><input type="radio" name="school_seating_location" value="U okna"><span>U okna</span></label>
          <label><input type="radio" name="school_seating_location" value="Nelze ≈ô√≠ci"><span>Nelze ≈ô√≠ci</span></label>
          <label><input type="radio" name="school_seating_location" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
        </div>
      </div>
    </div>
    
    <div class="qa-block hidden" id="q_school_seating_other_detail" data-controlled-by="school_seating_type" data-trigger-value="Jin√©">
      <label for="school_seating_other_description"><span>M≈Ø≈æete uspo≈ô√°d√°n√≠ t≈ô√≠dy a m√≠sto d√≠tƒõte popsat?</span></label>
      <textarea class="long-text" name="school_seating_other_description" id="school_seating_other_description"></textarea>
    </div>

    <div class="qa-block">
      <label id="lbl_school_relax_zone_exists"><span>M√° ≈°koln√≠ t≈ô√≠da relaxaƒçn√≠ ƒç√°st?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_relax_zone_exists">
        <label><input type="radio" name="school_relax_zone_exists" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_relax_zone_exists" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_relax_zone_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_relax_zone_detail" data-controlled-by="school_relax_zone_exists">
      <label for="school_relax_zone_rules"><span>M≈Ø≈æe d√≠tƒõ relaxaƒçn√≠ ƒç√°st vyu≈æ√≠vat?</span></label>
      <textarea class="long-text" name="school_relax_zone_rules" id="school_relax_zone_rules"></textarea>
    </div>

    <div class="qa-block">
      <label for="school_class_size"><span>Kolik dƒõt√≠ je ve ≈°koln√≠ t≈ô√≠dƒõ?</span></label>
      <input type="number" name="school_class_size" id="school_class_size">
    </div>

    <div class="qa-block">
      <label id="lbl_school_talks_about_friends"><span>Mluv√≠ d√≠tƒõ doma o kamar√°dech?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_talks_about_friends">
        <label><input type="radio" name="school_talks_about_friends" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_talks_about_friends" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_talks_about_friends" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block qa-group hidden" id="q_school_friends_detail" data-controlled-by="school_talks_about_friends">
      <div class="qa-block">
        <label id="lbl_school_has_friends"><span>M√° nƒõkoho, koho pova≈æuje za kamar√°da/kamar√°dku?</span></label>
        <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_has_friends">
          <label><input type="radio" name="school_has_friends" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_has_friends" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_has_friends" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
        </div>
      </div>
      <div class="qa-block">
        <label id="lbl_school_has_longterm_friends"><span>M√° nƒõjak√© kamar√°dy/ky, o kter√Ωch mluv√≠ dlouhodobƒõ?</span></label>
        <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_has_longterm_friends">
          <label><input type="radio" name="school_has_longterm_friends" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_has_longterm_friends" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_has_longterm_friends" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
        </div>
      </div>
    </div>
    <div class="qa-block">
      <label id="lbl_school_complains_about_peers"><span>Stƒõ≈æuje si na nƒõkter√© spolu≈æ√°ky nebo spolu≈æaƒçky?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_complains_about_peers">
        <label><input type="radio" name="school_complains_about_peers" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_complains_about_peers" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_complains_about_peers" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block qa-group hidden" id="q_school_complains_peers_detail" data-controlled-by="school_complains_about_peers">
      <div class="qa-block">
        <label id="lbl_school_complains_peers_longterm"><span>Stƒõ≈æuje si na nƒõkoho dlouhodobƒõ?</span></label>
        <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_complains_peers_longterm">
          <label><input type="radio" name="school_complains_peers_longterm" value="Ano"><span>Ano</span></label>
          <label><input type="radio" name="school_complains_peers_longterm" value="Ne"><span>Ne</span></label>
          <label><input type="radio" name="school_complains_peers_longterm" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
        </div>
      </div>
    </div>
    <div class="qa-block">
      <label id="lbl_school_complains_other"><span>Stƒõ≈æuje si d√≠tƒõ na nƒõco jin√©ho ohlednƒõ ≈°koly?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_school_complains_other">
        <label><input type="radio" name="school_complains_other" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="school_complains_other" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="school_complains_other" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block hidden" id="q_school_complains_other_detail" data-controlled-by="school_complains_other">
      <label for="school_complaints_other_text"><span>Na co si d√≠tƒõ stƒõ≈æuje?</span></label>
      <textarea class="long-text" name="school_complaints_other_text" id="school_complaints_other_text"></textarea>
    </div>

    <div class="qa-block">
      <label for="school_hours_per_week"><span>Kolik hodin t√Ωdnƒõ d√≠tƒõ tr√°v√≠ ve ≈°kole? (zapoƒç√≠tejte, pros√≠m, p≈ô√≠padn√© douƒçov√°n√≠ a podobn√© aktivity)</span></label>
      <input type="number" name="school_hours_per_week" id="school_hours_per_week">
    </div>

  </div> </fieldset>

<fieldset>
  <legend>Krou≈æky a z√°jmy</legend>

  <div class="tip-block tip-block-under">
Volnoƒçasov√© aktivity tvo≈ô√≠ d≈Øle≈æitou souƒç√°st ≈æivota d√≠tƒõte a mohou p≈ôisp√≠vat k jeho psychick√© pohodƒõ, soci√°ln√≠m dovednostem i schopnosti regulovat chov√°n√≠. Zp≈Øsob, jak√Ωm d√≠tƒõ tr√°v√≠ voln√Ω ƒças, n√°m z√°rove≈à napov√≠d√°, v jak√Ωch oblastech m≈Ø≈æe za≈æ√≠vat √∫spƒõch a z ƒçeho naopak m≈Ø≈æe b√Ωt vyƒçerpan√©. 
</div>

  <div class="qa-block">
    <label id="lbl_hobbies_fav_exists"><span>M√° d√≠tƒõ nƒõjakou volnoƒçasovou aktivitu, kter√° jej hodnƒõ bav√≠ nebo j√≠ dok√°≈æe tr√°vit hodnƒõ ƒçasu?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_hobbies_fav_exists">
      <label><input type="radio" name="hobbies_fav_exists" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="hobbies_fav_exists" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="hobbies_fav_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block hidden" id="q_hobbies_fav_detail" data-controlled-by="hobbies_fav_exists">
    <label for="hobbies_fav_activity"><span>Jak√° aktivita to je?</span></label>
    <input class="short-text" type="text" name="hobbies_fav_activity" id="hobbies_fav_activity">
  </div>

  <div class="qa-block">
    <label id="lbl_hobbies_clubs_exists"><span>Nav≈°tƒõvuje d√≠tƒõ nƒõjak√© z√°jmov√© krou≈æky?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_hobbies_clubs_exists">
      <label><input type="radio" name="hobbies_clubs_exists" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="hobbies_clubs_exists" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="hobbies_clubs_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block qa-group hidden" id="q_hobbies_clubs_detail" data-controlled-by="hobbies_clubs_exists">
    <div class="qa-block">
      <label for="hobbies_clubs_count"><span>Kolik krou≈æk≈Ø nav≈°tƒõvuje?</span></label>
      <input type="number" name="hobbies_clubs_count" id="hobbies_clubs_count" min="0">
    </div>
    <div class="qa-block">
      <label for="hobbies_clubs_list"><span>Jak√© krou≈æky d√≠tƒõ nav≈°tƒõvuje? (vypi≈°te)</span></label>
      <textarea class="long-text" name="hobbies_clubs_list" id="hobbies_clubs_list"></textarea>
    </div>
    <div class="qa-block">
      <label for="hobbies_clubs_hours"><span>Kolik hodin t√Ωdnƒõ tr√°v√≠ d√≠tƒõ v krou≈æc√≠ch?</span></label>
      <input type="number" name="hobbies_clubs_hours" id="hobbies_clubs_hours" min="0">
    </div>
  </div>
</fieldset>

<fieldset>
  <legend>Doma</legend>

  <div class="tip-block tip-block-under">
V dom√°c√≠m prost≈ôed√≠ d√≠tƒõ odpoƒç√≠v√°, uƒç√≠ se, hraje si a tr√°v√≠ velkou ƒç√°st ƒçasu mimo ≈°kolu. Zp≈Øsob, jak√Ωm d√≠tƒõ doma funguje, v√Ωznamnƒõ ovliv≈àuje nejen jeho emoƒçn√≠ stabilitu, ale i schopnost zvl√°dat po≈æadavky ≈°koly.
</div>

  <div class="qa-block">
    <label id="lbl_home_chores_exists"><span>M√° d√≠tƒõ nƒõjak√© dom√°c√≠ povinnosti (nap≈ô. √∫klid pokoje)?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_home_chores_exists">
      <label><input type="radio" name="home_chores_exists" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="home_chores_exists" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="home_chores_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block qa-group hidden" id="q_home_chores_detail" data-controlled-by="home_chores_exists">
    <div class="qa-block">
      <label for="home_chores_expectation"><span>Jak√© dom√°c√≠ povinnosti by d√≠tƒõ podle V√°s mƒõlo b√Ωt schopno splnit?</span></label>
      <input class="short-text" type="text" name="home_chores_expectation" id="home_chores_expectation">
    </div>

    <div class="qa-block">
      <label id="lbl_home_chores_success"><span>Da≈ô√≠ se mu dom√°c√≠ povinnosti plnit?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_home_chores_success">
        <label><input type="radio" name="home_chores_success" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="home_chores_success" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="home_chores_success" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_home_chores_self_check"><span>Dok√°≈æe si d√≠tƒõ samo kontrolovat plnƒõn√≠ dom√°c√≠ch povinnost√≠?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_home_chores_self_check">
        <label><input type="radio" name="home_chores_self_check" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="home_chores_self_check" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="home_chores_self_check" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
  </div>

  <div class="qa-block">
    <label id="lbl_home_request_compliance"><span>Zvl√°dne d√≠tƒõ doma udƒõlat nƒõco, o co jej po≈æ√°d√°te (nap≈ô. nƒõco don√©st, s nƒõƒç√≠m pomoci)?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_home_request_compliance">
      <label><input type="radio" name="home_request_compliance" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="home_request_compliance" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="home_request_compliance" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block">
    <label id="lbl_home_conflicts_exists"><span>M√°te doma s d√≠tƒõtem ƒçasto konflikty?</span></label>
    <div class="select-group" role="radiogroup" aria-labelledby="lbl_home_conflicts_exists">
      <label><input type="radio" name="home_conflicts_exists" value="Ano"><span>Ano</span></label>
      <label><input type="radio" name="home_conflicts_exists" value="Ne"><span>Ne</span></label>
      <label><input type="radio" name="home_conflicts_exists" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
    </div>
  </div>

  <div class="qa-block qa-group hidden" id="q_home_conflicts_detail" data-controlled-by="home_conflicts_exists">
    <div class="qa-block">
      <label id="lbl_home_conflicts_resolution"><span>M√°te pocit, ≈æe konflikty zvl√°d√°te ≈ôe≈°it tak, jak byste chtƒõl*a?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_home_conflicts_resolution">
        <label><input type="radio" name="home_conflicts_resolution" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="home_conflicts_resolution" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="home_conflicts_resolution" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>

    <div class="qa-block">
      <label id="lbl_home_conflicts_help"><span>Ocenil*a byste radu nebo pomoc ohlednƒõ toho, jak konflikty ≈ôe≈°it?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_home_conflicts_help">
        <label><input type="radio" name="home_conflicts_help" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="home_conflicts_help" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="home_conflicts_help" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
  </div>

  <div class="qa-block">
    <label for="general_main_concern"><span>Co V√°s obecnƒõ ohlednƒõ d√≠tƒõte nejv√≠ce tr√°p√≠?</span></label>
    <input class="short-text" type="text" name="general_main_concern" id="general_main_concern">
  </div>
</fieldset>


<!-- Summary table -->
<div class="summary-container" id="summary-container">
    <div class="summary-header" onclick="toggleSummaryDetails()">
        <div class="summary-stats">
            <div class="stat-item stat-answered">
                <span class="stat-value" id="count-answered">0</span>
                <span class="stat-label">Odpovƒõzen√©</span>
            </div>
            <div class="stat-item stat-refused">
                <span class="stat-value" id="count-refused">0</span>
                <span class="stat-label">Nechci odpov√≠dat</span>
            </div>
            <div class="stat-item stat-empty">
                <span class="stat-value" id="count-empty">0</span>
                <span class="stat-label">Pr√°zdn√©</span>
            </div>
        </div>
        <div class="toggle-icon">
            <span id="summary-toggle-text">Zobrazit detaily</span>
            <span id="summary-arrow">‚ñº</span>
        </div>
    </div>
    
    <div class="summary-details" id="summary-details-body">
        <div id="summary-empty-msg" style="padding: 20px; text-align: center; color: #888; font-style: italic; display: none;">
            V≈°echny polo≈æky jsou zodpovƒõzen√©.
        </div>
        <ul class="summary-list" id="summary-list">
            </ul>
    </div>
</div>




<!-- Save and Share Options -->
<div class="instruction-block sharing-options">
  <p>Dorazili jste na konec dotazn√≠ku. Nyn√≠ m√°te dvƒõ mo≈ænosti, jak sv√© odpovƒõdi sd√≠let se specialistou.</p>
  <ul>
    <li><strong>Ulo≈æit do souboru:</strong> St√°hne va≈°e odpovƒõdi jako soubor, kter√Ω m≈Ø≈æete p≈ôedat specialistovi nebo si jej ulo≈æit pro p≈ô√≠≈°tƒõ.</li>
    <li><strong>N√°hled tisku/PDF:</strong> Zobraz√≠ va≈°e odpovƒõdi ve form√°tu diagnostick√© zpr√°vy pro tisk nebo ulo≈æen√≠ do PDF.</li>
  </ul>

    <p>V z√°vislosti na dohodƒõ se specialistou vyberte preferovnou variantu. Pokud si nejste jisti, je lep≈°√≠ zvolit <strong>Ulo≈æit do souboru</strong> a soubor p≈ôin√©st specialistovi (nap≈ô√≠klad na USB disku). Specialista m≈Ø≈æe va≈°e odpovƒõdi p≈ôev√©st do PDF pozdƒõji s√°m.</p>
    


  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; margin-top: 20px;">
    <div class="save-buttons">
      <button type="button" class="btn primary" onclick="saveAsJsonFile()">Ulo≈æit do souboru</button>
      <button type="button" class="btn primary" id="preview-button" onclick="togglePrintPreview()">N√°hled tisku / PDF</button>
    </div>
      <button type="button" class="btn btn-secondary" onclick="saveForm(true)" style="margin-left: auto;">Pr≈Øbƒõ≈ænƒõ ulo≈æit</button>
  </div>

  <div class="manual-alert">
    <strong>‚ö†Ô∏è Upozornƒõn√≠:</strong>
    <span>Data v ulo≈æen√©m souboru nejsou ≈°ifrov√°na a mohou b√Ωt ƒçiteln√° t≈ôet√≠mi stranami. 
    Nƒõkter√© formy sd√≠len√≠, nap≈ô√≠klad skrze e-mail, mohou n√©st rizika.</span><br><br>
    <span>Pokud jste vyplnili dotazn√≠k na ve≈ôejn√©m za≈ô√≠zen√≠, nezapome≈àte po ulo≈æen√≠/exportu
      <span class="alert-action-link" onclick="clearHistory()">vymazat dotazn√≠k a pr≈Øbƒõ≈ænƒõ ulo≈æen√° data</span>.
    </span>
  </div>

</div>

<footer class="page-footer">
  <p>¬© 2026 MUNI FSS, Diagnostika d√≠tƒõte</p>
  <p>Licence <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.cs" target="_blank">CC BY-NC-ND 4.0</a></p>
</footer>

</form>
</main>

<input type="file" id="json-file-input" accept=".json" style="display: none;" aria-label="Naƒç√≠st soubor JSON">

<!-- Floating controls for Print Preview -->
<aside class="preview-controls" aria-label="Ovl√°d√°n√≠ n√°hledu">
  <button type="button" class="btn btn-secondary" onclick="togglePrintPreview()">Zpƒõt</button>
  <button type="button" class="btn primary" onclick="printWithUnansweredMarks()">Tisk/PDF</button>
</aside>

<script>


// Age calculation
const birthInput = document.getElementById('child_birthdate');
const ageInput = document.getElementById('child_age');

function formatYearsCzech(years) {
  if (years === 1) return '1 rok';
  if (years >= 2 && years <= 4) return `${years} roky`;
  return `${years} let`;
}

function formatMonthsCzech(months) {
  if (months === 1) return '1 mƒõs√≠c';
  if (months >= 2 && months <= 4) return `${months} mƒõs√≠ce`;
  return `${months} mƒõs√≠c≈Ø`;
}

function updateProgressBar() {
    const fieldsets = Array.from(document.querySelectorAll('#questionnaire > fieldset'));
    const wrapper = document.getElementById('segmented-wrapper');
    if (!wrapper) return;

    // 1. Udr≈æujeme spr√°vn√Ω poƒçet segment≈Ø
    if (wrapper.children.length !== fieldsets.length) {
        wrapper.innerHTML = '';
        fieldsets.forEach(() => {
            const seg = document.createElement('div');
            seg.className = 'progress-segment';
            seg.innerHTML = '<div class="segment-fill"></div>';
            wrapper.appendChild(seg);
        });
    }

    // 2. V√Ωpoƒçet pro ka≈æd√Ω segment na z√°kladƒõ tv√© p≈Øvodn√≠ logiky
    fieldsets.forEach((fieldset, index) => {
        const allBlocks = Array.from(fieldset.querySelectorAll('.qa-block'))
            .filter(block => {
                const hasDirectLabel = Array.from(block.children).some(child => child.tagName === 'LABEL');
                const isAgeField = block.querySelector('#child_age');
                return hasDirectLabel && !isAgeField;
            });
        
        if (allBlocks.length === 0) return;

        let points = 0;

        allBlocks.forEach(block => {
            const input = block.querySelector('input:not([type="radio"]):not([type="checkbox"]), textarea, select');
            const radioChecked = block.querySelector('input[type="radio"]:checked');
            const checkboxChecked = block.querySelector('input[type="checkbox"]:checked');
            
            const isAnswered = (input && input.value.trim() !== "") || radioChecked || checkboxChecked;

            if (isAnswered) {
                points++;
            } else {
                // P≈ÆVODN√ç LOGIKA ATRIBUT≈Æ: Zapoƒç√≠t√° se pouze, pokud je trigger AKTIVNƒö nastaven jinak
                let currentEl = block;
                let logicallySkipped = false;

                while (currentEl && currentEl !== document.body) {
                    const controlId = currentEl.getAttribute('data-controlled-by') || 
                                     (currentEl.closest('[data-controlled-by]') ? currentEl.closest('[data-controlled-by]').getAttribute('data-controlled-by') : null);
                    
                    if (controlId) {
                        const requiredValue = currentEl.closest('[data-trigger-value]') ? 
                                             currentEl.closest('[data-trigger-value]').getAttribute('data-trigger-value') : "Ano";
                        const trigger = document.querySelector(`input[name="${controlId}"]:checked`);
                        
                        // Zmƒõna: Pokud trigger nen√≠ vybr√°n (null), logicallySkipped z≈Øst√°v√° false.
                        // Sekce se zapoƒç√≠t√° jako "hotov√°" jen tehdy, kdy≈æ u≈æivatel vybral hodnotu, kter√° ji vyluƒçuje.
                        if (trigger && trigger.value !== requiredValue) {
                            logicallySkipped = true;
                            break; 
                        }
                    }
                    currentEl = currentEl.parentElement;
                }
                if (logicallySkipped) points++;
            }
        });

        // Fin√°ln√≠ v√Ωpoƒçet procenta pro tento konkr√©tn√≠ segment
        const percentage = Math.round((points / allBlocks.length) * 100);
        const segment = wrapper.children[index];
        
        if (segment) {
            const fill = segment.querySelector('.segment-fill');
            fill.style.width = percentage + "%";

            // Zelen√° barva pouze p≈ôi kompletn√≠m dokonƒçen√≠ sekce
            if (percentage >= 100) segment.classList.add('completed');
            else segment.classList.remove('completed');
        }
    });
}



/**
 * OVL√ÅD√ÅN√ç VIDITELNOSTI PROGRESS BARU P≈òI SCROLLOV√ÅN√ç
 */
function handleProgressBarVisibility() {
    const bar = document.getElementById('progress-container');
    const firstFieldset = document.querySelector('fieldset'); // Zamƒõ≈ô√≠me se na prvn√≠ sekci ot√°zek
    
    if (!bar || !firstFieldset) return;

    // Z√≠sk√°me pozici horn√≠ho okraje prvn√≠ho fieldsetu
    const rect = firstFieldset.getBoundingClientRect();
    
    // Bar se zobraz√≠, pokud je horn√≠ hrana prvn√≠ho fieldsetu 
    // v√Ω≈°e ne≈æ 200px od horn√≠ho okraje okna (u≈æivatel u≈æ zaƒçal ƒç√≠st ot√°zky)
    if (rect.top < 200) {
        bar.classList.add('is-visible');
    } else {
        bar.classList.remove('is-visible');
    }
}

// P≈ôid√°me posluchaƒç na ud√°lost scroll
window.addEventListener('scroll', handleProgressBarVisibility);

// Zavol√°me i p≈ôi naƒçten√≠ (pro p≈ô√≠pad, ≈æe by u≈æivatel str√°nku refreshnul u≈æ odscrollovanou)
document.addEventListener('DOMContentLoaded', handleProgressBarVisibility);



// setupConditional that supports radio groups and <select>
const conditionalUpdateFunctions = [];

function setupConditional(selectName, detailId, triggerValue = 'Ano') {
  const detailDiv = document.getElementById(detailId);
  if (!detailDiv) return; // Exit if the detail element doesn't exist

  const radios = Array.from(document.querySelectorAll(`[name="${selectName}"]`));
  const isRadioGroup = radios.length > 1 || (radios.length === 1 && radios[0].type === 'radio');

  let update;

  if (isRadioGroup) {
    update = () => {
      const checked = document.querySelector(`[name="${selectName}"]:checked`);
      const shouldShow = checked && checked.value === triggerValue;
      detailDiv.classList.toggle('is-visible', shouldShow);
      updateProgressBar();
      updateQuestionnaireSummary();
    };

    radios.forEach(r => r.addEventListener('change', update));
  } else {
    // Single select or input
    const elem = document.querySelector(`[name="${selectName}"]`);
    if (!elem) return;

    update = () => {
      const shouldShow = elem.value === triggerValue;
      detailDiv.classList.toggle('is-visible', shouldShow);
      updateProgressBar();
      updateQuestionnaireSummary();
    };

    elem.addEventListener('change', update);
  }

  if (update) {
    update(); // Initial check
    conditionalUpdateFunctions.push(update);
  }
}

function updateAllConditionals() {
  conditionalUpdateFunctions.forEach(fn => fn());
}

setupConditional('mother_health', 'q_mother_health_detail', 'Ano');
setupConditional('father_health', 'q_father_health_detail', 'Ano');
setupConditional('other_carer_status', 'q_other_carer_detail', 'Ano');
document.querySelectorAll('input[name="other_carer_status"]').forEach(r => {
  r.addEventListener('change', (e) => {
    if (e.target.value === 'Ano') {
      const container = document.getElementById('additional_carers_container');
      if (container && container.children.length === 0) addCarer();
    }
  });
});
setupConditional('mother_employed', 'q_mother_jobs_detail', 'Ano');
setupConditional('father_employed', 'q_father_jobs_detail', 'Ano');
setupConditional('has_siblings', 'q_siblings_detail', 'Ano');
document.querySelectorAll('input[name="has_siblings"]').forEach(r => {
  r.addEventListener('change', (e) => {
    if (e.target.value === 'Ano') {
      const container = document.getElementById('siblings_container');
      if (container && container.children.length === 0) addSibling();
    }
  });
});
setupConditional('child_has_device', 'q_child_device_details', 'Ano');
setupConditional('neurolog_exam', 'q_neurolog_exam_detail', 'Ano');
setupConditional('chronic_illnesses_status', 'q_chronic_illnesses_detail', 'Ano');
setupConditional('past_health_issues_status', 'q_past_health_issues_detail', 'Ano');
setupConditional('vision_issues', 'q_vision_issues_detail', 'Ano');
setupConditional('hearing_issues', 'q_hearing_issues_detail', 'Ano');
setupConditional('housing_type', 'q_housing_specification_detail', 'Jin√©');

setupConditional('attends_kindergarten', 'q_kindergarten_details', 'Ano');
setupConditional('kg_morning_issues', 'q_morning_issues_detail', 'Ano');

// --- Logika pro sekci ≈†kola ---
setupConditional('kg_preschool_prep', 'q_kg_prep_progress_detail', 'Ano');
setupConditional('attends_school', 'q_school_details', 'Ano');
setupConditional('school_first_grade', 'q_school_first_grade_history', 'Ano');
setupConditional('school_fav_subjects_exists', 'q_school_fav_subjects_detail', 'Ano');
setupConditional('school_disliked_subjects_exists', 'q_school_disliked_subjects_detail', 'Ano');
setupConditional('school_homework_tracking', 'q_school_homework_tracking_detail', 'Ano');
setupConditional('school_teacher_complaints_general', 'q_school_teacher_complaints_detail', 'Ano');
setupConditional('school_teacher_praise_exists', 'q_school_teacher_praise_detail', 'Ano');
setupConditional('school_homework_exists', 'q_school_homework_detail', 'Ano');

// Podm√≠nky pro sezen√≠
setupConditional('school_seating_type', 'q_school_seating_pair_details', 'Po dvou');
setupConditional('school_seating_type', 'q_school_seating_other_detail', 'Jin√©');

setupConditional('school_relax_zone_exists', 'q_school_relax_zone_detail', 'Ano');
setupConditional('school_talks_about_friends', 'q_school_friends_detail', 'Ano');
setupConditional('school_complains_about_peers', 'q_school_complains_peers_detail', 'Ano');
setupConditional('school_complains_other', 'q_school_complains_other_detail', 'Ano');


// --- Logika pro sekci Krou≈æky a z√°jmy/Doma ---
setupConditional('hobbies_fav_exists', 'q_hobbies_fav_detail', 'Ano');
setupConditional('hobbies_clubs_exists', 'q_hobbies_clubs_detail', 'Ano');
setupConditional('home_chores_exists', 'q_home_chores_detail', 'Ano');
setupConditional('home_conflicts_exists', 'q_home_conflicts_detail', 'Ano');



// Rodinn√° anamn√≠za
  // Registrace hlavn√≠ skupiny
  setupConditional('respondent_relation', 'group_bio_parents_combined', 'Biologick√Ω rodiƒç');
  setupConditional('respondent_relation', 'group_stepparent_combined', 'Vychov√°vaj√≠c√≠ rodiƒç');
  setupConditional('respondent_relation', 'group_other_combined', 'Jin√Ω vztah');

  // Registrace vno≈ôen√Ωch podm√≠nek pro Biologick√©ho rodiƒçe 1 (Vy)
  setupConditional('bio_p1_job_status', 'q_bio_p1_job_detail', 'Ano');
  setupConditional('bio_p1_mental', 'q_bio_p1_mental_detail', 'Ano');
  setupConditional('bio_p1_physical', 'q_bio_p1_physical_detail', 'Ano');

  // Registrace vno≈ôen√Ωch podm√≠nek pro Biologick√©ho rodiƒçe 2 (Druh√Ω rodiƒç)
  setupConditional('bio_p2_job_status', 'q_bio_p2_job_detail', 'Ano');
  setupConditional('bio_p2_mental', 'q_bio_p2_mental_detail', 'Ano');
  setupConditional('bio_p2_physical', 'q_bio_p2_physical_detail', 'Ano');

  // Respondent (Nevlastn√≠ rodiƒç)
setupConditional('step_resp_job_status', 'q_step_resp_job_detail', 'Ano');
setupConditional('step_resp_mental', 'q_step_resp_mental_detail', 'Ano');
setupConditional('step_resp_physical', 'q_step_resp_physical_detail', 'Ano');

// Respondent (Nevlastn√≠ rodiƒç) Bio Matka
setupConditional('step_bio_m_mental', 'q_step_bio_m_mental_detail', 'Ano');
setupConditional('step_bio_m_physical', 'q_step_bio_m_physical_detail', 'Ano');

// Respondent (Nevlastn√≠ rodiƒç) Bio Otec
setupConditional('step_bio_f_mental', 'q_step_bio_f_mental_detail', 'Ano');
setupConditional('step_bio_f_physical', 'q_step_bio_f_physical_detail', 'Ano');

// Respondent (Jin√Ω vztah)
setupConditional('other_resp_job_status', 'q_other_resp_job_detail', 'Ano');
setupConditional('other_resp_mental', 'q_other_resp_mental_detail', 'Ano');
setupConditional('other_resp_physical', 'q_other_resp_physical_detail', 'Ano');

// Respondent (Jin√Ω vztah) Bio Matka
setupConditional('other_bio_m_mental', 'q_other_bio_m_mental_detail', 'Ano');
setupConditional('other_bio_m_physical', 'q_other_bio_m_physical_detail', 'Ano');

// Respondent (Jin√Ω vztah) Bio Otec
setupConditional('other_bio_f_mental', 'q_other_bio_f_mental_detail', 'Ano');
setupConditional('other_bio_f_physical', 'q_other_bio_f_physical_detail', 'Ano');


// Auto-expand and retract textarea with padding only after first character
function autoExpandTextarea(textarea) {
  textarea.style.height = 'auto'; // Reset height to recalc scrollHeight

  const style = getComputedStyle(textarea);
  const lineHeight = parseFloat(style.lineHeight) || 24;
  const numLines = Math.round(textarea.scrollHeight / lineHeight);

  // Only add padding if textarea has at least one character
  const hasContent = textarea.value.trim().length > 0;
  const basePadding = hasContent ? 10 : 0; // 0 if empty, else 10px
  const extraPadding = hasContent ? (numLines - 1) * 10 : 0;
  const padding = Math.min(basePadding + extraPadding, 50);

  textarea.style.height = `${textarea.scrollHeight + padding}px`;
}

// Apply to all long-text textareas
document.querySelectorAll('textarea.long-text').forEach(area => {
  area.addEventListener('input', () => autoExpandTextarea(area));
  // Initialize height in case of prefilled content
  autoExpandTextarea(area);
});



// Dynamic generation for additional carers
function addCarer(data = null) {
  const container = document.getElementById('additional_carers_container');
  const index = container.children.length + 1;
  const fs = document.createElement('fieldset');
  fs.className = 'style-soft dynamic-item';
  
  fs.innerHTML = `
    <div class="style-soft-header">
        <legend>Dal≈°√≠ osoba ${index}</legend>
        <button type="button" class="btn-remove-3" onclick="removeDynamicItem(this)">‚úñ Odebrat</button>
    </div>
    <div class="style-soft-body">
    <div class="qa-block">
      <label for="carer_${index}_relation"><span>V jak√©m vztahu je osoba s d√≠tƒõtem (p≈ô√≠padnƒõ s v√°mi)?</span></label>
      <input class="short-text" type="text" name="carer_${index}_relation" id="carer_${index}_relation">
    </div>
    <div class="qa-block">
      <label for="carer_${index}_age"><span>Vƒõk:</span></label>
      <input type="number" name="carer_${index}_age" id="carer_${index}_age">
    </div>
    <div class="qa-block">
      <label id="lbl_carer_${index}_mental"><span>M√° nƒõjak√© du≈°evn√≠ obt√≠≈æe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_carer_${index}_mental">
        <label><input type="radio" name="carer_${index}_mental" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="carer_${index}_mental" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="carer_${index}_mental" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_carer_${index}_mental_detail" data-controlled-by="carer_${index}_mental">
      <label for="carer_${index}_mental_text"><span>Jak√© du≈°evn√≠ obt√≠≈æe to jsou?</span></label>
      <textarea class="long-text" name="carer_${index}_mental_text" id="carer_${index}_mental_text"></textarea>
    </div>
    <div class="qa-block">
      <label id="lbl_carer_${index}_physical"><span>M√° nƒõjak√° fyzick√° omezen√≠ (nap≈ô. nemoci, hendikep)?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_carer_${index}_physical">
        <label><input type="radio" name="carer_${index}_physical" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="carer_${index}_physical" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="carer_${index}_physical" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block hidden" id="q_carer_${index}_physical_detail" data-controlled-by="carer_${index}_physical">
      <label for="carer_${index}_physical_text"><span>Jak√° fyzick√° omezen√≠ to jsou?</span></label>
      <textarea class="long-text" name="carer_${index}_physical_text" id="carer_${index}_physical_text"></textarea>
    </div>
    </div>
  `;
  
  container.appendChild(fs);
  
  // Attach listeners for conditional logic
  const mentalRadios = fs.querySelectorAll(`input[name^="carer_"][name$="_mental"]`);
  mentalRadios.forEach(r => r.addEventListener('change', () => {
      const currentName = r.name;
      const match = currentName.match(/_(\d+)_/);
      if (match) {
          const currentIndex = match[1];
          const targetId = `q_carer_${currentIndex}_mental_detail`;
          const target = document.getElementById(targetId);
          if(target) {
              target.classList.toggle('is-visible', r.value === 'Ano');
              updateProgressBar();
              updateQuestionnaireSummary();
          }
      }
  }));

  const physicalRadios = fs.querySelectorAll(`input[name^="carer_"][name$="_physical"]`);
  physicalRadios.forEach(r => r.addEventListener('change', () => {
      const currentName = r.name;
      const match = currentName.match(/_(\d+)_/);
      if (match) {
          const currentIndex = match[1];
          const targetId = `q_carer_${currentIndex}_physical_detail`;
          const target = document.getElementById(targetId);
          if(target) {
              target.classList.toggle('is-visible', r.value === 'Ano');
              updateProgressBar();
              updateQuestionnaireSummary();
          }
      }
  }));

  // Auto-expand textareas
  fs.querySelectorAll('textarea.long-text').forEach(area => {
    area.addEventListener('input', () => autoExpandTextarea(area));
    autoExpandTextarea(area);
  });

  // Pre-fill data if provided
  if (data) {
      const inputs = fs.querySelectorAll('input, textarea, select');
      inputs.forEach(input => {
          if (data[input.name] !== undefined) {
              if (input.type === 'radio' || input.type === 'checkbox') {
                  if (input.value === data[input.name]) input.checked = true;
              } else {
                  input.value = data[input.name];
              }
          }
      });
      // Trigger change events to show/hide details
      mentalRadios.forEach(r => { if(r.checked) r.dispatchEvent(new Event('change')); });
      physicalRadios.forEach(r => { if(r.checked) r.dispatchEvent(new Event('change')); });
  }

  validateAllQuestions();
  updateProgressBar();
  updateQuestionnaireSummary();
}

// Dynamic generation for siblings
function addSibling(data = null) {
  const container = document.getElementById('siblings_container');
  const index = container.children.length + 1;
  const fs = document.createElement('fieldset');
  fs.className = 'style-soft dynamic-item';
  
  fs.innerHTML = `
    <div class="style-soft-header">
        <legend>Sourozenec ${index}</legend>
        <button type="button" class="btn-remove-3" onclick="removeDynamicItem(this)">√ó Odebrat</button>
    </div>
    <div class="style-soft-body">
    <div class="qa-block">
      <label for="sibling_${index}_name"><span>Jm√©no sourozence:</span></label>
      <input class="short-text" type="text" name="sibling_${index}_name" id="sibling_${index}_name">
    </div>
    <div class="qa-block">
      <label for="sibling_${index}_age"><span>Vƒõk sourozence:</span></label>
      <input type="number" name="sibling_${index}_age" id="sibling_${index}_age">
    </div>
    <div class="qa-block">
      <label id="lbl_sibling_${index}_biological_parents"><span>Maj√≠ d√≠tƒõ a sourozenec stejn√© biologick√© rodiƒçe?</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_sibling_${index}_biological_parents">
        <label><input type="radio" name="sibling_${index}_biological_parents" value="Ano, oba"><span>Ano, oba</span></label>
        <label><input type="radio" name="sibling_${index}_biological_parents" value="Ano, jednoho"><span>Ano, jednoho</span></label>
        <label><input type="radio" name="sibling_${index}_biological_parents" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="sibling_${index}_biological_parents" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
    <div class="qa-block">
      <label id="lbl_sibling_${index}_same_household"><span>≈Ωij√≠ ve stejn√© dom√°cnosti:</span></label>
      <div class="select-group" role="radiogroup" aria-labelledby="lbl_sibling_${index}_same_household">
        <label><input type="radio" name="sibling_${index}_same_household" value="Ano"><span>Ano</span></label>
        <label><input type="radio" name="sibling_${index}_same_household" value="Ne"><span>Ne</span></label>
        <label><input type="radio" name="sibling_${index}_same_household" value="Bez odpovƒõdi"><span>Bez odpovƒõdi</span></label>
      </div>
    </div>
        <div class="qa-block">
        <label for="sibling_${index}_diagnoses"><span>M√° sourozenec nƒõjak√© fyzick√© nebo psychick√© obt√≠≈æe?</span></label>
        <textarea class="long-text" name="sibling_${index}_diagnoses" id="sibling_${index}_diagnoses"></textarea>
    </div>
    <div class="qa-block">
        <label for="sibling_${index}_relationship"><span>Jak vypad√° vztah sourozence a d√≠tƒõte?</span></label>
        <textarea class="long-text" name="sibling_${index}_relationship" id="sibling_${index}_relationship"></textarea>
    </div>
    </div>
  `;
  
  container.appendChild(fs);
  
  fs.querySelectorAll('textarea.long-text').forEach(area => {
    area.addEventListener('input', () => autoExpandTextarea(area));
    autoExpandTextarea(area);
  });

  if (data) {
      const inputs = fs.querySelectorAll('input, textarea, select');
      inputs.forEach(input => {
          if (data[input.name] !== undefined) {
              if (input.type === 'radio' || input.type === 'checkbox') {
                  if (input.value === data[input.name]) input.checked = true;
              } else {
                  input.value = data[input.name];
              }
          }
      });
  }

  validateAllQuestions();
  updateProgressBar();
  updateQuestionnaireSummary();
}

function removeDynamicItem(button) {
    const fieldset = button.closest('.dynamic-item');
    const container = fieldset.parentElement;
    fieldset.remove();
    
    // Determine base name for reindexing
    let baseName = '';
    if (container.id === 'additional_carers_container') baseName = 'carer';
    else if (container.id === 'siblings_container') baseName = 'sibling';
    
    reindexItems(container.id, baseName);
    
    validateAllQuestions();
    updateProgressBar();
    updateQuestionnaireSummary();
}

function reindexItems(containerId, baseName) {
    const container = document.getElementById(containerId);
    const items = container.querySelectorAll('.dynamic-item');
    
    items.forEach((item, index) => {
        const newIndex = index + 1;
        
        // Update Legend
        const legend = item.querySelector('legend');
        if (legend) {
            // Preserve text, update number. Assuming format "Text Number"
            const text = legend.textContent.replace(/\d+$/, '');
            legend.textContent = text + newIndex;
        }
        
        // Update Hidden Blocks IDs first
        const hiddenBlocks = item.querySelectorAll('.qa-block.hidden');
        hiddenBlocks.forEach(block => {
            if (block.id) {
                block.id = block.id.replace(new RegExp(`${baseName}_\\d+`), `${baseName}_${newIndex}`);
            }
            if (block.hasAttribute('data-controlled-by')) {
                const val = block.getAttribute('data-controlled-by');
                block.setAttribute('data-controlled-by', val.replace(new RegExp(`${baseName}_\\d+`), `${baseName}_${newIndex}`));
            }
        });

        // Update Inputs and Labels
        const elements = item.querySelectorAll('input, textarea, select, label, div[role="radiogroup"]');
        elements.forEach(el => {
            const regex = new RegExp(`${baseName}_\\d+`);
            const replacement = `${baseName}_${newIndex}`;
            
            if (el.name) el.name = el.name.replace(regex, replacement);
            if (el.id) el.id = el.id.replace(regex, replacement);
            if (el.htmlFor) el.htmlFor = el.htmlFor.replace(regex, replacement);
            if (el.hasAttribute('aria-labelledby')) {
                const val = el.getAttribute('aria-labelledby');
                el.setAttribute('aria-labelledby', val.replace(regex, replacement));
            }
        });
    });
}

//saving

const formStorageKey = 'child_questionnaire_data';

const Security = {
    _secret: 'MuniFssDiagnostic2026',

    async _getKey() {
        const enc = new TextEncoder();
        const keyMaterial = await crypto.subtle.digest("SHA-256", enc.encode(this._secret));
        return crypto.subtle.importKey(
            "raw",
            keyMaterial,
            { name: "AES-GCM" },
            false,
            ["encrypt", "decrypt"]
        );
    },

    async encrypt(data) {
        const key = await this._getKey();
        const iv = crypto.getRandomValues(new Uint8Array(12)); 
        const enc = new TextEncoder();
        const encodedData = enc.encode(JSON.stringify(data));

        const encryptedContent = await crypto.subtle.encrypt(
            {
                name: "AES-GCM",
                iv: iv
            },
            key,
            encodedData
        );

        return {
            iv: Array.from(iv),
            content: Array.from(new Uint8Array(encryptedContent)),
            version: "1.0"
        };
    },

    async decrypt(encryptedObj) {
        const key = await this._getKey();
        const iv = new Uint8Array(encryptedObj.iv);
        const content = new Uint8Array(encryptedObj.content);

        const decryptedContent = await crypto.subtle.decrypt(
            { name: "AES-GCM", iv: iv },
            key,
            content
        );

        const dec = new TextDecoder();
        return JSON.parse(dec.decode(decryptedContent));
    }
};

function getFormData() {
  const form = document.querySelector('form');
  const data = {};

  form.querySelectorAll('input, select, textarea').forEach(el => {
    if (el.type === 'radio') {
      if (el.checked) data[el.name] = el.value;
    } else if (el.type === 'checkbox') {
      data[el.name] = el.checked;
    } else {
      data[el.name] = el.value;
    }
  });

  // Save dynamic carers
  const carers = [];
  document.querySelectorAll('#additional_carers_container .dynamic-item').forEach(fs => {
    const carerData = {};
    fs.querySelectorAll('input, select, textarea').forEach(el => {
      if (el.type === 'radio' || el.type === 'checkbox') {
          if (el.checked) carerData[el.name] = el.value;
      } else {
          carerData[el.name] = el.value;
      }
    });
    carers.push(carerData);
  });
  data['additional_carers'] = carers;

  // Save dynamic siblings
  const siblings = [];
  document.querySelectorAll('#siblings_container .dynamic-item').forEach(fs => {
    const siblingData = {};
    fs.querySelectorAll('input, select, textarea').forEach(el => {
      if (el.type === 'radio' || el.type === 'checkbox') {
          if (el.checked) siblingData[el.name] = el.value;
      } else {
        siblingData[el.name] = el.value;
      }
    });
    siblings.push(siblingData);
  });
  data['siblings'] = siblings;
  
  return data;
}

function saveForm(showNotification = false) {
    const data = getFormData();
    localStorage.setItem(formStorageKey, JSON.stringify(data));
    if (showNotification) {
        showCustomDialog("Ulo≈æeno", "Formul√°≈ô byl √∫spƒõ≈°nƒõ ulo≈æen do pamƒõti prohl√≠≈æeƒçe.", "OK", "success");
    }
    const loadBtn = document.getElementById('load-from-storage-btn');
    if (loadBtn && loadBtn.disabled) { loadBtn.disabled = false; }
}

async function saveAsJsonFile() {
  const data = getFormData();
  // ≈†ifrov√°n√≠ dat p≈ôed ulo≈æen√≠m
  const encryptedData = await Security.encrypt(data);
  const jsonData = JSON.stringify(encryptedData, null, 2); // Pretty print JSON
  const blob = new Blob([jsonData], { type: 'application/json' });

  const date = new Date();
  const timestamp = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
  const childName = data.child_name ? data.child_name.replace(/ /g, '_') : 'dite';
  const suggestedName = `dotaznik-${childName}-${timestamp}.json`;

  // Use the modern File System Access API if available
  if (window.showSaveFilePicker) {
    try {
      const handle = await window.showSaveFilePicker({
        suggestedName: suggestedName,
        types: [{
          description: 'JSON Soubor',
          accept: { 'application/json': ['.json'] },
        }],
      });
      const writable = await handle.createWritable();
      await writable.write(blob);
      await writable.close();
    } catch (err) {
      // Handle cases where the user cancels the dialog
      if (err.name !== 'AbortError') {
        console.error('File save error:', err);
      }
    }
  } else {
    // Fallback for older browsers
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = suggestedName;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(a.href);
  }
}

function loadData(data) {
  const form = document.querySelector('form');

  // Reset form first
  form.reset();
  document.getElementById('additional_carers_container').innerHTML = '';
  document.getElementById('siblings_container').innerHTML = '';

  // Load static fields
  form.querySelectorAll('input, select, textarea').forEach(el => {
    if (el.type === 'radio') {
      if (data[el.name] === el.value) el.checked = true;
    } else if (el.type === 'checkbox') {
      el.checked = !!data[el.name];
    } else if (data[el.name] !== undefined) {
      el.value = data[el.name];
    }
  });

  // Recreate dynamic carers
  if (data['additional_carers'] && Array.isArray(data['additional_carers'])) {
    data['additional_carers'].forEach(carer => {
        addCarer(carer);
    });
  }

  // Recreate dynamic siblings
  if (data['siblings'] && Array.isArray(data['siblings'])) {
    data['siblings'].forEach(sib => {
        addSibling(sib);
    });
  }
  // Trigger visibility checks for all conditional fields
  updateAllConditionals();

  // Ensure all textareas are expanded to fit loaded content
  form.querySelectorAll('textarea.long-text').forEach(area => {
    autoExpandTextarea(area);
  });

  // After adding new fields, re-validate the form to show/hide dots
  validateAllQuestions();
  updateProgressBar();

  // Re-validate all questions for error messages
  Validator.checkAll();

  // Summary update
  updateQuestionnaireSummary();
}

// Load saved data
async function loadForm() {
    const saved = localStorage.getItem(formStorageKey);
    if (!saved) {
        await showCustomDialog(
            "Data nenalezena", 
            "V pamƒõti tohoto prohl√≠≈æeƒçe nebyl nalezen ≈æ√°dn√Ω rozpracovan√Ω dotazn√≠k. Ujistƒõte se, ≈æe pou≈æ√≠v√°te stejn√Ω prohl√≠≈æeƒç, jako poslednƒõ", 
            "Zav≈ô√≠t", 
            "warning" 
        );
        return;
    }
    const data = JSON.parse(saved);
    loadData(data);
    await showCustomDialog("Obnoveno", "Data byla √∫spƒõ≈°nƒõ naƒçtena z prohl√≠≈æeƒçe.", "OK", "success");
}


// --- Clear History ---
async function clearHistory() {
    const confirmed = await showCustomDialog(
        "Smazat historii?", 
        "Opravdu chcete smazat ulo≈æenou historii? Tato akce trvale odstran√≠ ve≈°ker√° data ulo≈æen√° v prohl√≠≈æeƒçi a vyma≈æe aktu√°lnƒõ vyplnƒõn√Ω formul√°≈ô.",
        "Smazat v≈°e",
        "delete",
        true
    );

    if (confirmed) {
        localStorage.removeItem(formStorageKey);
        document.querySelector('form').reset();
        document.getElementById('additional_carers_container').innerHTML = '';
        document.getElementById('siblings_container').innerHTML = '';
        updateAllConditionals();
        validateAllQuestions();
        updateProgressBar();
        updateQuestionnaireSummary();
        
        await showCustomDialog("Smaz√°no", "Ve≈°ker√° data byla vymaz√°na.", "OK", "success");
        
        const loadBtn = document.getElementById('load-from-storage-btn');
        if (loadBtn) loadBtn.disabled = true;
    }
}

// --- Live Unanswered Question Validation ---

function validateQuestionBlock(block) {
  const label = block.querySelector('label > span');
  if (!label) return;

  let isUnanswered = false;

  // Ignore the calculated age field
  if (block.querySelector('#child_age')) {
    return;
  }

  // Case 1: Text, number, date, or textarea inputs
  const textInput = block.querySelector(':scope > input[type="text"], :scope > input[type="number"], :scope > input[type="date"], :scope > textarea, :scope > label > input[type="text"], :scope > label > input[type="number"]');
  if (textInput && textInput.value.trim() === '') {
    isUnanswered = true;
  }

  // Case 2: Radio button groups
  const radioGroup = block.querySelector(':scope > .select-group input[type="radio"]');
  if (radioGroup) {
    const checkedRadio = block.querySelector(`:scope > .select-group input[name="${radioGroup.name}"]:checked`);
    if (!checkedRadio) {
      isUnanswered = true;
    }
  }

  // Case 3: Checkbox groups (unanswered if none are checked)
  const checkboxGroup = block.querySelector(':scope > .select-group input[type="checkbox"]');
  if (checkboxGroup) {
    const isAnyCheckboxChecked = block.querySelector(':scope > .select-group input[type="checkbox"]:checked');
    if (!isAnyCheckboxChecked) {
      isUnanswered = true;
    }
  }

  const existingDot = label.querySelector('.unanswered-dot');

  if (isUnanswered) {
    if (!existingDot) {
      const dot = document.createElement('span');
      dot.className = 'unanswered-dot';
      label.prepend(dot);
    } else {
      existingDot.classList.remove('answered'); // Make it visible again
    }
  } else { // The question is answered
    if (!existingDot) {
      // If answered but no dot exists (e.g. after loading data), create it.
      const dot = document.createElement('span');
      dot.className = 'unanswered-dot answered';
      label.prepend(dot);
    } else {
      existingDot.classList.add('answered'); // Animate it out
    }
  }
}

function validateAllQuestions() {
  document.querySelectorAll('.qa-block:not(.hidden), .qa-block.is-visible').forEach(validateQuestionBlock);
}

function debounce(func, delay) {
  let timeout;
  return function(...args) {
    const context = this;
    clearTimeout(timeout);
    timeout = setTimeout(() => func.apply(context, args), delay);
  };
}

function setupLiveValidation() {
  const form = document.getElementById('questionnaire');
  // Create a debounced auto-save function that saves silently.
  const autoSave = debounce(() => saveForm(false), 1500);
  const debouncedSummaryUpdate = debounce(() => updateQuestionnaireSummary(), 500);

  form.addEventListener('input', (event) => {
    const block = event.target.closest('.qa-block');
    if (block) {
      autoSave(); // Trigger auto-save on any input.
      validateQuestionBlock(block);
    }
    updateProgressBar();
    debouncedSummaryUpdate();
    // After adding new fields, re-validate the form to show/hide dots
    setTimeout(() => {
      validateAllQuestions();
    }, 100); // Delay to ensure dynamic elements are fully rendered
  });

  // Initial validation on page load
  validateAllQuestions();
}

// --- Print Text Replacement Generator ---
function generatePrintReplacements() {
    // Najdeme v≈°echny viditeln√© textarey
    const textareas = document.querySelectorAll('textarea');

    textareas.forEach(textarea => {
        // Zkontrolujeme, zda u≈æ n√°hradu nem√°
        let replacementDiv = textarea.nextElementSibling;
        
        // Pokud element za textareou nen√≠ na≈°e n√°hrada, vytvo≈ô√≠me novou
        if (!replacementDiv || !replacementDiv.classList.contains('print-text-replacement')) {
            replacementDiv = document.createElement('div');
            replacementDiv.className = 'print-text-replacement';
            // Vlo≈æ√≠me ji do DOMu hned za textareu
            textarea.parentNode.insertBefore(replacementDiv, textarea.nextSibling);
        }

        // Zkop√≠rujeme text
        replacementDiv.textContent = textarea.value;
    });
}


// --- Print with Unanswered Marks ---

function removeUnansweredMarks() {
  document.querySelectorAll('.unanswered-mark').forEach(mark => mark.remove());
}

function togglePrintPreview() {
  const body = document.body;
  const html = document.documentElement;
  const button = document.getElementById('preview-button');
  const form = document.getElementById('questionnaire');
  const isPreviewing = html.classList.toggle('preview-mode-active');
  body.classList.toggle('print-preview', isPreviewing);

  // Select all input fields
  const inputs = form.querySelectorAll('input, textarea, select');

  if (isPreviewing) {
    generatePrintReplacements(); // Generov√°n√≠ st√≠nov√Ωch div≈Ø pro tisk
    markUnansweredQuestions();
    window.scrollTo(0, 0); // Scroll to top

    // Make all fields non-editable
    inputs.forEach(el => {
      if (el.tagName.toLowerCase() !== 'select' && el.type !== 'radio' && el.type !== 'checkbox') {
        el.readOnly = true;
      }
    });

    // Reset textarea height for preview so CSS can take over
    // Recalculate height to fit content exactly, removing auto-expand gaps.
    document.querySelectorAll('textarea.long-text').forEach(area => {
        const buffer = area.scrollHeight * 0.15; // buffer as 15% of scrollHeight
        area.style.height = 'auto'; // Reset height
        area.style.height = `${area.scrollHeight + buffer}px`; // Set to content height + buffer
        area.style.overflow = 'hidden'; // Hide scrollbar that might appear
    });

    updatePreviewLayout();
    window.addEventListener('resize', updatePreviewLayout);

  } else {
    removeUnansweredMarks();
    inputs.forEach(el => {
        el.readOnly = false;
    });

    // Re-apply auto-expand to textareas when exiting preview
    document.querySelectorAll('textarea.long-text').forEach(area => {
        area.style.overflow = ''; // Restore default overflow
        autoExpandTextarea(area);
    });

    window.removeEventListener('resize', updatePreviewLayout);
    form.style.marginBottom = '';
  }
}

function updatePreviewLayout() {
  const form = document.getElementById('questionnaire');
  const html = document.documentElement;

  if (!html.classList.contains('preview-mode-active')) {
    form.style.marginBottom = '';
    return;
  }

  if (window.matchMedia('(max-width: 230mm)').matches) {
    const rect = form.getBoundingClientRect();
    const layoutHeight = form.offsetHeight;
    const emptySpace = layoutHeight - rect.height;
    form.style.marginBottom = `-${emptySpace - 40}px`;
  } else {
    form.style.marginBottom = '';
  }
}

function markUnansweredQuestions() {
  // Find all question blocks that are currently visible
  document.querySelectorAll('.qa-block:not(.hidden), .qa-block.is-visible').forEach(block => {
    const label = block.querySelector('label > span');
    if (!label) return;

    // Ignore the calculated age field from being marked as unanswered
    if (block.querySelector('#child_age')) {
        return;
    }

    let isUnanswered = false;
    // Case 1: Text, number, date, or textarea inputs
    // This selector handles both direct children and inputs nested inside the label.
    const textInput = block.querySelector(':scope > input[type="text"], :scope > input[type="number"], :scope > input[type="date"], :scope > textarea, :scope > label > input[type="text"], :scope > label > input[type="number"]');

    if (textInput && textInput.value.trim() === '') {
      isUnanswered = true;
    }

    // Case 2: Radio button groups
    const radioGroup = block.querySelector(':scope > .select-group input[type="radio"]');
    if (radioGroup) {
      const checkedRadio = block.querySelector(`:scope > .select-group input[name="${radioGroup.name}"]:checked`);
      if (!checkedRadio || checkedRadio.value === 'Bez odpovƒõdi') {
        isUnanswered = true;
      }
    }

    // Case 3: Checkbox groups (if none are checked)
    const checkboxGroup = block.querySelector(':scope > .select-group input[type="checkbox"]');
    if (checkboxGroup) {
      const isAnyCheckboxChecked = block.querySelector(':scope > .select-group input[type="checkbox"]:checked');
      if (!isAnyCheckboxChecked) isUnanswered = true;
    }

    // Add the asterisk if the question is unanswered
    if (isUnanswered) {
      const mark = document.createElement('span');
      mark.className = 'unanswered-mark';
      mark.style.display = 'none'; // Hide by default, shown by print styles
      mark.textContent = '*';
      label.prepend(mark);
    }
  });
}

function printWithUnansweredMarks() {
  // This function is now used for the "Tisk PDF" button in preview
  generatePrintReplacements(); // Pro jistotu p≈ôegenerovat aktu√°ln√≠ texty
  window.print();
}

window.addEventListener('afterprint', () => {
  // Only remove marks if we are NOT in preview mode.
  if (!document.documentElement.classList.contains('preview-mode-active')) {
    removeUnansweredMarks();
  }
});

/** --- VALIDAƒåN√ç ENGINE --- **/
const Validator = {
    ui: {
        show: function(inputElement, message, persistent = false) {
            const container = inputElement.closest('.qa-block');
            if (!container) return;

            let bubble = container.querySelector('.error-bubble');
            if (!bubble) {
                bubble = document.createElement('div');
                bubble.className = 'error-bubble';
                inputElement.parentNode.insertBefore(bubble, inputElement.nextSibling);
            }

            bubble.textContent = message;
            
            setTimeout(() => {
                bubble.classList.add('is-visible');
                inputElement.classList.add('input-error');
            }, 10);

            clearTimeout(inputElement.errorTimeout);
            if (!persistent) {
                inputElement.errorTimeout = setTimeout(() => this.hide(inputElement), 3000);
            }
        },

        hide: function(inputElement) {
            const container = inputElement.closest('.qa-block');
            if (container) {
                const bubble = container.querySelector('.error-bubble');
                if (bubble) {
                    bubble.classList.remove('is-visible');
                    inputElement.classList.remove('input-error');
                }
            }
        }
    },

    // LOGICK√Å PRAVIDLA 
    rules: {
        child_birthdate: function(input) {
            const ageInput = document.getElementById('child_age');
            const birthDate = new Date(input.value);
            const today = new Date();

            // Reset zobrazen√≠ vƒõku
            if (ageInput) { 
                ageInput.value = ''; 
                ageInput.classList.remove('age-error-text'); 
            }

            if (isNaN(birthDate)) return true; // Pr√°zdn√© pole ignorujeme

            if (birthDate > today) {
                if (ageInput) { 
                    ageInput.value = 'Chybn√© datum'; 
                    ageInput.classList.add('age-error-text'); 
                }
                return "Datum narozen√≠ nem≈Ø≈æe b√Ωt v budoucnosti.";
            }

            // V√Ωpoƒçet vƒõku:
            // $years = today_{year} - birth_{year}$
            let years = today.getFullYear() - birthDate.getFullYear();
            let months = today.getMonth() - birthDate.getMonth();
            if (months < 0) { years--; months += 12; }

            if (ageInput) {
                ageInput.value = `${formatYearsCzech(years)}, ${formatMonthsCzech(months)}`;
            }

            if (years >= 18) return "Vƒõk vych√°z√≠ na v√≠ce ne≈æ 18 let. Zkontrolujte pros√≠m spr√°vnost data.";
            
            return true; // V≈°e v po≈ô√°dku
        },
    },

    // POMOCN√â FUNKCE PRO SPOU≈†TƒöN√ç
    checkField: function(id) {
        const input = document.getElementById(id);
        if (!input || !this.rules[id]) return;
        const result = this.rules[id](input);
        result === true ? this.ui.hide(input) : this.ui.show(input, result, true);
    },

    checkAll: function() {
        Object.keys(this.rules).forEach(id => this.checkField(id));
    },

    // INICIALIZACE POSLUCHAƒå≈Æ
    init: function() {
        const form = document.getElementById('questionnaire');

        // Okam≈æit√© skryt√≠ chyby p≈ôi jak√©mkoli psan√≠ (V√°≈° po≈æadavek)
        form.addEventListener('input', (e) => {
            if (e.target.type === 'number' || e.target.type === 'date') {
                this.ui.hide(e.target);
            }
        });

        // Validace po opu≈°tƒõn√≠ pole nebo zmƒõnƒõ (nap≈ô. u Date picker)
        form.addEventListener('change', (e) => {
            if (this.rules[e.target.id]) {
                this.checkField(e.target.id);
            }
        });

        // Striktn√≠ blokov√°n√≠ kl√°ves pro ƒç√≠sla (pouze 0-9)
        form.addEventListener('keydown', (e) => {
              if (e.target.type === 'number') {
                  // 1. Povol√≠me syst√©mov√© zkratky (Ctrl+C, Ctrl+V, Cmd+A atd.)
                  if (e.ctrlKey || e.metaKey || e.altKey) return;

                  // 2. Definujeme kl√°vesy, kter√© neprodukuj√≠ znak, ale ovl√°daj√≠ pole
                  const controlKeys = [
                      'Backspace', 'Tab', 'Enter', 'Delete', 'Escape',
                      'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown',
                      'Home', 'End', 'Shift', 'CapsLock'
                  ];

                  if (controlKeys.includes(e.key)) return;

                  // 3. Kontrola, zda jde o ƒç√≠slici 0-9
                  // Pou≈æ√≠v√°me e.key, co≈æ u Shift+1 vr√°t√≠ nap≈ô. "!" (neprojde testem)
                  const isDigit = /^[0-9]$/.test(e.key);

                  if (!isDigit) {
                      e.preventDefault();
                      this.ui.show(e.target, "Lze vkl√°dat pouze ƒç√≠slice.");
                  }
              }
          });
    }
};

Validator.init();

// Initialize all dynamic functionalities on page load
document.addEventListener('DOMContentLoaded', () => {
  setupLiveValidation();

  // Check if there's saved data and enable/disable the load button
  const loadBtn = document.getElementById('load-from-storage-btn');
  if (loadBtn && !localStorage.getItem(formStorageKey)) {
    loadBtn.disabled = true;
  }

  const fileInput = document.getElementById('json-file-input');
  fileInput.addEventListener('change', (event) => {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = async (e) => {
      try {
        const parsedData = JSON.parse(e.target.result);
        let data = parsedData;

        // Pokud data vypadaj√≠ jako ≈°ifrovan√° (maj√≠ iv a content), de≈°ifrujeme je
        if (parsedData.iv && parsedData.content) {
            data = await Security.decrypt(parsedData);
        }

        loadData(data);
        await showCustomDialog("Soubor naƒçten", "Data byla √∫spƒõ≈°nƒõ nahr√°na do formul√°≈ôe.", "OK", "success");
      } catch (error) {
        await showCustomDialog("Chyba souboru", "Soubor se nepoda≈ôilo zpracovat. Ujistƒõte se, ≈æe jde o platn√Ω soubor form√°tu JSON.", "Zav≈ô√≠t", "warning");
      }
    };
    reader.readAsText(file);
    fileInput.value = '';
  });

  Validator.checkAll();
  updateProgressBar();

  // Disable mouse wheel scroll on number inputs to prevent accidental value changes
  document.addEventListener('wheel', (e) => {
    if (document.activeElement.type === 'number') {
      document.activeElement.blur();
    }
  });

});



// Summary PANEL
/* --- LOGIKA SOUHRNN√âHO PANELU --- */

function updateQuestionnaireSummary() {
    // Vybereme pouze bloky, kter√© nejsou oznaƒçen√© jako skupina (qa-group)
    const allBlocks = Array.from(document.querySelectorAll('.qa-block:not(.qa-group)'));
    
    let countAnswered = 0;
    let countRefused = 0;
    let countEmpty = 0;
    
    const attentionList = []; 

    allBlocks.forEach(block => {
        // Ignorujeme pomocn√© bloky (vƒõk)
        if (block.querySelector('#child_age')) return;

        // 1. STRIKTN√ç KONTROLA VIDITELNOSTI
        // Pokud je blok skryt√Ω (nebo jeho rodiƒç), zcela ho ignorujeme.
        const isHidden = block.classList.contains('hidden') && !block.classList.contains('is-visible');
        let parentHidden = false;
        let currentEl = block.parentElement;
        while (currentEl && currentEl.tagName !== 'FORM') {
            if (currentEl.classList.contains('hidden') && !currentEl.classList.contains('is-visible')) {
                parentHidden = true; break;
            }
            currentEl = currentEl.parentElement;
        }

        if (isHidden || parentHidden) {
            return; // Neviditeln√© ot√°zky se nepoƒç√≠taj√≠
        }

        // 2. KONTROLA OBSAHU U VIDITELN√ùCH
        const fieldset = block.closest('fieldset');
        const sectionName = fieldset ? fieldset.querySelector('legend').textContent : 'Obecn√©';
        const labelEl = block.querySelector('label span');

        const questionText = labelEl ? labelEl.textContent.replace(':', '') : 'Ot√°zka';

        const input = block.querySelector('input:not([type="radio"]):not([type="checkbox"]), textarea, select');
        const radioChecked = block.querySelector('input[type="radio"]:checked');
        const checkboxChecked = block.querySelector('input[type="checkbox"]:checked');
        
        const hasValue = (input && input.value.trim() !== "") || radioChecked || checkboxChecked;

        if (hasValue) {
            // Kontrola, zda je vybr√°no "Bez odpovƒõdi"
            const isRadioRefused = radioChecked && radioChecked.value === "Bez odpovƒõdi";
            
            if (isRadioRefused) {
                countRefused++;
                attentionList.push({
                    id: block,
                    section: sectionName,
                    question: questionText,
                    type: 'refused',
                    label: 'Nechci odpov√≠dat'
                });
            } else {
                countAnswered++;
            }
        } else {
            // Viditeln√°, ale pr√°zdn√°
            countEmpty++;
            attentionList.push({
                id: block,
                section: sectionName,
                question: questionText,
                type: 'empty',
                label: 'Pr√°zdn√©'
            });
        }
    });

    // 3. AKTUALIZACE DOM
    document.getElementById('count-answered').textContent = countAnswered;
    document.getElementById('count-refused').textContent = countRefused;
    document.getElementById('count-empty').textContent = countEmpty;

    // Generov√°n√≠ seznamu detail≈Ø
    const listContainer = document.getElementById('summary-list');
    const emptyMsg = document.getElementById('summary-empty-msg');
    listContainer.innerHTML = '';

    if (attentionList.length === 0) {
        emptyMsg.style.display = 'block';
    } else {
        emptyMsg.style.display = 'none';
        attentionList.forEach(item => {
            const li = document.createElement('li');
            li.className = 'summary-list-item';
            li.innerHTML = `
                <div class="item-info">
                    <span class="item-section">${item.section}</span>
                    <span class="item-question">${item.question}</span>
                </div>
                <div class="item-status ${item.type}">${item.label}</div>
            `;
            
            li.addEventListener('click', (e) => {
                e.stopPropagation();
                scrollToAndHighlight(item.id);
            });
            
            listContainer.appendChild(li);
        });
    }
}

function scrollToAndHighlight(element) {
    // 1. Reset p≈ôedchoz√≠ch zv√Ωraznƒõn√≠
    document.querySelectorAll('.highlighted-dot').forEach(el => el.classList.remove('highlighted-dot'));
    document.querySelectorAll('.allow-overflow').forEach(el => el.classList.remove('allow-overflow'));

    // Najdeme v≈°echny p≈ôedky, kte≈ô√≠ by mohli o≈ô√≠znout obsah (qa-block, fieldset)
    const ancestorsToUnclip = [];
    let curr = element.parentElement;
    while (curr && curr.tagName !== 'FORM') {
        if (curr.classList.contains('qa-block') || curr.tagName === 'FIELDSET') {
            ancestorsToUnclip.push(curr);
        }
        curr = curr.parentElement;
    }

    // 2. Intersection Observer (spust√≠ se a≈æ v momentƒõ, kdy u≈æivatel na prvek dokouk√°)
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                element.classList.add('highlighted-dot');
                ancestorsToUnclip.forEach(el => el.classList.add('allow-overflow'));

                observer.disconnect();

                // Odstranƒõn√≠ t≈ô√≠d po 2.5 sekund√°ch (animace trv√° 2s + 0.5s rezerva)
                setTimeout(() => {
                    element.classList.remove('highlighted-dot');
                    ancestorsToUnclip.forEach(el => el.classList.remove('allow-overflow'));
                }, 4000);
            }
        });
    }, { 
        threshold: 0.4 
    });

    observer.observe(element);

    // 3. Plynul√Ω scroll na st≈ôed
    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
}



/** Custom dialogy */
async function showCustomDialog(title, message, confirmText = "OK", type = "info", showCancel = false) {
    const dialog = document.getElementById('custom-confirm');
    const titleEl = document.getElementById('dialog-title');
    const messageEl = document.getElementById('dialog-message');
    const confirmBtn = document.getElementById('dialog-confirm');
    const cancelBtn = document.getElementById('dialog-cancel');

    titleEl.textContent = title;
    messageEl.textContent = message;
    confirmBtn.textContent = confirmText;
    
    dialog.className = ''; 
    dialog.classList.add(`type-${type}`);

    // Tlaƒç√≠tko Zru≈°it se uk√°≈æe jen pro potvrzovac√≠ dialogy
    cancelBtn.style.display = showCancel ? "inline-block" : "none";

    // Nastaven√≠ barvy hlavn√≠ho tlaƒç√≠tka
    // Pokud je typ 'warning' nebo 'delete', d√°me ƒçerven√© tlaƒç√≠tko
    if (type === 'warning' || type === 'delete') {
        confirmBtn.className = "btn btn-danger";
    } else {
        confirmBtn.className = "btn primary";
    }

    dialog.showModal();

    return new Promise((resolve) => {
        confirmBtn.onclick = () => { dialog.close(); resolve(true); };
        cancelBtn.onclick = () => { dialog.close(); resolve(false); };
        dialog.onclick = (e) => { if (e.target === dialog) { dialog.close(); resolve(false); } };
    });
}


function toggleSummaryDetails() {
    const body = document.getElementById('summary-details-body');
    const text = document.getElementById('summary-toggle-text');
    const arrow = document.getElementById('summary-arrow');
    const isOpen = body.classList.contains('is-open');

    if (isOpen) {
        body.classList.remove('is-open');
        text.textContent = "Zobrazit detaily";
        arrow.textContent = "‚ñº";
    } else {
        body.classList.add('is-open');
        text.textContent = "Skr√Ωt detaily";
        arrow.textContent = "‚ñ≤";
    }
}

// Spu≈°tƒõn√≠ po naƒçten√≠
document.addEventListener('DOMContentLoaded', updateQuestionnaireSummary);




</script>



<dialog id="custom-confirm">
    <div class="dialog-inner">
        <h3 id="dialog-title">Potvrzen√≠</h3>
        <p id="dialog-message">Zpr√°va...</p>
        <div class="dialog-buttons">
            <button id="dialog-cancel" class="btn btn-secondary">Zru≈°it</button>
            <button id="dialog-confirm">OK</button>
        </div>
    </div>
</dialog>

</body>
</html>
